\chapter{Verification in Action Formalisms Based on \texorpdfstring{\ALCQIO}{ALCQIO}}\label{ch:ramifications}

Action programming languages are successfully applied to modelling the behaviour
of autarkic systems, which are often called \emph{agents}.  In this area, it is
of keen interest to reason about the behaviour of non-terminating action
programs as one expects that the agents perform open-ended tasks, which are not
supposed to terminate.  Since most action programming languages are based on
action formalisms that encompass full first-order logic, the problem of
verifying properties for such action programs is in general undecidable.

In this chapter, we restrict the setting in two directions to regain
decidability.  Firstly, we consider action formalisms based on DLs, for which
important inference problems become decidable, and secondly, we verify
properties of action sequences generated by BÃ¼chi-automata instead of
considering full-fledged high-level action programming languages.

A first step was done in~\cite{BaLM-ECAI10}, where the authors show that the
problem of verifying properties formulated in a restricted version of the
temporalised description logic \ALCO-LTL is decidable for the DL-based action
formalism introduced in~\cite{BLM+-AAAI05}.  However, the authors consider only
acyclic TBoxes instead of general ones.  In this chapter, we overcome this
problem by enriching the DL-based action formalism with so-called \emph{causal
relationships}.  Most of the results of this chapter have already been published
in~\cite{BaLL-LPAR10,BaLL-LTCS-10-01,YLL+-DL12}.

This chapter is organised as follows.  In Section~\ref{sec:action-formalism}, we
formally define a DL-based action formalism with causal relationships.  In
Sections~\ref{sec:consistency} and~\ref{sec:projection}, we then show that
important inference problems such as the consistency problem and the projection
problem are decidable in this formalism.  Then, in
Section~\ref{sec:verifying-actions}, we show how to verify temporal properties
in this more expressive action formalism.  Lastly, in
Section~\ref{sec:ramifications-summary}, we briefly summarise the results of
this chapter.


\section{DL-Based Action Formalisms and Causal Relationships}\label{sec:action-formalism}

The situation calculus~\cite{Rei-01} and the fluent calculus~\cite{Thi-05} are
popular many-sorted languages for representing action theories.  However, for
action theories represented in those languages, important inference problems are
in general undecidable, since these languages encompass full first-order logic.
%
One possibility to restrict these languages to avoid this source of
undecidability is to use a decidable fragment of first-order logic instead of
full first-order logic as underlying base logic.  Description logics are
well-suited for this purpose since their expressive power goes far beyond
propositional logic, whilst reasoning in DLs is still decidable.

Basically, an action theory consists of three components: (i)~a description of
the \emph{initial state}, (ii)~a description of the possible \emph{actions}, and
(iii)~a description of the \emph{domain constraints}.  For each action, it is
specified what the \emph{pre-conditions} are, which need to be satisfied for an
action to be applicable, and it is specified what the \emph{post-conditions}
are, i.e.~the changes to the current state that the execution of the action
causes.  The domain constraints formulate general knowledge about the
functioning of the domain, in which the actions are executed, and thus restrict
the possible states.  This is realised in a DL-based action formalism as
follows.  The initial state is described by an ABox.  This description is
incomplete due to the open-world assumption.  The pre-conditions are ABox
assertions that must hold, post-conditions are ABox assertions that are added or
removed, and domain constraints are specified using TBox axioms.

The \emph{projection problem}~\cite{Rei-01} is one of the most basic reasoning
problems for action formalisms.  Intuitively, it deals with the question whether
after applying a sequence of actions to an initial state a certain property
holds.  In expressive action formalisms such as the situation calculus, this
property is specified with a formula of first-order logic, whereas in the case
of DL-based action formalisms this property is specified with an ABox assertion.

The first action formalism based on DLs was introduced in~\cite{BLM+-AAAI05},
and the authors have shown that the projection problem and other important
inference problems become decidable in this restricted formalism.  This action
formalism has been further examined and extended in the last
years~\cite{LLM+-JELIA06,BaLM-ECAI10,BaLL-LPAR10,BaZa-FroCoS13}.
%
Recently, an action formalism that is based on a DL and the situation calculus
was proposed~\cite{GuSo-AMAI10,SoYe-DL12}.  Both action formalisms, an extension
of the one in~\cite{BLM+-AAAI05} and the one in~\cite{GuSo-AMAI10,SoYe-DL12},
have been evaluated by implementing their respective approaches to solving the
projection problem, and comparing the running times on random testing data for
several realistic application domains~\cite{YLL+-DL12}.  This evaluation is,
however, beyond the scope of this thesis.

Before we introduce our DL-based action formalism formally, we recall an
important problem, namely the ramification problem, which has to be solved by
the action formalism.


\subsection{The Ramification Problem}\label{sec:ramification-problem}

The interaction of post-conditions of an action and domain constraints can cause
so-called \emph{ramifications}.  More precisely, when an action is applied to a
state, it might not be enough to make only those changes to the current state
that are explicitly stated in the post-conditions of the action that is applied,
since it is possible that the resulting state does not satisfy the domain
constraints.  We call the changes required by the post-conditions of an action
\emph{direct effects}, whereas we call the additional changes that one needs to
make such that the resulting state after applying the action satisfies also the
domain constraints \emph{indirect effects}.  The ramification problem deals now
with the question how to characterise both the direct and the indirect effects
while still solving the \emph{frame problem}, i.e.~do not characterise the
complete resulting state but only the \enquote{necessary} changes to the current
state, which are required by the applied action and the domain
constraints~\cite{McCH-MI69,Rei-01}.

\begin{example}\label{ex:hiring-action}
    Take a hiring action, which has the direct effect that the person that is
    hired becomes an employee.  Moreover, we have a domain constraint that says
    that every employee must have a health insurance.  If John, for instance,
    does not have health insurance, then just applying the hiring action for
    John, i.e.~hiring John, would result in a state where John is an employee
    without a health insurance, which violates the domain constraint.
\end{example}

\noindent
One approach to solving the ramification problem is to define a semantics for
action theories that automatically deals with such indirect effects.  This
semantics should describe additional changes to the state in order to satisfy
the domain constraints, whilst taking care that only \enquote{necessary} changes
are made.  An example of such an attempt is the possible-models approach
(PMA)~\cite{Win-AAAI88,Her-KR96}.  Without additional restrictions, however, the
PMA and all the other approaches in this direction can lead to unintuitive
results.  It is not clear how to construct a general semantics that does not
suffer from this problem.
%
Consider again Example~\ref{ex:hiring-action}, and assume that there are only
two insurance companies that offer health insurance: AOK and TK\@.  To satisfy
the health-insurance domain constraint, John must get insured by one of them.
However, it is unclear how to design a general semantic framework, which is able
to decide which one to pick.

A second approach is avoiding the issues raised by the ramification problem
rather than solving them.  This is actually what is done in~\cite{BLM+-AAAI05}.
There, the domain constraints are given by an acyclic TBox and the
post-conditions of the actions are restricted such that only \emph{primitive}
concepts and roles can be changed.  Recall the definition of the syntax and
semantics of acyclic TBoxes; see Definitions~\ref{def:syntax-tbox}
and~\ref{def:semantics-tbox}.  One can observe that w.r.t.\ an acyclic TBox, the
interpretations of the primitive concepts and roles uniquely determine the
interpretations of the defined concepts.  Thus, in this restricted action
formalism, it is clear what indirect effects changing a primitive concept or
role has.  The semantics obtained in this way can be seen as an instance of the
PMA\@.  It is shown in~\cite{BLM+-AAAI05} that the use of the PMA in a less
restrictive setting, i.e.~using general TBoxes to describe the domain
constraints or allowing defined concepts to occur in post-conditions, can lead
to unintuitive results.

A third approach is letting the user rather than a general semantic machinery
decide which the indirect effects of an action are.  To resolve the
ramifications in Example~\ref{ex:hiring-action}, we assume that employers
actually are required to enrol new employees with AOK in case they do not
already have a health insurance.  However, one needs to extend the action
formalism such that it allows the user to add such information to the action
theory.  For DL-based action formalisms, this approach was first employed
in~\cite{LLM+-JELIA06}, where the formalism for describing the actions is
enriched such that the user can make complex statements about the changes to the
interpretations of concepts and roles that can be caused by applying a given
action.  The authors show  that important inference problems such as the
projection problem stay decidable in this setting, but another important
inference problem for action formalisms, namely the \emph{consistency problem},%
\footnote{In~\cite{LLM+-JELIA06}, this is actually called strong consistency.}
becomes undecidable.  Basically, an action is consistent if, whenever it is
applicable to a state, there is a well-defined successor state that can be
obtained after applying it.

In this chapter, we realise this third approach in a different way, namely by
adapting a method for addressing the ramification problem that has already been
employed in the reasoning about actions
community~\cite{Lin-IJCAI95,Thi-AIJ97,BeDT-ESSLLI98,DeTB-LEACIS98,LiSo-AAAI11,StTh-JAL13}.
%
Instead of changing the formalism for defining actions directly, we introduce
so-called \emph{causal relationships} as an additional component of action
theories.  In Example~\ref{ex:hiring-action}, such a causal relationship would
state that, whenever someone becomes a new employee, this person is then insured
by AOK, unless this person already had a health insurance.

In Section~\ref{sec:causal-relationships}, we formally introduce a DL-based
action formalism with causal relationships.  This new action formalism has two
advantages over the one introduced in~\cite{LLM+-JELIA06}.  Firstly, the action
formalism in~\cite{LLM+-JELIA06} requires of the user to deal with the
ramification problem within every single action description.  In our action
formalism, however, causal relationships are defined independently of a specific
action, as they state general facts about causation.  The formal semantics takes
then care of how these relationships are translated into the indirect effects of
the actions.
%
A second advantage is that the consistency problem in our action formalism is
decidable.  This advantage is crucial since in the context of the third
approach, the \emph{user} is supposed to deal with the ramification problem,
which mean in our action formalism that the user needs to define appropriate
causal relationships.  Testing the consistency of actions might help the user
with this task, because it enables the user to check whether all relevant causal
relationships have been stated correctly.  Coming back to
Example~\ref{ex:hiring-action}, it is clear that if the user does not specify
any causal relationships, the hiring action is inconsistent since its
application may result in a state that does not satisfy the health-insurance
domain constraint, and thus is not well-defined.  If the user, however, adds the
causal relationship mentioned above, then the action becomes consistent.
%
We show that in our action formalism the consistency problem is decidable in
Section~\ref{sec:consistency}.  After that, in Section~\ref{sec:projection}, we
show that also the projection problem is decidable in action theories stated in
our action formalism.


\subsection{A DL-Based Action Formalism with Causal Relationships}\label{sec:causal-relationships}

In principle, the action formalism can be parameterised with any DL\@.  In this
chapter, we focus on DLs between \ALC and \ALCQIO.  The relative expressivity
of these DLs is depicted in Figure~\ref{fig:alc-alcqio}.
%
Since most of the notions in this chapter do not depend on the specific DL
chosen, we again omit the prefix in the formal definitions and write e.g.\ ABox
instead of \ALCQIO-ABox.

\begin{figure}[t]
    \centering
    \begin{tikzpicture}[%
            semithick,
            auto,
            on grid,
            node distance=8ex and 8em,
            element/.style={rectangle,draw=gray,minimum height=2ex,minimum width=5em}]

        \node[element]                 (alcqio) {\ALCQIO};
        \node[element,below=of alcqio] (alcqi)  {\ALCQI};
        \node[element,left=of alcqi]   (alcio)  {\ALCIO};
        \node[element,right=of alcqi]  (alcqo)  {\ALCQO};
        \node[element,below=of alcqi]  (alco)   {\ALCO};
        \node[element,left=of alco]    (alci)   {\ALCI};
        \node[element,right=of alco]   (alcq)   {\ALCQ};
        \node[element,below=of alco]   (alc)    {\ALC};

        \draw[gray] (alcqio)--(alcio);
        \draw[gray] (alcqio)--(alcqi);
        \draw[gray] (alcqio)--(alcqo);
        \draw[gray] (alcio)--(alci);
        \draw[gray] (alcio)--(alco);
        \draw[gray] (alcqi)--(alci);
        \draw[gray] (alcqi)--(alcq);
        \draw[gray] (alcqo)--(alco);
        \draw[gray] (alcqo)--(alcq);
        \draw[gray] (alci)--(alc);
        \draw[gray] (alco)--(alc);
        \draw[gray] (alcq)--(alc);
    \end{tikzpicture}
    \caption{The relative expressivity of the DLs between \ALC and~\ALCQIO}
    \label{fig:alc-alcqio}
\end{figure}

For defining the action formalism, we need besides atomic assertions also
\emph{negated} atomic assertions, i.e.~ABox-literals.  The semantics of
ABox-literals extends the one of assertions in
Definition~\ref{def:semantics-abox} in a straightforward manner.

\begin{definition}[ABox-literal]
    An \emph{ABox-literal} is either an atomic concept assertion $A(a)$, an
    atomic role assertion $r(a,b)$, a negated atomic concept assertion $\lnot
    A(a)$, or a negated atomic role assertion $\lnot r(a,b)$, where $A\in\NC$,
    $r\in\NR$, and $a,b\in\NI$.

    A \emph{generalised ABox-literal} is either an ABox-literal, a concept
    assertion $C(a)$, or a negated concept assertion $\lnot C(a)$, where $C$ is
    a concept, and $a\in\NI$.

    The interpretation~\Imc is a \emph{model} of a (generalised) ABox-literal of
    the form $\lnot\alpha$ (written $\Imc\models\lnot\alpha$) if
    $\Imc\not\models\alpha$, where $\Imc\models\alpha$ is defined as in
    Definition~\ref{def:semantics-abox}.
\end{definition}

\noindent
We call the non-negated assertions \emph{positive}, and the negated assertions
\emph{negative}.  Given a (generalised) ABox-literal $\alpha$, we denote its
negation by $\lnot\alpha$.  For the ease of presentation, we identify in the
following $\lnot\lnot\beta$ and $\beta$ for every (generalised) ABox-literal
$\beta$.
%
Note that finite sets of (generalised) ABox-literals are in general no ABoxes,
because of the presence of negative assertions.  To close this gap, we introduce
the notion of a generalised ABox.

\begin{definition}[Generalised ABox]
    A \emph{generalised ABox} is a finite set of generalised ABox-literals.  The
    interpretation \Imc is a \emph{model} of the generalised ABox \Amc (written
    $\Imc\models\Amc$) if it is a model of each generalised ABox-literal in
    \Amc.  We call \Amc \emph{consistent} if it has a model.
\end{definition}

\noindent
It is now obvious how to define knowledge bases that contain generalised ABoxes
instead of classical ones.  Recall that in this chapter we consider only DLs
between \ALC and \ALCQIO, and thus there is no RBox.

\begin{definition}[Generalised knowledge base]
    A \emph{generalised knowledge base} is a pair $\Kmc=(\Amc,\Tmc)$
    where \Amc is a generalised ABox and \Tmc is a TBox.

    The interpretation \Imc is a \emph{model} of \Kmc (written
    $\Imc\models\Kmc$) if it is a model of \Amc and \Tmc.  We call \Kmc
    \emph{consistent} if it has a model.

    We say that \Kmc \emph{entails} a generalised ABox-literal $\alpha$ (written
    $\Kmc\models\alpha$) if all models of \Kmc are also models of $\alpha$.
\end{definition}

\noindent
We are now ready to recall the notion of a DL-action without occlusions,%
\footnote{Occlusions describe which parts of the domain can change arbitrarily
when an action is applied.  Details about occlusions can be found
in~\cite{BLM+-AAAI05}.}
which has first been introduced in~\cite{BLM+-AAAI05}.  In this chapter, we do
not allow occlusions in our framework since it is not yet clear how to handle
them algorithmically in the presence of causal relationships.

\begin{definition}[Syntax of DL-actions]\label{def:action-syntax}
    A \emph{DL-action} is a pair $\abf=(\pre,\post)$ where
    \begin{itemize}
        \item \pre is a finite set of generalised ABox-literals called
            \emph{pre-conditions}, and
        \item \post is a finite set of \emph{conditional post-conditions} of the
            form $\alpha/\beta$ and \emph{unconditional post-conditions} of the
            form $\beta$, where $\alpha$ is a generalised ABox-literal and
            $\beta$ is an \emph{ABox-literal}.
    \end{itemize}
    %
    A DL-action is called \emph{unconditional} if all its post-conditions are
    unconditional.
\end{definition}

\noindent
Basically, a DL-action is applicable in an interpretation if all its
pre-conditions are satisfied, and the conditional post-condition $\alpha/\beta$
requires that $\beta$ must hold after applying the action if $\alpha$ was
satisfied before the application.
%
We can now express the hiring action of Example~\ref{ex:hiring-action} formally.

\begin{example}\label{ex:hiring-action-formally}
    A DL-action for hiring John would be formalised as
    \[\HireJohn:=(\emptyset,\ \{\Employee(\John)\}).\]
    This action has no pre-conditions and a single unconditional post-condition.
    %
    Additionally, the domain constraints are described in the following TBox:
    \begin{align*}
        \Tmc:=\bigl\{\ \{\AOK\}\sqcup\{\TK\}
        &\sqsubseteq\InsCom,\\
        \Employee
        &\sqsubseteq\exists\insBy.\InsCom\ \bigr\},
    \end{align*}
    where the first GCI states that AOK and TK are health-insurance companies,
    and the second GCI states that every employee needs to be insured by a
    health-insurance company.
\end{example}

\noindent
As sketched in Section~\ref{sec:ramification-problem}, this example can be used
to show that just considering the direct effects of the actions is not adequate
if the domain constraints are given by a general TBox containing arbitrary GCIs
rather than an acyclic TBox as it is done in~\cite{BLM+-AAAI05}.  To be more
precise, take a model~\Imc of the TBox~\Tmc such that we have
$\Imc\not\models\Employee(\John)$ and
$\Imc\not\models(\exists\insBy.\InsCom)(\John)$.  It should be clear that such a
model exists.  According to the semantics of DL-actions defined
in~\cite{BLM+-AAAI05}, after applying the DL-action \HireJohn to~\Imc, nothing
should change that is not explicitly required to be changed by some
post-condition.  Hence, if we apply \HireJohn to \Imc using that semantics, \Imc
is transformed into an interpretation~$\Imc'$ such that the only difference
to~\Imc is that $\Imc'\models\Employee(\John)$, i.e.~John is now an employee.
Since nothing else is allowed to change, we still have
$\Imc'\not\models(\exists\insBy.\InsCom)(\John)$.  This a counterexample to the
second GCI of \Tmc, and thus $\Imc'$ is not a model of~\Tmc.  Consequently, even
though the DL-action \HireJohn is applicable to \Imc---since the empty set of
pre-conditions does not impose any applicability condition---, its application
does not result in an interpretation satisfying the domain constraints in~\Tmc.
%
We call a DL-action where this kind of problem can occur an \emph{inconsistent
DL-action}.  To achieve consistency of the DL-action \HireJohn, we can
complement the DL-action with an appropriate causal relationship.

\begin{definition}[Causal relationship]\label{def:cr}
    A \emph{causal relationship} is of the form $\causes{\Amc_1}{\Amc_2}{\Bmc}$
    where $\Amc_1$, $\Amc_2$ are finite sets of ABox-literals, and \Bmc is a
    generalised ABox.
\end{definition}

\noindent
A causal relationship can be read as \enquote{$\Amc_1$ causes $\Amc_2$ if \Bmc
holds}.  To be more precise, it means the following: if \Bmc is satisfied
\emph{before} the application of a DL-action \abf, and $\Amc_1$ is \emph{newly}
satisfied by its application---i.e.~it was not satisfied before, but is
satisfied after the application of \abf---, then $\Amc_2$ must also be satisfied
\emph{after} the application of~\abf.%
\footnote{Actually, there are different ways of defining the meaning of causal
    relationships.  We follow here the approach used
    in~\cite{BeDT-ESSLLI98,DeTB-LEACIS98} rather than the one employed
    by~\cite{Lin-IJCAI95,Thi-AIJ97}.  The meaning of causal relationships
    in~\cite{Lin-IJCAI95,Thi-AIJ97} requires that \Bmc is satisfied
    \emph{after} the application of~\abf instead of before.}
Therefore, we often call $\Amc_1$ the \emph{trigger}, $\Amc_2$ the
\emph{consequence set}, and \Bmc the \emph{condition} of a causal relationship.

\begin{example}\label{ex:hiring-action-cr}
    Consider the causal relationship
    \[\causes{\{\Employee(\John)\}}%
        {\{\insBy(\John,\AOK)\}}%
        {\Bmc}\]
    with $\Bmc:=\{\lnot(\exists\insBy.\InsCom)(\John)\}$.  This causal
    relationship indeed adds the appropriate indirect effects to the direct
    effect of the DL-action \HireJohn.  It states that if John becomes newly
    employed---i.e.~he was not an employee before---, and he did not have a
    health insurance before the application of the DL-action, then he is newly
    insured with AOK after its application.  If on the other hand, John becomes
    newly employed, but already has a health insurance, then he keeps his old
    health insurance and is \emph{not} newly insured with AOK\@.  In both cases,
    the domain constraints stated in the TBox \Tmc of
    Example~\ref{ex:hiring-action-formally} stay satisfied.
\end{example}

\noindent
To define the semantics of DL-actions in the presence of causal relationships
formally, we need some more notions.
%
DL-actions and causal relationships as they are introduced above can only cause
changes to \emph{named} individuals, i.e.~state that a named individual does
(not) belong to an atomic concept, and similarly that pairs of named individuals
are (not) connected via a specific role.  Consequently, such \emph{effects} can
be described in an obvious way using ABox-literals.  Therefore, we sometimes
call a finite set of ABox-literals a \emph{set of effects}.

We define the set of \emph{direct effects} using the definition of the semantics
of DL-actions introduced in~\cite{BLM+-AAAI05}.

\begin{definition}[Direct effects]\label{def:direct-effects}
    For a DL-action $\abf=(\pre,\post)$, and an interpretation~\Imc,
    the \emph{set of direct effects of \abf on \Imc} is defined as
    \[\Dir(\abf,\Imc):=\{\beta\mid\beta\in\post\}\cup%
        \{\beta\mid\alpha/\beta\in\post\text{ and }\Imc\models\alpha\}.\]
\end{definition}

\noindent
Direct effects of a DL-action might cause indirect effects specified by causal
relationships.  Whether a specific causal relationship is applicable depends
both on the interpretation to which the DL-action is applied, and a set of
effects computed so far.

\begin{definition}[Indirect effects]\label{def:indirect-effects}
    The causal relationship $\causes{\Amc_1}{\Amc_2}{\Bmc}$ in the finite set of
    causal relationships~\CR is \emph{applicable to an interpretation~\Imc and a
    set of effects~\Emc} if
    \begin{enumerate}
        \item\label{enum:cr-condition}
            $\Imc\models\Bmc$,
        \item\label{enum:cr-trigger-one}
            $\Imc\not\models\Amc_1$, and
        \item\label{enum:cr-trigger-two}
            for every $\alpha\in\Amc_1$, either $\alpha\in\Emc$, or
            $\Imc\models\alpha$ and $\lnot\alpha\notin\Emc$.
    \end{enumerate}
    %
    The set of \emph{indirect effects of \CR on~\Imc and~\Emc} is defined as
    \[\Indir(\CR,\Imc,\Emc):=\{\beta\mid%
        \beta\in\Amc_2\text{ for some $\causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR$
        applicable to~\Imc and~\Emc}\}.\]
\end{definition}

\noindent
According to this definition, the causal relationship
$\causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR$ is applicable if the condition \Bmc is
satisfied in \Imc, i.e.~before applying the DL-action,
(Condition~\ref{enum:cr-condition}), and the trigger $\Amc_1$ is newly
satisfied, i.e.~$\Amc_1$ is not satisfied in~\Imc
(Condition~\ref{enum:cr-trigger-one}), but it is satisfied according to the
effect set~\Emc, i.e.~every generalised ABox-literal $\alpha\in\Amc_1$ is either
an effect, or it is satisfied in~\Imc, which is not changed by an effect
(Condition~\ref{enum:cr-trigger-two}).

Obviously, the indirect effects caused by a causal relationship may again cause
causal relationships to be applicable, which cause again indirect effects.
Thus, the overall effects of an action are obtained by iteratively adding
indirect effects to the direct ones until no new indirect effects can be added.

\begin{definition}[Effects]\label{def:effects}
    For a DL-action $\abf=(\pre,\post)$, a finite set of causal
    relationships \CR, and an interpretation~\Imc, the \emph{set of effects of
    \abf on \Imc w.r.t.~\CR} is defined as
    \[\Eff(\abf,\Imc,\CR):=\bigcup_{i\ge 0}\Eff_i(\abf,\Imc,\CR)\]
    where $\Eff_i(\abf,\Imc,\CR)$ is defined inductively as follows:
    \begin{itemize}
        \item $\Eff_0(\abf,\Imc,\CR):=\Dir(\abf,\Imc)$; and
        \item
            $\Eff_{i+1}(\abf,\Imc,\CR):=\Eff_i(\abf,\Imc,\CR)\cup\Indir(\CR,\Imc,\Eff_i(\abf,\Imc,\CR))$.
    \end{itemize}
\end{definition}

\noindent
Moreover, the set $\Eff(\abf,\Imc,\CR)$ can effectively be computed due to the
following arguments.  Firstly, we have by definition that
\[\Eff_0(\abf,\Imc,\CR)\subseteq\Eff_1(\abf,\Imc,\CR)\subseteq\Eff_2(\abf,\Imc,\CR)\subseteq\dots,\]
and secondly, since we add only
ABox-literals that belong to the consequence set of a causal relationship, and
the set \CR is moreover finite, there must exist an $n\ge 0$ such that
\[\Eff_n(\abf,\Imc,\CR)=\Eff_{n+1}(\abf,\Imc,\CR)=\Eff_{n+2}(\abf,\Imc,\CR)=\dots.\]
Thus, $\Eff(\abf,\Imc,\CR)=\Eff_n(\abf,\Imc,\CR)$, i.e.~we obtain
$\Eff(\abf,\Imc,\CR)$ after $n$ iterative steps, where $n$ is polynomially
bounded by the size of~\CR.

Note, however, that it could happen that the set $\Eff(\abf,\Imc,\CR)$ is
\emph{contradictory}, i.e.~that there is an ABox-literal $\alpha$ such that
$\{\alpha,\lnot\alpha\}\subseteq\Eff(\abf,\Imc,\CR)$.  Then it can, of
course, not lead to a well-defined successor interpretation.

We are now ready to formally define the semantics of DL-actions in the presence
of causal relationships.

\begin{definition}[Semantics of DL-actions]\label{def:action-semantics}
    Let $\abf=(\pre,\post)$ be a DL-action, \CR a finite set of
    causal relationships, \Tmc a TBox, and $\Imc=(\Delta^\Imc,\cdot^\Imc)$ and
    $\Imc'=(\Delta^{\Imc'},\cdot^{\Imc'})$ two interpretations.  We say that
    \emph{\abf is applicable to \Imc w.r.t.~\Tmc} if $\Imc\models\Tmc$ and
    $\Imc\models\pre$.  Moreover, \emph{\abf transforms \Imc into $\Imc'$
    w.r.t.~\Tmc and~\CR} (written $\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$) if
    \begin{enumerate}
        \item\label{enum:condition-applicable}
            \abf is applicable to \Imc w.r.t.~\Tmc;
        \item $\Delta^\Imc=\Delta^{\Imc'}$ and $a^\Imc=a^{\Imc'}$ for every
            $a\in\NI$;
        \item $\Imc'\models\Tmc$;
        \item\label{enum:condition-not-contradictory}
            $\Eff(\abf,\Imc,\CR)$ is not contradictory;
        \item for every $A\in\NC$, we have $A^{\Imc'}=(A^\Imc\cup A^+)\setminus
            A^-$ where
            \begin{align*}
                A^+ &:=\{a^\Imc\mid A(a)\in\Eff(\abf,\Imc,\CR)\}\text{, and}\\
                A^- &:=\{a^\Imc\mid\lnot A(a)\in\Eff(\abf,\Imc,\CR)\}\text{; and}
            \end{align*}
        \item for every $r\in\NR$, we have $r^{\Imc'}=(r^\Imc\cup r^+)\setminus
            r^-$ where
            \begin{align*}
                r^+ &:=\{(a^\Imc,b^\Imc)\mid r(a,b)\in\Eff(\abf,\Imc,\CR)\}\text{, and}\\
                r^- &:=\{(a^\Imc,b^\Imc)\mid\lnot r(a,b)\in\Eff(\abf,\Imc,\CR)\}.
            \end{align*}
    \end{enumerate}
    The finite sequence of DL-actions \emph{$\abf_1,\dots,\abf_n$
    transforms~\Imc into~$\Imc'$ w.r.t.~\Tmc and~\CR} (written
    $\Imc\Rightarrow_{\abf_1,\dots,\abf_n}^{\Tmc,\CR}\Imc'$) if there are
    interpretations $\Imc_0,\dots,\Imc_n$ such that $\Imc_0=\Imc$,
    $\Imc_n=\Imc'$, and $\Imc_{i-1}\Rightarrow_{\abf_i}^{\Tmc,\CR}\Imc_i$ for
    every $i$, $1\le i\le n$.
\end{definition}

\noindent
Note that if \Tmc and \CR are empty, then this semantics is very similar with
the one of DL-actions without occlusions given in~\cite{BLM+-AAAI05}.  However,
Condition~\ref{enum:condition-applicable} is not demanded in~\cite{BLM+-AAAI05},
which we do here for convenience.
%
The following lemma is an immediate consequence of this definition.

\begin{lemma}\label{lem:models-effects}
    Let \abf be a DL-action, \CR a finite set of causal relationships, \Tmc a
    TBox, and \Imc and~$\Imc'$ two interpretations.
    %
    If we have $\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$, then
    $\Imc'\models\Eff(\abf,\Imc,\CR)$.
\end{lemma}

\begin{proof}
    Assume that $\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$.  Then, by
    Definition~\ref{def:action-semantics}, we have that
    $\Eff(\abf,\Imc,\CR)$ is not contradictory.  Thus, we have that
    $A^+\cap A^-=\emptyset$ and $r^+\cap r^-=\emptyset$, where $A^+$, $A^-$,
    $r^+$, and $r^-$ are defined as in Definition~\ref{def:action-semantics}.
    %
    We prove that for every $\alpha\in\Eff(\abf,\Imc,\CR)$, we have
    $\Imc'\models\alpha$ by a case distinction.

    If $\alpha$ is of the form $A(a)$ for $A\in\NC$ and $a\in\NI$, we have that
    $a^\Imc\in A^+$.  Thus, Definition~\ref{def:action-semantics} yields that
    $a^{\Imc'}=a^\Imc\in(A^\Imc\cup A^+)\setminus A^-=A^{\Imc'}$.
    %
    If $\alpha$ is of the form $\lnot A(a)$ for $A\in\NC$ and $a\in\NI$, we have
    that $a^\Imc\in A^-$.  Again by Definition~\ref{def:action-semantics}, we
    have that $a^{\Imc'}=a^\Imc\notin(A^\Imc\cup A^+)\setminus A^-=A^{\Imc'}$.
    %
    If $\alpha$ is of the form $r(a,b)$ for $r\in\NR$ and $a,b\in\NI$, we have that
    $(a^\Imc,b^\Imc)\in r^+$.  Thus, Definition~\ref{def:action-semantics}
    yields that
    $(a^{\Imc'},b^{\Imc'})=(a^\Imc,b^\Imc)\in(r^\Imc\cup r^+)\setminus r^-=r^{\Imc'}$.
    %
    Finally, if $\alpha$ is of the form $\lnot r(a,b)$ for $r\in\NR$ and
    $a,b\in\NI$, we have that $(a^\Imc,b^\Imc)\in r^-$.
    Again, Definition~\ref{def:action-semantics} yields that
    $(a^{\Imc'},b^{\Imc'})=(a^\Imc,b^\Imc)\notin(r^\Imc\cup r^+)\setminus r^-=r^{\Imc'}$.
\end{proof}

\noindent
It is also important to note that the DL-actions defined here are
\emph{deterministic} in the following sense: for every model \Imc of \Tmc, there
exists \emph{at most one} interpretation~$\Imc'$ such that
$\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$.  There are several reasons why such an
interpretation $\Imc'$ might not exist.  Firstly, this is the case if
Condition~\ref{enum:condition-applicable} is violated, i.e.~\abf is not
applicable to~\Imc w.r.t.~\Tmc.  A second reason is that even if
Condition~\ref{enum:condition-applicable} is satisfied,
Condition~\ref{enum:condition-not-contradictory} is violated, i.e.~the set
$\Eff(\abf,\Imc,\CR)$ is contradictory.  Lastly, it might be the case that
Conditions~\ref{enum:condition-applicable}
and~\ref{enum:condition-not-contradictory} are satisfied, but the new
interpretation induced by $\Eff(\abf,\Imc,\CR)$ is not a model of~\Tmc.  If such
an $\Imc'$ does not exist, even if Condition~\ref{enum:condition-applicable} is
satisfied, this indicates a modelling error.  In fact, the correct modelling of
an action theory should ensure that for every applicable DL-action, there is a
well-defined successor state.

\begin{definition}[Consistency problem]\label{def:consistency}
    The DL-action $\abf=(\pre,\post)$ is \emph{consistent} w.r.t.\
    the TBox~\Tmc and the finite set~\CR of causal relationships if for every
    interpretation~\Imc such that \abf is applicable to~\Imc w.r.t.~\Tmc, there
    exists an interpretation $\Imc'$ such that
    $\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$.

    The \emph{consistency problem} is then to decide whether \abf is consistent
    w.r.t.~\Tmc and~\CR.
\end{definition}

\noindent
As argued above, the DL-action \HireJohn of
Example~\ref{ex:hiring-action-formally} is \emph{not} consistent w.r.t.\ the
TBox~\Tmc defined there and the empty set of causal relationships.  However, it
becomes consistent if we add the causal relationship of
Example~\ref{ex:hiring-action-cr}.

We are now ready to define the projection problem formally.  Recall that it
deals with the question whether for a given (possible incomplete) description of
the initial state, a certain property is guaranteed to hold after the execution
of a sequence of DL-actions.
%
Our formal definition of this problem is very similar to the one
from~\cite{BLM+-AAAI05}, with the difference that we use the
\enquote{transforms} relation ($\Rightarrow_{\abf}^{\Tmc,\CR}$) introduced in
Definition~\ref{def:action-semantics}, which takes a general TBox and a set of
causal relationships into account, instead of the one employed
in~\cite{BLM+-AAAI05}.

\begin{definition}[Projection problem]\label{def:projection}
    Let \Amc be a generalised ABox, \Tmc be a TBox, \CR be a finite set of
    causal relationships, $\alpha$ be a generalised ABox-literal, and
    $\abf_1,\dots,\abf_n$ be a sequence of DL-actions such that the DL-action
    $\abf_i$ is consistent w.r.t.~\Tmc and~\CR for every $i$, $1\le i\le n$.
    %
    We say that \emph{$\alpha$ is a consequence of applying
    $\abf_1,\dots,\abf_n$ to~\Amc w.r.t.~\Tmc and~\CR} if for every \Imc and
    $\Imc'$ with $\Imc\models\Amc$ and
    $\Imc\Rightarrow_{\abf_1,\dots,\abf_n}^{\Tmc,\CR}\Imc'$, we have
    $\Imc'\models\alpha$.

    The \emph{projection problem} is then to decide whether $\alpha$ is a
    consequence of applying $\abf_1,\dots,\abf_n$ to~\Amc w.r.t.~\Tmc and~\CR.
\end{definition}

\noindent
Note that in this definition, we consider only DL-actions that are
\emph{consistent w.r.t.~\Tmc and~\CR}.  As argued above, if any DL-action is
inconsistent w.r.t.~\Tmc and~\CR, then this indicates a modelling error in the
action theory, and this issue should be addressed before starting to ask
projection questions.  However, it could also happen that not all pre-conditions
are guaranteed to be satisfied during the execution of a sequence of DL-actions.
The \emph{executability problem}~\cite{Rei-01}, another interesting inference
problem for action theories, deals with this question.

\begin{definition}[Executability problem]\label{def:executability}
    Let \Amc be a generalised ABox, \Tmc be a TBox, \CR be a finite set of
    causal relationships, and $\abf_1,\dots,\abf_n$ be a sequence of DL-actions
    such that the DL-action $\abf_i=(\pre_i,\post_i)$ is consistent
    w.r.t.~\Tmc and~\CR for every $i$, $1\le i\le n$.
    %
    We say that $\abf_1,\dots,\abf_n$ is \emph{executable} in~\Amc w.r.t.~\Tmc
    and~\CR if for every model~\Imc of~\Amc and~\Tmc, we have:
    \begin{itemize}
        \item $\Imc\models\pre_1$, and
        \item for every $i$, $1\le i<n$, and all interpretations $\Imc'$ with
            $\Imc\Rightarrow_{\abf_1,\dots,\abf_i}^{\Tmc,\CR}\Imc'$, we have
            $\Imc'\models\pre_{i+1}$.
    \end{itemize}
    The \emph{executability problem} is then to decide whether
    $\abf_1,\dots,\abf_n$ is executable in~\Amc w.r.t.~\Tmc and~\CR.
\end{definition}

\noindent
Usually, before one asks for projection questions, one checks whether the
sequence of DL-actions is indeed executable.  However, Lemma~4
in~\cite{BLM+-AAAI05} states that for the action formalism defined there, the
projection and the executability problem can be reduced to each other in
polynomial time.  The actual proof is shown in~\cite{BLM+-LTCS-05-02}; there it
is Lemma~11.  The arguments can also be used to show that for the action
formalism defined here, each executability problem can be reduced to
polynomially many projection problems in polynomial time.%
\footnote{The converse direction, i.e.~that the projection problem can be
reduced to the executability problem in polynomial time, does not follow from
the arguments in~\cite{BLM+-LTCS-05-02}, because we take the pre-condition into
account when defining the \enquote{transforms} relation
($\Rightarrow_{\abf}^{\Tmc,\CR}$).} We repeat these arguments
from~\cite{BLM+-LTCS-05-02} for the sake of completeness.

\begin{theorem}
    The executability problem as introduced in
    Definition~\ref{def:executability} can be reduced to polynomially many
    projection problems as introduced in Definition~\ref{def:projection} in
    polynomial time.
\end{theorem}

\begin{proof}
    Take a generalised ABox~\Amc, a TBox~\Tmc, a finite set of causal
    relationships~\CR, a generalised ABox-literal~$\alpha$, and a sequence of
    DL-actions $\abf_1,\dots,\abf_n$ such that the DL-action
    $\abf_i=(\pre_i,\post_i)$ is consistent w.r.t.~\Tmc and~\CR for
    every $i$, $1\le i\le n$.
    %
    We have that $\abf_1,\dots,\abf_n$ is executable in~\Amc w.r.t.~\Tmc and~\CR
    iff
    \begin{enumerate}
        \item for every $\beta\in\pre_1$, we have that $\beta$ is a consequence
            of applying $(\emptyset,\emptyset)$ to~\Amc w.r.t.~\Tmc
            and~\CR; and
        \item for every $i$, $1\le i<n$, and every $\beta\in\pre_{i+1}$, we have
            that $\beta$ is a consequence of applying $\abf_1,\dots,\abf_i$
            to~\Amc w.r.t.~\Tmc and~\CR.
    \end{enumerate}
    It is easy to see that these are polynomially many projection problems,
    where each can be constructed in polynomial time.
\end{proof}

\noindent
For this reason, we can restrict our attention to the consistency and the
projection problem for showing decidability and complexity results.  We first
consider the consistency problem in Section~\ref{sec:consistency}, and then the
projection problem in Section~\ref{sec:projection}.  Finally, in
Section~\ref{sec:verifying-actions}, we consider the problem of verifying
temporal properties.


\section{Deciding the Consistency Problem}\label{sec:consistency}

In this section, we first consider the case where the TBox is empty,
and develop a solution for this restricted case.  After that, we show how this
solution can be extended to deal with the general case.


\subsection{Deciding the Consistency Problem w.r.t.\ the Empty TBox}

In this section, we show that testing consistency of a DL-action w.r.t.\ the
empty TBox and a finite set of causal relationships is decidable and has the
same complexity as checking \emph{in}consistency of a generalised ABox.

Given a DL-action \abf and a finite set of causal relationships \CR, we
basically consider all possible situations that \abf could encounter when it is
applied to an interpretation.  The relevant information is kept in a so-called
\emph{action type}.%
\footnote{In~\cite{BaLL-LPAR10}, this is called a \emph{diagram}.}
For this, we define for a DL-action $\abf=(\pre,\post)$ and a finite
set of causal relationships \CR, the set $\Cond(\abf,\CR)$ as the closure under
negation ($\lnot$) of the set
\[\{\alpha\mid\alpha/\beta\in\post\}\cup%
    \{\alpha\mid\alpha\in\Amc_1\cup\Bmc%
    \text{ for some }\causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR\}.\]

\begin{definition}[Action type]\label{def:action-type}
    An \emph{action type for a DL-action \abf and a finite set of causal
    relationships \CR} is a generalised ABox $T\subseteq\Cond(\abf,\CR)$ such
    that
    \begin{itemize}
        \item $\lnot\alpha\in T$ iff $\alpha\notin T$ for every
            $\lnot\alpha\in\Cond(\abf,\CR)$; and
        \item $T$ is consistent.
    \end{itemize}
\end{definition}

\noindent
We denote the set of all action types for a DL-action \abf and a finite set of
causal relationships \CR by $\Tmf(\abf,\CR)$.
%
Moreover, for a given interpretation \Imc, there is exactly one action type
$T\in\Tmf(\abf,\CR)$ such that $\Imc\models T$.

\begin{lemma}\label{lem:unique-action-type}
    Let \abf be a DL-action, and \CR a finite set of causal relationships.  For
    a given interpretation \Imc, there is one unique action type
    $T\in\Tmf(\abf,\CR)$ such that $\Imc\models T$.
\end{lemma}

\begin{proof}
    Given an interpretation \Imc, we define
    $T:=\{\alpha\in\Cond(\abf,\CR)\mid\Imc\models\alpha\}$.  We have obviously
    that $T\in\Tmf(\abf,\CR)$ and $\Imc\models T$.  It is left to be shown that
    $T$ is unique.  Assume to the contrary that there is a $T'\in\Tmf(\abf,\CR)$
    with $\Imc\models T'$ and $T\ne T'$.  Since $T$ and $T'$ are non-equal
    action types for \abf and \CR, there is a generalised ABox-literal $\alpha$
    with $\alpha\in T$ and $\alpha\notin T'$, and thus $\lnot\alpha\in T'$.
    Since $\Imc\models T$ and $\Imc\models T'$, we have that $\Imc\models\alpha$
    and $\Imc\models\lnot\alpha$, i.e.~$\Imc\not\models\alpha$, which is a
    contradiction.
\end{proof}

\noindent
We now continue by defining for an action type $T\in\Tmf(\abf,\CR)$, a set
$\Eff(\abf,T,\CR)$, which describes the set of effects that \abf has on $T$
w.r.t.~\CR.  We can show that for every interpretation~\Imc with
$\Imc\models T$, we have $\Eff(\abf,T,\CR)=\Eff(\abf,\Imc,\CR)$, and thus it is
sufficient to know the unique action type $T\in\Tmf(\abf,\CR)$ with
$\Imc\models T$ to determine the direct and indirect effects of applying~\abf
to~\Imc w.r.t.~\CR.

The definition of the set of \emph{direct effects} on $T$ is very similar to
Definition~\ref{def:direct-effects}.

\begin{definition}[Direct effects on action type]\label{def:direct-effects-type}
    For a DL-action $\abf=(\pre,\post)$, a finite set of causal
    relationships \CR, and an action type $T\in\Tmf(\abf,\CR)$,
    the \emph{set of direct effects of \abf on $T$} is defined as
    \[\Dir(\abf,T):=\{\beta\mid\beta\in\post\}\cup%
        \{\beta\mid\alpha/\beta\in\post\text{ and }\alpha\in T\}.\]
\end{definition}

\noindent
The definition of the set of \emph{indirect effects} on $T$ is very similar to
Definition~\ref{def:indirect-effects}.

\begin{definition}[Indirect effects on action type]\label{def:indirect-effects-type}
    The causal relationship $\causes{\Amc_1}{\Amc_2}{\Bmc}$ in the finite set of
    causal relationships~\CR is \emph{applicable to an action type~$T$ and a set
    of effects~\Emc} iff
    \begin{enumerate}
        \item $\Bmc\subseteq T$,
        \item $\Amc_1\not\subseteq T$, and
        \item for every $\alpha\in\Amc_1$, either $\alpha\in\Emc$, or
            $\alpha\in T$ and $\lnot\alpha\notin\Emc$.
    \end{enumerate}
    %
    The set of \emph{indirect effects of \CR on~$T$ and~\Emc} is defined as
    \[\Indir(\CR,T,\Emc):=\{\beta\mid%
        \beta\in\Amc_2\text{ for some $\causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR$
        applicable to~$T$ and~\Emc}\}.\]
\end{definition}

\noindent
Finally, the set of \emph{effects} on $T$ can be defined similar to what was
done for Definition~\ref{def:effects}.

\begin{definition}[Effects on action type]\label{def:effects-type}
    For a DL-action $\abf=(\pre,\post)$, a finite set of causal
    relationships \CR, and an action type $T\in\Tmf(\abf,\CR)$, the \emph{set of
    effects of \abf on $T$ w.r.t.~\CR} is defined as
    $\Eff(\abf,T,\CR):=\bigcup_{i\ge 0}\Eff_i(\abf,T,\CR)$ where
    $\Eff_i(\abf,T,\CR)$ is defined inductively as follows:
    \begin{itemize}
        \item $\Eff_0(\abf,T,\CR):=\Dir(\abf,T)$; and
        \item
            $\Eff_{i+1}(\abf,T,\CR):=\Eff_i(\abf,T,\CR)\cup\Indir(\CR,T,\Eff_i(\abf,T,\CR))$.
    \end{itemize}
\end{definition}

\noindent
Again, the set $\Eff(\abf,T,\CR)$ can effectively be computed due to the same
arguments that we used above to show that $\Eff(\abf,\Imc,\CR)$ can be computed
effectively.  Moreover, it is not hard to see that the set $\Eff(\abf,T,\CR)$
can be computed in time polynomial in the size of~\abf, $T$, and \CR.
%
Similar to before, we say that $\Eff(\abf,T,\CR)$ is \emph{contradictory} if
there is an ABox-literal $\alpha$ such that
$\{\alpha,\lnot\alpha\}\subseteq\Eff(\abf,T,\CR)$.

\begin{lemma}\label{lem:effects-by-type}
    Let \abf be a DL-action, \CR be a finite set of causal relationships, and
    $T$ be an action type for~\abf and~\CR.  Then, for every interpretation~\Imc
    with $\Imc\models T$, we have that $\Eff(\abf,\Imc,\CR)=\Eff(\abf,T,\CR)$.
\end{lemma}

\begin{proof}
    Take any interpretation~\Imc with $\Imc\models T$.  We first show the
    following claim.

    \begin{claim}\label{claim:cond}
        Let $\alpha\in\Cond(\abf,\CR)$, and $\Amc\subseteq\Cond(\abf,\CR)$.
        Then, we have
        \begin{enumerate}
            \item\label{enum:claim-property-assertion}
                $\Imc\models\alpha$ iff $\alpha\in T$,
            \item\label{enum:claim-property-abox}
                $\Imc\models\Amc$ iff $\Amc\subseteq T$,
            \item\label{enum:claim-property-dir}
                $\Dir(\abf,\Imc)=\Dir(\abf,T)$, and
            \item\label{enum:claim-property-indir}
                $\Indir(\CR,\Imc,\Emc)=\Indir(\CR,T,\Emc)$ for every set of
                effects~\Emc.
        \end{enumerate}
    \end{claim}

    \noindent
    The \enquote{if} direction of Part~\ref{enum:claim-property-assertion} of
    the claim is trivial since $\Imc\models T$.  To prove the \enquote{only if}
    direction, assume that $\Imc\models\alpha$, but $\alpha\notin T$.  Since
    $T\in\Tmf(\abf,\CR)$ and $\alpha\in\Cond(\abf,\CR)$, we have $\lnot\alpha\in
    T$.  Then $\Imc\models T$ yields $\Imc\models\lnot\alpha$,
    i.e.~$\Imc\not\models\alpha$, which is a contradiction.

    To prove Part~\ref{enum:claim-property-abox} of the claim, take any
    $\beta\in\Amc$.  Since $\beta\in\Cond(\abf,\CR)$, we have now by
    Part~\ref{enum:claim-property-assertion} of the claim that
    $\Imc\models\beta$ iff $\beta\in T$, which finishes this part of the claim.

    For Part~\ref{enum:claim-property-dir} of the claim, let
    $\abf=(\pre,\post)$.  We have:
    \begin{align*}
        \Dir(\abf,\Imc)
        &=\{\beta\mid\beta\in\post\}\cup\{\beta\mid\alpha/\beta\in\post\ \text{and}\ \Imc\models\alpha\}
        &\text{(by Definition~\ref{def:direct-effects})}\\
        &=\{\beta\mid\beta\in\post\}\cup\{\beta\mid\alpha/\beta\in\post\ \text{and}\ \alpha\in T\}
        &\text{(by Part~\ref{enum:claim-property-assertion} of the claim)}\\
        &=\Dir(\abf,T)
        &\text{(by Definition~\ref{def:direct-effects-type})}
    \end{align*}

    Finally, to prove Part~\ref{enum:claim-property-indir}, take any causal
    relationship $\causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR$, and any set of
    effects~\Emc.  We have:
    \begin{itemize}
        \item[]
            $\causes{\Amc_1}{\Amc_2}{\Bmc}$ is applicable to~\Imc and~\Emc
        \item[\emph{iff}]
            $\Imc\models\Bmc$, $\Imc\not\models\Amc_1$, and
            for every $\alpha\in\Amc_1$, either $\alpha\in\Emc$, or
            $\Imc\models\alpha$ and $\lnot\alpha\notin\Emc$\\
            (by Definition~\ref{def:indirect-effects})
        \item[\emph{iff}]
            $\Bmc\subseteq T$, $\Amc_1\not\subseteq T$, and
            for every $\alpha\in\Amc_1$, either $\alpha\in\Emc$, or
            $\alpha\in T$ and $\lnot\alpha\notin\Emc$\\
            (by Parts~\ref{enum:claim-property-assertion}
            and~\ref{enum:claim-property-abox} of the claim)
        \item[\emph{iff}]
            $\causes{\Amc_1}{\Amc_2}{\Bmc}$ is applicable to~$T$ and~\Emc\\
            (by Definition~\ref{def:indirect-effects-type}).
    \end{itemize}
    %
    This yields using Definitions~\ref{def:indirect-effects}
    and~\ref{def:indirect-effects-type}:
    \begin{align*}
        \Indir(\CR,\Imc,\Emc)
        &=\{\beta\mid\beta\in\Amc_2\ \text{for some}\ \causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR\ \text{applicable to~\Imc and~\Emc}\}\\
        &=\{\beta\mid\beta\in\Amc_2\ \text{for some}\ \causes{\Amc_1}{\Amc_2}{\Bmc}\in\CR\ \text{applicable to~$T$ and~\Emc}\}\\
        &=\Indir(\CR,T,\Emc).
    \end{align*}
    %
    This finishes the proof the Claim~\ref{claim:cond}.

    To prove $\Eff(\abf,\Imc,\CR)=\Eff(\abf,T,\CR)$, it is enough to prove by
    induction that we have $\Eff_i(\abf,\Imc,\CR)=\Eff_i(\abf,T,\CR)$ for every
    $i\ge 0$.
    %
    For $i=0$, we have by Definitions~\ref{def:effects}
    and~\ref{def:effects-type}, and Part~\ref{enum:claim-property-dir} of
    Claim~\ref{claim:cond}:
    \[\Eff_0(\abf,\Imc,\CR)=\Dir(\abf,\Imc)=\Dir(\abf,T)=\Eff_0(\abf,T,\CR).\]
    %
    For $i>0$, we have again by Definitions~\ref{def:effects}
    and~\ref{def:effects-type}, Part~\ref{enum:claim-property-indir} of
    Claim~\ref{claim:cond}, and the induction hypothesis:
    \begin{align*}
        \Eff_i(\abf,\Imc,\CR)
        &=\Eff_{i-1}(\abf,\Imc,\CR)\cup\Indir(\CR,\Imc,\Eff_{i-1}(\abf,\Imc,\CR))\\
        &=\Eff_{i-1}(\abf,T,\CR)\cup\Indir(\CR,\Imc,\Eff_{i-1}(\abf,T,\CR))\\
        &=\Eff_{i-1}(\abf,T,\CR)\cup\Indir(\CR,T,\Eff_{i-1}(\abf,T,\CR))\\
        &=\Eff_i(\abf,T,\CR).
        %\qedhere
    \end{align*}
\end{proof}

\noindent
Using this lemma, we can show that checking which of the sets of effects
$\Eff(\abf,T,\CR)$, with $T\in\Tmf(\abf,\CR)$, are contradictory is sufficient
for deciding whether the DL-action \abf is consistent w.r.t.\ the empty TBox and
a finite set of causal relationships~\CR.  In fact, there are only two reasons
for an interpretation~\Imc that there does not exist an interpretation~$\Imc'$
such that $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$ if the TBox is assumed
to be empty: either \abf is not applicable to~\Imc, or the set
$\Eff(\abf,\Imc,\CR)$ is contradictory.  Since for \abf being consistent, we
require the existence of~$\Imc'$ only for interpretations \Imc such that \abf is
applicable to~\Imc, it is enough to consider the action types $T$ that are
consistent with the pre-condition of~\abf.

\begin{lemma}\label{lem:consistency-no-tbox}
    The DL-action $\abf=(\pre,\post)$ is consistent w.r.t.\ the
    empty TBox and a finite set of causal relationships~\CR iff the set of
    effects $\Eff(\abf,T,\CR)$ is not contradictory for each
    $T\in\Tmf(\abf,\CR)$ for which $T\cup\pre$ is consistent.
\end{lemma}

\begin{proof}
    For the \enquote{only if} direction, assume to the contrary that there
    exists an action type $T\in\Tmf(\abf,\CR)$ such that $T\cup\pre$ is
    consistent, but $\Eff(\abf,T,\CR)$ is contradictory.  Then, there is an
    interpretation~\Imc such that $\Imc\models T\cup\pre$, and thus also that
    $\Imc\models T$ and $\Imc\models\pre$.  This yields that \abf is applicable
    to~\Imc w.r.t.\ the empty TBox.  However, since $\Imc\models T$, we have by
    Lemma~\ref{lem:effects-by-type} that $\Eff(\abf,\Imc,\CR)=\Eff(\abf,T,\CR)$.
    Hence, the set of effects $\Eff(\abf,\Imc,\CR)$ is contradictory.  But then,
    by Definition~\ref{def:action-semantics}, we have that there is no
    interpretation~$\Imc'$ such that
    $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$, which is a contradiction to
    \abf being consistent w.r.t.\ the empty TBox and~\CR.

    For the \enquote{if} direction, assume to the contrary that \abf is not
    consistent w.r.t.\ the empty TBox and~\CR.  Then there exists an
    interpretation~\Imc with the following two properties: \abf is applicable
    to~\Imc w.r.t.\ the empty TBox, and there is no interpretation~$\Imc'$ with
    $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$.  By
    Definition~\ref{def:action-semantics}, we have that $\Eff(\abf,\Imc,\CR)$ is
    contradictory.  By Lemma~\ref{lem:unique-action-type}, there is one unique
    action type $T\in\Tmf(\abf,\CR)$ such that $\Imc\models T$.
    Lemma~\ref{lem:effects-by-type} yields that
    $\Eff(\abf,T,\CR)=\Eff(\abf,\Imc,\CR)$, and thus we have that
    $\Eff(\abf,T,\CR)$ is contradictory.  Moreover, since \abf is applicable
    to~\Imc w.r.t.\ the empty TBox, we have $\Imc\models\pre$, and thus,
    together with $\Imc\models T$, that $T\cup\pre$ is consistent, which yields
    a contradiction.
\end{proof}

\noindent
We use this lemma to design a decision procedure for deciding whether a
DL-action is consistent w.r.t.\ the empty TBox and a finite set of causal
relationships.  The complexity of this problem depends on the DL used.

\begin{theorem}\label{thm:complexity-consistency-no-tbox}
    The problem of deciding whether a DL-action is consistent w.r.t.\ the empty
    TBox and a finite set of causal relationships is
    \begin{enumerate}
        \item\label{enum:part-alcqo}
            \PSpace-complete for DLs between~\ALC and~\ALCQO;
        \item\label{enum:part-alcqi}
            \PSpace-complete for DLs between~\ALC and~\ALCQI;
        \item\label{enum:part-alcio}
            \ExpTime-complete for \ALCIO; and
        \item\label{enum:part-alcqio}
            \coNExpTime-complete for \ALCQIO.
    \end{enumerate}
\end{theorem}

\begin{proof}
    We first prove the lower bounds.  We reduce the ABox-\emph{in}consistency
    problem, i.e.~the problem of deciding whether a given ABox is
    \emph{in}consistent, to our DL-action consistency problem.  Take any
    ABox~\Amc.  It is easy to see that \Amc is \emph{in}consistent iff the
    DL-action $(\Amc,\{A(a),\lnot A(a)\})$ is consistent w.r.t.\ the
    empty TBox and the empty set of causal relationships, where $A\in\NC$ and
    $a\in\NI$ are arbitrary.

    We have \PSpace-hardness for Parts~\ref{enum:part-alcqo}
    and~\ref{enum:part-alcqi} of the theorem, since
    the ABox-consistency problem is \PSpace-complete for the description
    logics
    \ALC~\cite{ScSm-AIJ91}, \ALCQO~\cite{Sch-DKE94,BLM+-LTCS-05-02}, and
    \ALCQI~\cite{Tob-PhD01}, and \PSpace is closed under complement.\footnote{%
        Note that in~\cite{BLM+-LTCS-05-02}, \PSpace-completeness of the
        ABox-consistency problem for \ALCQO is proved only for the case of unary
        coding of the numbers in the at-least and at-most restrictions.  It is
        conjectured in~\cite{BLM+-LTCS-05-02}, however, that with similar
        arguments, one obtains \PSpace-completeness also for the case of binary
        coding.  For \ALCQI, it is proved explicitly that the ABox-consistency
        problem is \PSpace-complete even if the numbers are coded in
        binary~\cite{Tob-PhD01}.}
    We obtain \ExpTime-hardness for Part~\ref{enum:part-alcio} of the theorem,
    because the ABox-consistency problem for \ALCIO is
    \ExpTime-complete~\cite{ArBM-CSL99}, and the class \ExpTime is closed under
    complement.  Finally, \coNExpTime-hardness for Part~\ref{enum:part-alcqio}
    of the theorem is obtained, because the ABox-consistency problem for \ALCQIO
    is \NExpTime-complete~\cite{Sch-DKE94,Tob-JAIR00,Pra-JLLI05}.\footnote{%
        This is even the case if the number in the at-least and at-most
        restrictions are coded in binary, because one can reduce the
        ABox-consistency problem for \ALCQIO to the satisfiability problem for
        $C^2$ with counting quantifiers~\cite{BLM+-LTCS-05-02}, which is
        \NExpTime-complete even if the numbers are coded in
        binary~\cite{Pra-JLLI05}.}

    To prove the upper bounds for Parts~\ref{enum:part-alcqo}
    and~\ref{enum:part-alcqi} of the theorem, we give an \NPSpace-decision
    procedure for deciding whether a DL-action is \emph{in}consistent w.r.t.\
    the empty TBox and a finite set of causal relationships.\footnote{%
        Recall that Savitch's theorem~\cite{Sav-JCSS70} implies that \NPSpace
        and \PSpace coincide, and that \PSpace is closed under complement.}
    Given a DL-action $\abf=(\pre,\post)$ and a finite set of causal
    relationships~\CR, the decision procedure consists of three steps.
    \begin{enumerate}
        \item Non-deterministically guess an action type $T\in\Tmf(\abf,\CR)$.
        \item Check whether the generalised ABox $T\cup\pre$ is consistent.
        \item If Step~2 was successful, compute the set $\Eff(\abf,T,\CR)$, and
            check whether it is contradictory.
    \end{enumerate}
    If in Step~3, we obtain a contradictory set of effects, we know by
    Lemma~\ref{lem:consistency-no-tbox} that \abf is \emph{not} consistent
    w.r.t.\ the empty TBox and~\CR.  Otherwise, \abf is consistent w.r.t.\ the
    empty TBox and~\CR.

    Step~1 can be done in \PSpace, because the set $\Tmf(\abf,\CR)$ is of size
    exponential in the size of~\abf and~\CR, but each action type
    $T\in\Tmf(\abf,\CR)$ is only of polynomial size.

    The consistency test in Step~2 can polynomially be reduced to the
    consistency problem of classical ABoxes~\cite{BLM+-LTCS-05-02}.  Indeed, a
    generalised ABox~\Amc can be transformed into a classical ABox~$\Amc'$ such
    that \Amc is consistent iff $\Amc'$ is consistent as follows.  Obviously,
    every negative concept assertion $\lnot\alpha(a)$ in~\Amc can be replaced by
    $(\lnot\alpha)(a)$ without affecting the consistency of~\Amc.  Every
    negative role assertion $\lnot r(a,b)$ in~\Amc can be replaced by the two
    concept assertions $(\lnot\exists r.A_b)(a)$ and $A_b(b)$, where $A_b$ is a
    concept name not occurring in~\Amc.  It is not hard to verify that \Amc is
    consistent iff $\Amc'$ is consistent.  As noted above, the ABox-consistency
    problem is \PSpace-complete for \ALCQO and \ALCQI.  Thus, the check
    whether $T\cup\pre$ is consistent can be done in \PSpace for the DLs \ALCQO
    and~\ALCQI.

    Step~3 can also be done in \PSpace, because computing the set
    $\Eff(\abf,T,\CR)$ can be realised by performing the iteration used in the
    definition of $\Eff(\abf,T,\CR)$.  As argued above, this can be done in
    time polynomial in the size of~\abf, $T$, and \CR.  Checking whether this
    set of effects is contradictory is obviously also possible in polynomial
    time.

    To prove Part~\ref{enum:part-alcqio} of the theorem, we proceed similarly.
    We employ the same decision procedure as above for checking whether the
    DL-action~\abf is \emph{in}consistent w.r.t.\ the empty TBox and the finite
    set of causal relationships~\CR.  Since now the underlying DL is \ALCQIO
    with the arguments above, this can be done in \NExpTime.  Hence, we obtain
    that the complement of this problem is in \coNExpTime.

    Finally, for Part~\ref{enum:part-alcio} of the theorem, in order to check
    whether the DL-action $\abf=(\pre,\post)$ is consistent w.r.t.\
    the empty TBox and the finite set of causal relationships~\CR, we compute
    the set $\Tmf(\abf,\CR)$ explicitly.  Now, we check for each
    $T\in\Tmf(\abf,\CR)$, whether $T\cup\pre$ is consistent.  Then, we compute
    the set $\Eff(\abf,T,\CR)$, and check whether it is contradictory.  If no
    contradictory set of effects is found, we know that \abf is consistent
    w.r.t.\ the empty TBox and~\CR.  Otherwise, \abf is inconsistent w.r.t.\ the
    empty TBox and~\CR.  Using the arguments from above, this yields an
    \ExpTime-decision procedure.
\end{proof}

\noindent
In the next section, we consider the consistency problem for the case where the
TBox is general, i.e.~a finite set of GCIs.


\subsection{Deciding the Consistency Problem w.r.t.\ a General TBox}

If the TBox is not assumed to be empty, the picture changes.  We can no longer
obtain an easy characterisation of consistent DL-actions as for the case where
the TBox is assumed to be empty.  In this case, the criterion for a DL-action to
be consistent w.r.t.\ the empty TBox and a finite set of causal relationships
stated in Lemma~\ref{lem:consistency-no-tbox} is a necessary but not a
sufficient condition.  In fact, it could happen that a not contradictory set of
effects induces a successor interpretation that is not a model of the TBox.
This is an additional possible reason for a DL-action~\abf to be inconsistent
w.r.t.\ a TBox~\Tmc and a finite set of causal relationships~\CR.  Thus, one
needs to check additionally for each action type $T\in\Tmf(\abf,\CR)$, whether
for any model~\Imc of~\Tmc and~$T$ that satisfies the preconditions of~\abf, the
interpretation~$\Imc'$ obtained from~\Imc by applying the effects in
$\Eff(\abf,T,\CR)$ (see Definition~\ref{def:action-semantics}) is a model
of~\Tmc.  For this purpose, we define an unconditional DL-action
$\bbf_{\abf,T,\CR}$ that has the same effects as~\abf and~\CR if applied to a
model of~$T$.  Then, we adapt the approach to solving the projection problem
introduced in~\cite{BLM+-AAAI05} in order to decide whether $\bbf_{\abf,T,\CR}$
transforms models of~\Tmc into models of~\Tmc.

\begin{definition}
    Let $\abf=(\pre,\post)$ be a DL-action, \CR a finite set of
    causal relationships, and $T\in\Tmf(\abf,\CR)$.  The unconditional DL-action
    $\bbf_{\abf,T,\CR}$ is defined as follows:
    \[\bbf_{\abf,T,\CR}:=(\pre\cup T,\ \Eff(\abf,T,\CR)).\]
\end{definition}

\noindent
The following lemma is a direct consequence of the definition of the set of
effects $\Eff(\abf,T,\CR)$ (see Definition~\ref{def:effects-type}), the
semantics of DL-actions (see Definition~\ref{def:action-semantics}), and
Lemma~\ref{lem:consistency-no-tbox}.

\begin{lemma}\label{lem:sim-cr}
    For every $T\in\Tmf(\abf,\CR)$, every model~\Imc of $T$, and every
    interpretation~$\Imc'$, we have
    $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$ iff
    $\Imc\Rightarrow_{\bbf_{\abf,T,\CR}}^{\emptyset,\emptyset}\Imc'$.
\end{lemma}

\begin{proof}
    Take any action type $T\in\Tmf(\abf,\CR)$, and any interpretation~\Imc with
    $\Imc\models T$.  We have by the construction of $\bbf_{\abf,T,\CR}$ that
    $\Dir(\bbf_{\abf,T,\CR},T)=\Eff(\abf,T,\CR)$.  Thus, we have also that
    $\Eff(\bbf_{\abf,T,\CR},T,\emptyset)=\Eff(\abf,T,\CR)$.
    By Lemma~\ref{lem:consistency-no-tbox}, this yields
    $\Eff(\bbf_{\abf,T,\CR},\Imc,\emptyset)=\Eff(\abf,\Imc,\CR)$.  Finally,
    together with Definition~\ref{def:action-semantics}, we obtain
    $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$ iff
    $\Imc\Rightarrow_{\bbf_{\abf,T,\CR}}^{\emptyset,\emptyset}\Imc'$.
\end{proof}

\noindent
The approach to solving the projection problem introduced in~\cite{BLM+-AAAI05}
considers a finite sequence of DL-actions $\bbf_1,\dots,\bbf_n$.  In this
section, however, we are only interested in the special case where $n=1$.  Since
we will adopt the same approach also in Section~\ref{sec:projection}, where we
consider the case $n\ge 1$ to solve the projection problem, we still recall here
the relevant notions and results for the general case.

The procedure to solving the projection problem introduced in~\cite{BLM+-AAAI05}
works basically as follows.  Firstly, time-stamped copies $A^{(i)}$,
$0\le i\le n$, of all relevant concept names in the input, $r^{(i)}$,
$0\le i\le n$, of all relevant role names in the input, and new time-stamped
concept names $T_C^{(i)}$, $0\le i\le n$, for every relevant concept $C$ in the
input are introduced.  Whereas in~\cite{BLM+-AAAI05}, not all concept names
occurring in the input are relevant, in our setting, the \emph{relevant} role
names, concept names, and concepts are precisely the ones occurring in the input
of the consistency (or projection) problem.%
\footnote{Recall that in~\cite{BLM+-AAAI05} only \emph{acyclic} TBoxes are
    considered.  Additionally, the action formalism there is limited such that
    for each DL-action \abf, we have that \emph{defined} concept names must not
    occur in any unconditional post-condition of~\abf or in $\beta$ for any
    conditional post-condition $\alpha/\beta$ of~\abf.  Intuitively, this is the
    reason why in~\cite{BLM+-AAAI05}, defined concept names are not relevant,
    i.e.~there is no need to introduce time-stamped copies~$A^{(i)}$ for any
    defined concept name~$A$.}
%
For every generalised ABox-literal $\alpha$ built using a relevant concept $C$
or a relevant role name~$r$ (called \emph{relevant generalised ABox-literal} in
the following) and every $i$, $0\le i\le n$, we can then define a time-stamped
variant $\alpha^{(i)}$ as follows:
\begin{align*}
    (C(a))^{(i)}&:=T_C^{(i)}(a),
    &(r(a,b))^{(i)}&:=r^{(i)}(a,b),\\
    (\lnot C(a))^{(i)}&:=\lnot T_C^{(i)}(a),
    &(\lnot r(a,b))^{(i)}&:=\lnot r^{(i)}(a,b).
\end{align*}
%
Given a generalised ABox~\Amc, where each $\alpha\in\Amc$ is a relevant
generalised ABox-literal, we define its time-stamped copy $\Amc^{(i)}$ as
\[\Amc^{(i)}:=\bigl\{\alpha^{(i)}\mid\alpha\in\Amc\bigr\}.\]
%
Similarly, given a finite set of GCIs~\Tmc built from relevant concepts, we
define its time-stamped copy $\Tmc^{(i)}$ as
\[\Tmc^{(i)}:=\bigl\{T_C^{(i)}\sqsubseteq T_D^{(i)}\mid C\sqsubseteq D\in\Tmc\bigr\}.\]
%
Intuitively, given an initial interpretation $\Imc_0$, the application of
$\bbf_1$ to $\Imc_0$ yields a successor interpretation $\Imc_1$, the application
of $\bbf_2$ to $\Imc_1$ yields a successor interpretation $\Imc_2$, and so
forth.  We can encode the sequence of interpretations
$\Imc_0,\Imc_1,\dots,\Imc_n$ into a single interpretation~\Jmc using the
time-stamped copies introduced above such that the relevant generalised
ABox-literal~$\alpha$ holds in $\Imc_i$ iff its time-stamped copy $\alpha^{(i)}$
holds in~\Jmc.

To enforce that~\Jmc indeed encodes a sequence of interpretations induced by the
application of the sequence of DL-actions $\bbf_1,\dots,\bbf_n$, we require it
to be a model of the (acyclic) TBox~\Tred and the generalised ABox~\Ared.  The
construction of \Tred and \Ared is very similar to the one introduced
in~\cite{BLM+-LTCS-05-02} with the difference that we use here a different
notion of \enquote{relevant} as explained above.  Also, compared to the original
construction of \Ared and \Tred, the present construction is simpler since we
deal only with unconditional DL-actions.  Additionally, since we do not consider
acyclic TBoxes as domain constraints, we can simplify the construction.

In the following, let~\Rmc denote a set of relevant concept names, role names,
and concepts, and let~\Obj denote the set of individual names occurring in the
input of the consistency problem.  We describe the construction for the case
of~\ALCQIO.
%
The TBox~\Tred consists of two parts: a TBox~\TN and a TBox~\Tsub,
i.e.~$\Tred:=\TN\cup\Tsub$.  As in~\cite{BLM+-LTCS-05-02}, the TBox~\TN
introduces a concept name $N$ to capture all named individuals:
\[\TN:=\bigl\{N\equiv\bigsqcup_{a\in\Obj}\{a\}\bigr\}.\]
Note that we make use of nominals here.
%
The TBox~\Tsub consists of a concept definition of $T_C^{(i)}$ for every concept
$C\in\Rmc$ and every $i$, $0\le i\le n$.  The concept definition of $T_C^{(i)}$
is defined inductively on the structure of $C$ as follows:
\begin{itemize}
    \item $T_A^{(i)}\equiv(N\sqcap A^{(i)})\sqcup(\lnot N\sqcap A^{(0)})$\quad
        if $A\in\NC$;
    \item $T_{\{a\}}^{(i)}\equiv\{a\}$;
    \item $T_{\lnot C_1}^{(i)}\equiv\lnot T_{C_1}^{(i)}$;
    \item $T_{C_1\sqcap C_2}^{(i)}\equiv T_{C_1}^{(i)}\sqcap T_{C_2}^{(i)}$;
    \item $T_{\exists r.C_1}^{(i)}\equiv%
            \Bigl(N\sqcap\bigl((\exists r^{(0)}.(\lnot N\sqcap T_{C_1}^{(i)}))\sqcup%
            (\exists r^{(i)}.(N\sqcap T_{C_1}^{(i)}))\bigr)\Bigr)\sqcup%
            (\lnot N\sqcap\exists r^{(0)}.T_{C_1}^{(i)}))$; and
    \item $\displaystyle
            T_{\atLeast{m}{r}{C_1}}^{(i)}\equiv%
            \Bigl(N\sqcap\bigsqcup_{0\le j\le m}\bigl(%
            \atLeast{j}{r^{(i)}}{(N\sqcap T_{C_1}^{(i)})}\sqcap%
            \atLeast{(m-j)}{r^{(0)}}{(\lnot N\sqcap T_{C_1}^{(i)})}\bigr)\Bigr)\sqcup{}$\\
        \phantom{$T_{\atLeast{m}{r}{C_1}}^{(i)}\equiv{}$}
        $(\lnot N\sqcap \atLeast{m}{r^{(0)}}{T_{C_1}^{(i)}})$.
\end{itemize}

The generalised ABox~\Ared also consists of several parts.  Let $\pre_i$ be the
set of pre-conditions of $\bbf_i$ for each $i$, $1\le i\le n$.  The following
generalised ABoxes capture the pre-conditions:
\[\Apre^{(i)}:=\bigl\{\alpha^{(i-1)}\mid\alpha\in\pre_i\bigr\}.\]
Note that we take $\alpha^{(i-1)}$ since the pre-conditions have to be satisfied
\emph{before} the DL-action is applied.

Moreover, let $\post_i$ be the set of post-conditions of $\bbf_i$ for each $i$,
$1\le i\le n$.  Since all $\bbf_i$ are unconditional, we can define generalised
ABoxes capturing the post-conditions as follows:
\[\Apost^{(i)}:=\bigl\{\alpha^{(i)}\mid\alpha\in\post_i\bigr\}.\]
%
The ABoxes~$\Amin^{(i)}$ ensure a minimisation of changes to the named
individuals.  For every $i$, $1\le i\le n$, the ABox~$\Amin^{(i)}$ consists of
\begin{enumerate}
    \item the following assertions for every $a\in\Obj$ and every $A\in\NC$
        occurring in the input:
        \[\begin{cases}
            (A^{(i-1)}\to A^{(i)})(a)
                &\text{if $\lnot A(a)\notin\post_i$, and}\\
            (\lnot A^{(i-1)}\to\lnot A^{(i)})(a)
                &\text{if $A(a)\notin\post_i$; and}
        \end{cases}\]
    \item the following assertions for every $a,b\in\Obj$ and every $r\in\NR$
        occurring in the input:
        \[\begin{cases}
            (\exists r^{(i-1)}.\{b\}\to\exists r^{(i)}.\{b\})(a)
                &\text{if $\lnot r(a,b)\notin\post_i$, and}\\
            (\lnot\exists r^{(i-1)}.\{b\}\to\lnot\exists r^{(i)}.\{b\})(a)
                &\text{if $r(a,b)\notin\post_i$.}
        \end{cases}\]
\end{enumerate}

Finally, we can construct the generalised ABox~\Ared using the above defined
ABoxes and the pre-conditions of the DL-actions:
\[\Ared:=\bigcup_{i=1}^n\Apre^{(i)}\cup\ \bigcup_{i=1}^n\Apost^{(i)}\ \cup\ \bigcup_{i=1}^n\Amin^{(i)}.\]

We now recall the pertinent properties of \Tred and \Ared in the next lemma,
whose proof is very similar to the one of Theorem~14 and Lemma~15
in~\cite{BLM+-LTCS-05-02}.  We still present the full proof for the sake of
completeness.

\begin{lemma}\label{lem:ared-tred}
    Let \Lmc be a DL between \ALC and \ALCQIO and $\mathcal{LO}$ the DL which
    extends \Lmc with nominals.  Let $\bbf_1,\dots,\bbf_n$ be a sequence of
    DL-actions formulated in~\Lmc, and \Rmc be a set of relevant concept names,
    role names, and concepts such that \Rmc contains all the concept names, role
    names, and concepts occurring in $\bbf_1,\dots,\bbf_n$.

    Then, there are a generalised $\mathcal{LO}$-ABox~\Ared and an (acyclic)
    $\mathcal{LO}$-TBox~\Tred of size polynomial in the size of
    $\bbf_1,\dots,\bbf_n$, and $\Rmc$, such that the following properties hold:
    \begin{enumerate}
        \item\label{enum:reduction-direction-one}
            For every sequence of interpretations $\Imc_0,\dots,\Imc_n$ with
            $\Imc_i\Rightarrow_{\bbf_{i+1}}^{\emptyset,\emptyset}\Imc_{i+1}$ for
            each~$i$, $0\le i<n$, there exists an interpretation~\Jmc such that
            $\Jmc\models\Ared$, $\Jmc\models\Tred$, and
            \begin{enumerate}
                \item\label{enum:reduction-direction-one-a}
                    for every $i$, $0\le i\le n$, and every relevant generalised
                    ABox-literal $\alpha$, we have $\Imc_i\models\alpha$ iff
                    $\Jmc\models\alpha^{(i)}$; and
                \item\label{enum:reduction-direction-one-b}
                    for every $i$, $0\le i\le n$, and every relevant
                    concept~$C$, we have $C^{\Imc_i}=(T_C^{(i)})^\Jmc$.
            \end{enumerate}
        \item\label{enum:reduction-direction-two}
            For every interpretation \Jmc with $\Jmc\models\Ared$ and
            $\Jmc\models\Tred$, there exist interpretations
            $\Imc_0,\dots,\Imc_n$ such that
            $\Imc_i\Rightarrow_{\bbf_{i+1}}^{\emptyset,\emptyset}\Imc_{i+1}$
            for every $i$, $0\le i<n$, and
            \begin{enumerate}
                \item\label{enum:reduction-direction-two-a}
                    for every $i$, $0\le i\le n$, and every relevant generalised
                    ABox-literal $\alpha$, we have $\Imc_i\models\alpha$ iff
                    $\Jmc\models\alpha^{(i)}$; and
                \item\label{enum:reduction-direction-two-b}
                    for every $i$, $0\le i\le n$, and every relevant
                    concept~$C$, we have $C^{\Imc_i}=(T_C^{(i)})^\Jmc$.
            \end{enumerate}
    \end{enumerate}
\end{lemma}

\begin{proof}
    Let~\Ared and~\Tred be defined as above.  It is easy to see that~\Ared
    and~\Tred are of size polynomial in the size of $\bbf_1,\dots,\bbf_n$,
    and~\Rmc.
    %
    We first prove Property~\eqref{enum:reduction-direction-one}.  For that, let
    $\Imc_0=(\Delta^{\Imc_0},\cdot^{\Imc_0}),\dots,\Imc_n=(\Delta^{\Imc_n},\cdot^{\Imc_n})$
    be a sequence of interpretations with
    $\Imc_i\Rightarrow_{\bbf_i}^{\emptyset,\emptyset}\Imc_{i+1}$ for every $i$,
    $0\le i<n$.  Then, Definition~\ref{def:action-semantics} yields that
    $\Delta^{\Imc_0}=\Delta^{\Imc_1}=\dots=\Delta^{\Imc_n}$, and
    $a^{\Imc_0}=a^{\Imc_1}=\dots=a^{\Imc_n}$ for every $a\in\NI$.
    %
    We define the interpretation $\Jmc=(\Delta^\Jmc,\cdot^\Jmc)$ as follows:
    \begin{itemize}
        \item $\Delta^\Jmc:=\Delta^{\Imc_0}$;
        \item $a^\Jmc:=a^{\Imc_0}$ for every $a\in\NI$;
        \item $N^\Jmc:=\{a^\Jmc\mid a\in\Obj\}$;
        \item $(A^{(i)})^\Jmc:=A^{\Imc_i}$ for every $A\in\Rmc\cap\NC$ and every
            $i$, $0\le i\le n$;
        \item $(r^{(i)})^\Jmc:=r^{\Imc_i}$ for every $r\in\Rmc\cap\NR$ and every
            $i$, $0\le i\le n$; and
        \item $(T_C^{(i)})^\Jmc:=C^{\Imc_i}$ for every concept $C\in\Rmc$ and
            every $i$, $0\le i\le n$.
    \end{itemize}
    %
    We first prove Property~\eqref{enum:reduction-direction-one-a}.  For that,
    take any $i$ with $0\le i\le n$, and any relevant generalised
    ABox-literal~$\alpha$.  We prove the property by case distinction.  Assume
    that $\alpha$ is of the form $C(a)$ where $C$ is a concept and $a\in\NI$.
    We have: $\Imc_i\models\alpha$ iff $a^{\Imc_i}\in C^{\Imc_i}$ iff
    $a^\Jmc\in(T_C^{(i)})^\Jmc$ iff $\Jmc\models T_C^{(i)}(a)$ iff
    $\Jmc\models\alpha^{(i)}$.

    Assume now that $\alpha$ is of the form $\lnot C(a)$ where $C$ is a concept
    and $a\in\NI$.  By similar arguments, we have: $\Imc_i\models\alpha$ iff
    $a\notin C^{\Imc_i}$ iff $a^\Jmc\notin(T_C^{(i)})^\Jmc$ iff
    $\Jmc\not\models T_C^{(i)}(a)$ iff $\Jmc\models\lnot T_C^{(i)}(a)$ iff
    $\Jmc\models\alpha^{(i)}$.

    For the case that $\alpha$ is of the form $r(a,b)$ where $r\in\NR$ and
    $a,b\in\NI$, we have: $\Imc_i\models\alpha$ iff
    $(a^{\Imc_i},b^{\Imc_i})\in r^{\Imc_i}$ iff
    $(a^\Jmc,b^\Jmc)\in(r^{(i)})^\Jmc$ iff $\Jmc\models r^{(i)}(a,b)$ iff
    $\Jmc\models\alpha^{(i)}$.

    Finally, assume that $\alpha$ is of the form $\lnot r(a,b)$ where $r\in\NR$
    and $a,b\in\NI$.  We have: $\Imc_i\models\alpha$ iff
    $(a^{\Imc_i},b^{\Imc_i})\notin r^{\Imc_i}$ iff
    $(a^\Jmc,b^\Jmc)\notin(r^{(i)})^\Jmc$ iff $\Jmc\not\models r^{(i)}(a,b)$ iff
    $\Jmc\models\lnot r^{(i)}(a,b)$ iff $\Jmc\models\alpha^{(i)}$.
    %
    This finishes the proof of Property~\eqref{enum:reduction-direction-one-a}.

    Property~\eqref{enum:reduction-direction-one-b} follows directly from the
    definition of~\Jmc.  Thus, it is only left to be proved that \Jmc is a model
    of~\Ared and~\Tred.

    We start proving that \Jmc is a model of~\Ared.
    %
    Definition~\ref{def:action-semantics} yields that $\bbf_i$ is applicable
    to~$\Imc_{i-1}$ w.r.t.\ the empty TBox, i.e.~$\Imc_{i-1}\models\pre_i$, for
    every $i$, $1\le i\le n$.  Since $\pre_i$ consists of relevant generalised
    ABox-literals, we have by Property~\eqref{enum:reduction-direction-one-a}
    that $\Jmc\models\pre_i^{(i-1)}$, i.e.~$\Jmc\models\Apre^{(i)}$, for every
    $i$, $1\le i\le n$.

    Since the set of causal relationships is empty and all DL-actions are
    unconditional, we have that $\Eff(\bbf_i,\Imc_{i-1},\emptyset)=\post_i$ for
    every $i$, $1\le i\le n$.  We have by Definition~\ref{def:action-semantics}
    that $\post_i$ is not contradictory for every $i$, $1\le i\le n$.  It is
    easy to see from Definition~\ref{def:action-semantics} that
    $\Imc_i\models\post_i$ for every $i$, $1\le i\le n$.  Again, since $\post_i$
    consists of relevant generalised ABox-literals, we have by
    Property~\eqref{enum:reduction-direction-one-a} that
    $\Jmc\models\post_i^{(i)}$, i.e.~$\Jmc\models\Apost^{(i)}$, for every $i$,
    $1\le i\le n$.

    To show that \Jmc is a model of $\Amin^{(i)}$ for every $i$, $1\le i\le n$,
    take any $i$, $1\le i\le n$, any $a,b\in\Obj$, any relevant $A\in\NC$, and
    any relevant $r\in\NR$.
    %
    Assume first that $\lnot A(a)\notin\post_i$.  By the arguments above, we
    have that $\lnot A(a)\notin\Eff(\bbf_i,\Imc_{i-1},\emptyset)$.  By
    Definition~\ref{def:action-semantics}, we have that
    $a^{\Imc_{i-1}}\notin A^-$, and thus that $a^{\Imc_{i-1}}\in A^{\Imc_{i-1}}$
    implies that $a^{\Imc_{i-1}}=a^{\Imc_i}\in A^{\Imc_i}$.  Hence,
    $a^\Jmc\in(A^{(i-1)})^\Jmc$ implies that $a^\Jmc\in(A^{(i)})^\Jmc$.  This is
    equivalent to $a^\Jmc\in(A^{(i-1)}\to A^{(i)})^\Jmc$.  Thus,
    $\Jmc\models(A^{(i-1)}\to A^{(i)})(a)$.

    Assume now that $A(a)\notin\post_i$.  By similar arguments, we obtain that
    $a^{\Imc_{i-1}}\notin A^+$, and thus that
    $a^{\Imc_{i-1}}\notin A^{\Imc_{i-1}}$ implies that
    $a^{\Imc_{i-1}}\notin A^{\Imc_i}$.  Hence, we have that
    $a^\Jmc\notin(A^{(i-1)})^\Jmc$ implies that
    $a^\Jmc\notin(A^{(i)})^\Jmc$.  This is equivalent to
    $a^\Jmc\in(\lnot A^{(i-1)}\to\lnot A^{(i)})^\Jmc$.  Thus, we have
    $\Jmc\models(\lnot A^{(i-1)}\to\lnot A^{(i)})(a)$.

    For the case where $\lnot r(a,b)\notin\post_i$, we have again by similar
    arguments as in the previous cases that
    $(a^{\Imc_{i-1}},b^{\Imc_{i-1}})\notin r^-$, and thus that
    $(a^{\Imc_{i-1}},b^{\Imc_{i-1}})\in r^{\Imc_{i-1}}$ implies that
    $(a^{\Imc_{i-1}},b^{\Imc_{i-1}})\in r^{\Imc_i}$.  Hence,
    $(a^\Jmc,b^\Jmc)\in(r^{(i-1)})^\Jmc$ implies that
    $(a^\Jmc,b^\Jmc)\in(r^{(i)})^\Jmc$.  It is easy to see that this is
    equivalent to
    $a^\Jmc\in(\exists r^{(i-1)}.\{b\}\to\exists r^{(i)}.\{b\})^\Jmc$, which
    yields that we have also that
    $\Jmc\models(\exists r^{(i-1)}.\{b\}\to\exists r^{(i)}.\{b\})(a)$.

    Finally, assume that $r(a,b)\notin\post_i$.  By similar arguments, we have
    $(a^{\Imc_{i-1}},b^{\Imc_{i-1}})\notin r^+$, and thus we have that
    $(a^{\Imc_{i-1}},b^{\Imc_{i-1}})\notin r^{\Imc_{i-1}}$ implies
    $(a^{\Imc_{i-1}},b^{\Imc_{i-1}})\notin r^{\Imc_i}$.  This yields that
    $(a^\Jmc,b^\Jmc)\notin(r^{(i-1)})^\Jmc$ implies that
    $(a^\Jmc,b^\Jmc)\notin(r^{(i)})^\Jmc$.  Again, it is easy to see that this
    is equivalent to
    $a^\Jmc\in(\lnot\exists r^{(i-1)}.\{b\}\to\lnot\exists r^{(i)}.\{b\})^\Jmc$.
    Thus, we have also that \Jmc is a model of
    $(\lnot\exists r^{(i-1)}.\{b\}\to\lnot\exists r^{(i)}.\{b\})(a)$.

    This finishes the proof that $\Jmc\models\Amin^{(i)}$ for every $i$,
    $1\le i\le n$.  Thus, we have shown that $\Jmc\models\Ared$.
    %
    We show now that~\Jmc is also a model of~\Tred.
    %
    The definition of $N^\Jmc$ yields that $\Jmc\models\TN$.  Before we show
    that $\Jmc\models\Tsub$, we show the following claim.

    \begin{claim}\label{claim:anon-dont-change-concepts}
        For every $A\in\NC$, and every $i$, $0\le i\le n$, we have that
        $A^{\Imc_0}\setminus N^\Jmc=A^{\Imc_i}\setminus N^\Jmc$.
    \end{claim}

    \noindent
    We show this claim by induction on $i$.  For that, take any $A\in\NC$.  For
    $i=0$, the claim is trivially satisfied.  Assume now that the claim holds
    for $i$, i.e.~$A^{\Imc_0}\setminus N^\Jmc=A^{\Imc_i}\setminus N^\Jmc$.
    Thus, it is enough to show
    $A^{\Imc_i}\setminus N^\Jmc=A^{\Imc_{i+1}}\setminus N^\Jmc$.  Since
    $\Imc_i\Rightarrow_{\bbf_{i+1}}^{\emptyset,\emptyset}\Imc_{i+1}$, we have by
    Definition~\ref{def:action-semantics} that
    $A^{\Imc_{i+1}}=(A^{\Imc_i}\cup A^+)\setminus A^-$, where
    $A^+=\{a^\Imc\mid A(a)\in\Eff(\bbf_{i+1},\Imc_i,\emptyset)\}$ and
    $A^-=\{a^\Imc\mid\lnot A(a)\in\Eff(\bbf_{i+1},\Imc_i,\emptyset)\}$.  Thus,
    $A^{\Imc_{i+1}}\setminus N^\Jmc=\bigl((A^{\Imc_i}\cup A^+)\setminus A^-\bigr)\setminus N^\Jmc$.
    Obviously, $A^+\subseteq N^\Jmc$ and $A^-\subseteq N^\Jmc$, and thus
    $A^{\Imc_{i+1}}\setminus N^\Jmc=A^{\Imc_i}\setminus N^\Jmc$.
    %
    This finishes the proof of Claim~\ref{claim:anon-dont-change-concepts}.

    Very similar arguments can be used to show a similar claim for role names.

    \begin{claim}\label{claim:anon-dont-change-roles}
        For every $r\in\NR$, and every $i$, $0\le i\le n$, we have that
        \[r^{\Imc_0}\setminus(N^\Jmc\times N^\Jmc)%
            =r^{\Imc_i}\setminus(N^\Jmc\times N^\Jmc).\]
    \end{claim}

    \noindent
    To show that $\Jmc\models\Tsub$, we show that for every concept $C\in\Rmc$
    and every $i$, $0\le i\le n$, the concept definition of $T_C^{(i)}$ is
    satisfied.  We prove this by a case distinction.

    For the case where $C=A\in\NC$, we have that $(T_A^{(i)})^\Jmc=A^{\Imc_i}$
    by definition.  Obviously,
    $A^{\Imc_i}=(N^\Jmc\cap A^{\Imc_i})\cup(A^{\Imc_i}\setminus N^\Jmc)$.
    Claim~\ref{claim:anon-dont-change-concepts} yields
    $A^{\Imc_i}=(N^\Jmc\cap A^{\Imc_i})\cup(A^{\Imc_0}\setminus N^\Jmc)$.  Thus,
    we have
    $A^{\Imc_i}=(N^\Jmc\cap A^{\Imc_i})\cup\bigl((\Delta^\Jmc\setminus N^\Jmc)\cap A^{\Imc_0}\bigr)$.
    Hence, we obtain together with the definition of~\Jmc that
    $(T_A^{(i)})^\Jmc=(N^\Jmc\cap(A^{(i)})^\Jmc)\cup\bigl((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)})^\Jmc\bigr)$,
    which yields that \Jmc is a model of
    $T_A^{(i)}\equiv(N\sqcap A^{(i)})\sqcup(\lnot N\sqcap A^{(0)})$.

    For the case where $C$ is of the form $\{a\}$ with $a\in\Obj$, we have by
    definition that
    \[(T_{\{a\}}^{(i)})^\Jmc%
        =\{a\}^{\Imc_i}%
        =\{a^{\Imc_i}\}%
        =\{a^\Jmc\}%
        =\{a\}^\Jmc,\]
    and thus that \Jmc is a model of $T_{\{a\}}^{(i)}\equiv\{a\}$.

    For the case where $C$ is of the form $\lnot C_1$, we have again by
    definition that
    \[(T_{\lnot C_1}^{(i)})^\Jmc%
        =(\lnot C_1)^{\Imc_i}%
        =\Delta^{\Imc_i}\setminus C_1^{\Imc_i}%
        =\Delta^\Jmc\setminus(T_{C_1}^{(i)})^\Jmc%
        =(\lnot T_{C_1}^{(i)})^\Jmc,\]
    which yields that \Jmc is a model of $T_{\lnot C_1}^{(i)}\equiv\lnot
    T_{C_1}^{(i)}$.

    For the case where $C$ is of the form $C_1\sqcap C_2$, we have analogously
    that
    \[(T_{C_1\sqcap C_2}^{(i)})^\Jmc%
        =(C_1\sqcap C_2)^{\Imc_i}%
        =C_1^{\Imc_i}\cap C_2^{\Imc_i}=(T_{C_1}^{(i)})^\Jmc\cap(T_{C_2}^{(i)})^\Jmc%
        =(T_{C_1}^{(i)}\sqcap T_{C_2}^{(i)})^\Jmc,\]
    which yields that \Jmc is a model of $T_{C_1\sqcap C_2}^{(i)}\equiv
    T_{C_1}^{(i)}\sqcap T_{C_2}^{(i)}$.

    For the case where $C$ is of the form $\exists r.C_1$, we have
    \begin{align*}
        (T_{\exists r.C_1}^{(i)})^\Jmc
        &=(\exists r.C_1)^{\Imc_i}\\
        &=\{d\in\Delta^{\Imc_i}\mid%
            \text{there is an $e\in\Delta^{\Imc_i}$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}%
            \displaybreak[0]\\
        &=\{d\in N^\Jmc\mid%
            \text{there is an $e\in\Delta^{\Imc_i}$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\cup{}\\
        &\phantom{{}={}}
            \{d\in\Delta^{\Imc_i}\setminus N^\Jmc\mid%
                \text{there is an $e\in\Delta^{\Imc_i}$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}%
                \displaybreak[0]\\
        &=\{d\in N^\Jmc\mid%
            \text{there is an $e\in\Delta^{\Imc_i}\setminus N^\Jmc$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\cup{}\\
        &\phantom{{}={}}
            \{d\in N^\Jmc\mid%
                \text{there is an $e\in N^\Jmc$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\cup{}\\
        &\phantom{{}={}}
            \{d\in\Delta^{\Imc_i}\setminus N^\Jmc\mid%
                \text{there is an $e\in\Delta^{\Imc_i}$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}%
                \displaybreak[0]\\
        &\overset{\ast}{=}\{d\in N^\Jmc\mid%
            \text{there is an $e\in\Delta^{\Imc_i}\setminus N^\Jmc$ with $(d,e)\in r^{\Imc_0}$ and $e\in C_1^{\Imc_i}$}\}\cup{}\\
        &\phantom{{}={}}
            \{d\in N^\Jmc\mid%
                \text{there is an $e\in N^\Jmc$ with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\cup{}\\
        &\phantom{{}={}}
            \{d\in\Delta^{\Imc_i}\setminus N^\Jmc\mid%
                \text{there is an $e\in\Delta^{\Imc_i}$ with $(d,e)\in r^{\Imc_0}$ and $e\in C_1^{\Imc_i}$}\}%
                \displaybreak[0]\\
        &=\Bigl(N^\Jmc\cap{}\\
        &\phantom{{}={}}
            \bigl(\{d\in\Delta^\Jmc\mid%
                \text{there is an $e\in\Delta^\Jmc$ with $(d,e)\in(r^{(0)})^\Jmc$ and $e\in(\lnot N\sqcap T_{C_1}^{(i)})^\Jmc$}\}\cup{}\\
        &\phantom{{}={}\bigl(}
            \{d\in\Delta^\Jmc\mid%
                \text{there is an $e\in\Delta^\Jmc$ with $(d,e)\in(r^{(i)})^\Jmc$ and $e\in(N\sqcap T_{C_1}^{(i)})^\Jmc$}\}\bigr)\Bigr)\cup{}\\
        &\phantom{{}={}}
            \bigl((\lnot N)^\Jmc\cap{}\\
        &\phantom{{}={}\bigl(}
            \{d\in\Delta^\Jmc\mid%
                \text{there is an $e\in\Delta^\Jmc$ with $(d,e)\in(r^{(0)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\bigr)%
                \displaybreak[0]\\
        &=\Bigl(\Bigl(N\sqcap\bigl((\exists r^{(0)}.(\lnot N\sqcap T_{C_1}^{(i)}))\sqcup(\exists r^{(i)}.(N\sqcap T_{C_1}^{(i)}))\bigr)\Bigr)\sqcup%
            (\lnot N\sqcap\exists r^{(0)}.T_{C_1}^{(i)})\Bigr)^\Jmc.
    \end{align*}
    %
    The starred equality $\overset{\ast}{=}$ holds due to
    Claim~\ref{claim:anon-dont-change-roles}.  This shows that \Jmc is a model
    of the concept definition of $T_{\exists r.C_1}^{(i)}$.

    For the case where $C$ is of the form $\atLeast{m}{r}{C_1}$, we have by
    similar arguments that
    \begin{align*}
        (T_{\atLeast{m}{r}{C_1}}^{(i)})^\Jmc
        &=(\atLeast{m}{r}{C_1})^{\Imc_i}\\
        &=\bigl\{d\in\Delta^{\Imc_i}\mid%
            \lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m\bigr\}%
            \displaybreak[0]\\
        &=\bigl\{d\in N^\Jmc\mid%
            \lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m\bigr\}\cup{}\\
        &\phantom{{}={}}
            \bigl\{d\in\Delta^{\Imc_i}\setminus N^\Jmc\mid%
                \lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m\bigr\}.
    \end{align*}

    \noindent
    We have for every $d\in N^\Jmc$ that
    \begin{itemize}
        \item[]
            $d\in(T_{\atLeast{m}{r}{C_1}}^{(i)})^\Jmc$
        \item[\emph{iff}]
            $\lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m$
        \item[\emph{iff}]
            there is a $j$, $0\le j\le m$, such that
            $\lvert\{e\in N^\Jmc\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge j$ and
            $\lvert\{e\in\Delta^{\Imc_i}\setminus N^\Jmc\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m-j$
        \item[\emph{iff}]
            there is a $j$, $0\le j\le m$, such that
            $\lvert\{e\in N^\Jmc\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge j$ and
            $\lvert\{e\in\Delta^{\Imc_i}\setminus N^\Jmc\mid\text{$(d,e)\in r^{\Imc_0}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m-j$
            by Claim~\ref{claim:anon-dont-change-roles}
        \item[\emph{iff}]
            there is a $j$, $0\le j\le m$, such that
            $\lvert\{e\in N^\Jmc\mid\text{$(d,e)\in(r^{(i)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\rvert\ge j$ and
            $\lvert\{e\in\Delta^{\Imc_i}\setminus N^\Jmc\mid\text{$(d,e)\in(r^{(0)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\rvert\ge m-j$
        \item[\emph{iff}]
            there is a $j$, $0\le j\le m$, such that we have that
            $d\in(\atLeast{j}{r^{(i)}}{(N\sqcap T_{C_1}^{(i)})})^\Jmc$ and
            $d\in(\atLeast{(m-j)}{r^{(0)}}{(\lnot N\sqcap T_{C_1}^{(i)})})^\Jmc$
        \item[\emph{iff}]
            $d\in\Bigl(N\sqcap\bigsqcup_{0\le j\le m}\bigl(%
                \atLeast{j}{r^{(i)}}{(N\sqcap T_{C_1}^{(i)})}\sqcap%
                \atLeast{(m-j)}{r^{(0)}}{(\lnot N\sqcap T_{C_1}^{(i)})}\bigr)\Bigr)^\Jmc$.
    \end{itemize}

    \noindent
    Moreover, we have for every $d\in\Delta^\Jmc\setminus N^\Jmc$ that
    \begin{itemize}
        \item[]
            $d\in(T_{\atLeast{m}{r}{C_1}}^{(i)})^\Jmc$
        \item[\emph{iff}]
            $\lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m$
        \item[\emph{iff}]
            $\lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_0}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m$
            by Claim~\ref{claim:anon-dont-change-roles}
        \item[\emph{iff}]
            $\lvert\{e\in\Delta^\Jmc\mid\text{$(d,e)\in(r^{(i)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\rvert\ge m$
        \item[\emph{iff}]
            $d\in(\lnot N\sqcap\atLeast{m}{r^{(0)}}{T_{C_1}^{(i)}})^\Jmc$.
    \end{itemize}

    \noindent
    Hence, we obtain that \Jmc is a model of the concept definition of
    $T_{\atLeast{m}{r}{C_1}}^{(i)}$.

    This finishes the proof that $\Jmc\models\Tsub$, and thus we have
    $\Jmc\models\Tred$, which finishes the proof of
    Property~\eqref{enum:reduction-direction-one}.

    To prove Property~\eqref{enum:reduction-direction-two}, let
    $\Jmc=(\Delta^\Jmc,\cdot^\Jmc)$ be an interpretation with $\Jmc\models\Ared$
    and $\Jmc\models\Tred$.  We define the interpretations
    $\Imc_0=(\Delta^{\Imc_0},\cdot^{\Imc_0})$,~\dots,
    $\Imc_n=(\Delta^{\Imc_n},\cdot^{\Imc_n})$ as follows:
    \begin{itemize}
        \item $\Delta^{\Imc_i}:=\Delta^\Jmc$ for every $i$, $0\le i\le n$;
        \item $a^{\Imc_i}:=a^\Jmc$ for every $a\in\NI$ and every $i$,
            $0\le i\le n$;
        \item $A^{\Imc_i}:=(T_A^{(i)})^\Jmc$ for every $A\in\Rmc\cap\NC$ and
            every $i$, $0\le i\le n$; and
        \item $r^{\Imc_i}:=\bigl((r^{(i)})^\Jmc\cap(N^\Jmc\times N^\Jmc)\bigr)\cup%
                \biggl((r^{(0)})^\Jmc\cap\Bigl(\bigl(\Delta^\Jmc\times(\lnot N)^\Jmc\bigr)\cup%
                \bigl((\lnot N)^\Jmc\times\Delta^\Jmc\bigr)\Bigr)\biggr)$
            for every $r\in\Rmc\cap\NR$ and every $i$, $0\le i\le n$.
    \end{itemize}
    %
    The interpretation of concept names and role names that are not contained
    in~\Rmc is irrelevant.  We assume in the following without loss of
    generality that the interpretation of all such names in empty in all
    interpretations~$\Imc_i$, $0\le i\le n$.

    We first show Property~\eqref{enum:reduction-direction-two-b}.  To prove
    this property, take any $i$, $0\le i\le n$.  We proceed by induction on the
    structure of~$C$, where we use that $\Jmc\models\Tred$.
    %
    For the case where $C=A\in\NC$, we have the claim by definition.

    For the case where $C$ is of the form $\{a\}$ with $a\in\Obj$, we have
    \[\{a\}^{\Imc_i}%
        =\{a^{\Imc_i}\}%
        =\{a^\Jmc\}=\{a\}^\Jmc%
        =(T_{\{a\}}^{(i)})^\Jmc.\]

    \noindent
    For the case where $C$ is of the form $\lnot C_1$, we have
    \[(\lnot C_1)^{\Imc_i}%
        =\Delta^{\Imc_i}\setminus C_1^{\Imc_i}%
        =\Delta^\Jmc\setminus(T_{C_1}^{(i)})^\Jmc%
        =(\lnot T_{C_1}^{(i)})^\Jmc%
        =(T_{\lnot C_1}^{(i)})^\Jmc.\]

    \noindent
    For the case where $C$ is of the form $C_1\sqcap C_2$, we have
    \[(C_1\sqcap C_2)^{\Imc_i}%
        =C_1^{\Imc_i}\cap C_2^{\Imc_i}%
        =(T_{C_1}^{(i)})^\Jmc\cap(T_{C_2}^{(i)})^\Jmc%
        =(T_{C_1}^{(i)}\sqcap T_{C_2}^{(i)})^\Jmc%
        =(T_{C_1\sqcap C_2}^{(i)})^\Jmc.\]

    \noindent
    For the case where $C$ is of the form $\exists r.C_1$, we have
    \begin{itemize}
        \item[]
            $d\in(\exists r.C_1)^{\Imc_i}$
        \item[\emph{iff}]
            $d\in\Delta^{\Imc_i}$ and there is an $e\in\Delta^{\Imc_i}$ with
            $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$
        \item[\emph{iff}]
            either $d\in N^\Jmc$ and there is an $e\in\Delta^\Jmc$ with
            $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$, or
            $d\in\Delta^\Jmc\setminus N^\Jmc$ and there is an $e\in\Delta^\Jmc$
            with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$
        \item[\emph{iff}]
            either $d\in N^\Jmc$ and there is an
            $e\in\Delta^\Jmc\setminus N^\Jmc$ with
            $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$, or
            $d\in N^\Jmc$ and there is an $e\in N^\Jmc$ with
            $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$, or
            $d\in\Delta^\Jmc\setminus N^\Jmc$ and there is an $e\in\Delta^\Jmc$
            with $(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$
        \item[\emph{iff}]
            either $d\in N^\Jmc$ and there is an
            $e\in\Delta^\Jmc\setminus N^\Jmc$ with
            $(d,e)\in(r^{(0)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$, or
            $d\in N^\Jmc$ and there is an $e\in N^\Jmc$ with
            $(d,e)\in(r^{(i)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$, or
            $d\in\Delta^\Jmc\setminus N^\Jmc$ and there is an $e\in\Delta^\Jmc$
            with $(d,e)\in(r^{(0)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$
            (by the definition of~$r^{\Imc_i}$ and the induction hypothesis)
        \item[\emph{iff}]
            $d\in\Bigl(\bigl(N\sqcap\bigl(%
                (\exists r^{(0)}.(\lnot N\sqcap T_{C_1}^{(i)}))\sqcup%
                (\exists r^{(i)}.(N\sqcap T_{C_1}^{(i)}))\bigr)\bigr)\sqcup%
                (\lnot N\sqcap\exists r^{(0)}.T_{C_1}^{(i)})\Bigr)^\Jmc$
        \item[\emph{iff}]
            $d\in(T_{\exists r.C_1}^{(i)})^\Jmc$ (since $\Jmc\models\Tred$).
    \end{itemize}

    \noindent
    For the case where $C$ is of the form $\atLeast{m}{r}{C_1}$, we have by
    similar arguments as in the previous case that
    \begin{itemize}
        \item[]
            $d\in(\atLeast{m}{r}{C_1})^{\Imc_i}$
        \item[\emph{iff}]
            $d\in\Delta^{\Imc_i}$ and
            $\lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m$
        \item[\emph{iff}]
            either $d\in N^\Jmc$ and there is a $j$, $0\le j\le m$, such that
            \[\lvert\{e\in N^\Jmc\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge j\]
            and
            \[\lvert\{e\in\Delta^{\Imc_i}\setminus N^\Jmc\mid%
                \text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m-j,\]
            or we have
            $d\in\Delta^\Jmc\setminus N^\Jmc$ and
            $\lvert\{e\in\Delta^{\Imc_i}\mid\text{$(d,e)\in r^{\Imc_i}$ and $e\in C_1^{\Imc_i}$}\}\rvert\ge m$
        \item[\emph{iff}]
            either $d\in N^\Jmc$ and there is a $j$, $0\le j\le m$, such that
            \[\lvert\{e\in N^\Jmc\mid\text{$(d,e)\in(r^{(i)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\rvert\ge j\]
            and
            \[\lvert\{e\in\Delta^\Jmc\setminus N^\Jmc\mid%
                \text{$(d,e)\in(r^{(0)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\rvert\ge m-j,\]
            or we have
            $d\in\Delta^\Jmc\setminus N^\Jmc$ and
            $\lvert\{e\in\Delta^\Jmc\mid\text{$(d,e)\in(r^{(0)})^\Jmc$ and $e\in(T_{C_1}^{(i)})^\Jmc$}\}\rvert\ge m$\\
            (by the definition of~$r^{\Imc_i}$ and the induction hypothesis)
        \item[\emph{iff}]
            either $d\in N^\Jmc$ and there is a $j$, $0\le j\le m$, such that
            $d\in(\atLeast{j}{r^{(i)}}{(N\sqcap T_{C_1}^{(i)})})^\Jmc$ and
            $d\in(\atLeast{(m-j)}{r^{(0)}}{(\lnot N\sqcap T_{C_1}^{(i)})})^\Jmc$,
            or we have
            $d\in\Delta^\Jmc\setminus N^\Jmc$ and
            $d\in(\atLeast{m}{r^{(0)}}{T_{C_1}^{(i)}})^\Jmc$
        \item[\emph{iff}]
            either
            $d\in\Bigl(N\sqcap\bigsqcup_{0\le j\le m}\bigl(%
                \atLeast{j}{r^{(i)}}{(N\sqcap T_{C_1}^{(i)})}\sqcap%
                \atLeast{(m-j)}{r^{(0)}}{(\lnot N\sqcap T_{C_1}^{(i)})}\bigr)\Bigr)^\Jmc$\\
            or
            $d\in(\lnot N\sqcap\atLeast{m}{r^{(0)}}{T_{C_1}^{(i)}})^\Jmc$
        \item[\emph{iff}]
            $d\in(T_{\atLeast{m}{r}{C_1}}^{(i)})^\Jmc$ (since $\Jmc\models\Tred$).
    \end{itemize}
    %
    This finishes the proof of Property~\eqref{enum:reduction-direction-two-b}.

    We now prove Property~\eqref{enum:reduction-direction-two-a}.  For that,
    take any $i$ with $0\le i\le n$, and any relevant generalised
    ABox-literal~$\alpha$.  We prove the property using again a case
    distinction.
    %
    Assume that $\alpha$ is of the form $C(a)$ where $C$ is a concept and
    $a\in\NI$.  We have: $\Imc_i\models\alpha$ iff $a^{\Imc_i}\in C^{\Imc_i}$
    iff $a^\Jmc\in(T_C^{(i)})^\Jmc$ (by
    Property~\eqref{enum:reduction-direction-two-b}) iff
    $\Jmc\models\alpha^{(i)}$.

    Assume now that $\alpha$ is of the form $\lnot C(a)$ where $C$ is a concept
    and $a\in\NI$.  By similar arguments and
    Property~\eqref{enum:reduction-direction-two-b}, we have:
    $\Imc_i\models\alpha$ iff $a\notin C^{\Imc_i}$ iff
    $a^\Jmc\notin(T_C^{(i)})^\Jmc$ iff $\Jmc\not\models T_C^{(i)}(a)$ iff
    $\Jmc\models\lnot T_C^{(i)}(a)$ iff $\Jmc\models\alpha^{(i)}$.

    For the case that $\alpha$ is of the form $r(a,b)$ where $r\in\NR$ and
    $a,b\in\NI$, we have: $\Imc_i\models\alpha$ iff
    $(a^{\Imc_i},b^{\Imc_i})\in r^{\Imc_i}$ iff
    $(a^\Jmc,b^\Jmc)\in(r^{(i)})^\Jmc$ (by the definition of~$r^{\Imc_i}$) iff
    $\Jmc\models r^{(i)}(a,b)$ iff $\Jmc\models\alpha^{(i)}$.

    Finally, assume that $\alpha$ is of the form $\lnot r(a,b)$ where $r\in\NR$
    and $a,b\in\NI$.  We have: $\Imc_i\models\alpha$ iff
    $(a^{\Imc_i},b^{\Imc_i})\notin r^{\Imc_i}$ iff
    $(a^\Jmc,b^\Jmc)\notin(r^{(i)})^\Jmc$ (again by the definition
    of~$r^{\Imc_i}$) iff $\Jmc\not\models r^{(i)}(a,b)$ iff
    $\Jmc\models\lnot r^{(i)}(a,b)$ iff $\Jmc\models\alpha^{(i)}$.
    %
    This finishes the proof of Property~\eqref{enum:reduction-direction-two-a}.

    Thus, it is only left to be shown that we have also
    $\Imc_i\Rightarrow_{\bbf_{i+1}}^{\emptyset,\emptyset}\Imc_{i+1}$ for every
    $i$, $0\le i<n$.
    %
    For that, take any $i$, $0\le i<n$.  We show that the conditions in
    Definition~\ref{def:action-semantics} are satisfied.

    We start showing that $\bbf_{i+1}$ is applicable to~$\Imc_i$ w.r.t.\ the
    empty TBox, i.e.~that $\Imc_i\models\pre_{i+1}$.  Since $\Jmc\models\Ared$,
    we have that $\Jmc\models\Apre^{(i+1)}$, i.e.~$\Jmc\models\alpha^{(i)}$ for
    every $\alpha\in\pre_{i+1}$.  Since all such $\alpha\in\pre_{i+1}$ are
    relevant generalised ABox-literals, we have by
    Property~\eqref{enum:reduction-direction-two-a} that
    $\Imc_i\models\pre_{i+1}$.

    Moreover, we have by definition that
    $\Delta^{\Imc_i}=\Delta^\Jmc=\Delta^{\Imc_{i+1}}$ and
    $a^{\Imc_i}=a^\Jmc=a^{\Imc_{i+1}}$ for every $a\in\NI$.

    We show next that $\Eff(\bbf_{i+1},\Imc_i,\emptyset)$ is not contradictory.
    Since the set of causal relationships is empty and $\bbf_{i+1}$ is
    unconditional, we have that $\Eff(\bbf_{i+1},\Imc_i,\emptyset)=\post_{i+1}$.
    Since $\Jmc\models\Ared$, we have that $\Jmc\models\Apost^{(i+1)}$,
    i.e.~$\Jmc\models\alpha^{(i+1)}$ for every $\alpha\in\post_{i+1}$.  Since
    all ABox-literals in $\post_{i+1}$ are relevant, we have by
    Property~\eqref{enum:reduction-direction-two-a} that
    $\Imc_{i+1}\models\post_{i+1}$.  Hence, $\Eff(\bbf_{i+1},\Imc_i,\emptyset)$
    cannot be contradictory.

    Let $A\in\NC\cap\Rmc$, let
    $A^+:=\{a^{\Imc_i}\mid A(a)\in\Eff(\bbf_{i+1},\Imc_i,\emptyset)\}%
        =\{a^{\Imc_i}\mid A(a)\in\post_{i+1}\}$, and let
    $A^-:=\{a^{\Imc_i}\mid\lnot A(a)\in\Eff(\bbf_{i+1},\Imc_i,\emptyset)\}%
        =\{a^{\Imc_i}\mid\lnot A(a)\in\post_{i+1}\}$.
    %
    Since $\Eff(\bbf_{i+1},\Imc_i,\emptyset)$ is not contradictory, we have that
    $A^+\cap A^-=\emptyset$.  Moreover, we have by definition that
    $A^+\subseteq N^\Jmc$ and $A^-\subseteq N^\Jmc$.
    %
    We first show that
    $A^{\Imc_{i+1}}\setminus N^\Jmc=A^{\Imc_i}\setminus N^\Jmc$.  Since
    $\Jmc\models\Tsub$, we have
    \begin{align*}
        A^{\Imc_{i+1}}\setminus N^\Jmc
        &=(T_A^{(i+1)})^\Jmc\setminus N^\Jmc\\
        &=\bigl((N^\Jmc\cap(A^{(i+1)})^\Jmc)\cup((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)}))^\Jmc\bigr)\setminus N^\Jmc\\
        &=((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)}))^\Jmc\setminus N^\Jmc\\
        &=\bigl((N^\Jmc\cap(A^{(i)})^\Jmc)\cup((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)}))^\Jmc\bigr)\setminus N^\Jmc\\
        &=(T_A^{(i)})^\Jmc\setminus N^\Jmc\\
        &=A^{\Imc_i}\setminus N^\Jmc
    \end{align*}

    \noindent
    Hence, we have for every $d\in\Delta^\Jmc\setminus N^\Jmc$ that
    $d\in A^{\Imc_{i+1}}$ iff $d\in(A^{\Imc_i}\cup A^+)\setminus A^-$.

    Next, we show the following claim.

    \begin{claim}\label{claim:reduction-direction-two-named-concepts}
        For every $a^\Jmc\in N^\Jmc$, and every $j$, $0\le j\le n$, we have
        $a^\Jmc\in A^{\Imc_j}$ iff $a^\Jmc\in(A^{(j)})^\Jmc$.
    \end{claim}

    \noindent
    Take any $a^\Jmc\in N^\Jmc$ and any $j$, $0\le j\le n$.  We have
    \begin{itemize}
        \item[]
            $a^\Jmc\in A^{\Imc_j}$
        \item[\emph{iff}]
            $a^\Jmc\in(T_A^{(j)})^\Jmc$
        \item[\emph{iff}]
            $a^\Jmc\in N^\Jmc\cap(A^{(j)})^\Jmc$ or
            $a^\Jmc\in(\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)})^\Jmc$ since
            $\Jmc\models\Tsub$
        \item[\emph{iff}]
            $a^\Jmc\in(A^{(j)})^\Jmc$ since $a^\Jmc\in N^\Jmc$.
    \end{itemize}
    %
    This finishes the proof of
    Claim~\ref{claim:reduction-direction-two-named-concepts}.

    We prove that for every $a^\Jmc\in N^\Jmc$, we have
    $a^\Jmc\in A^{\Imc_{i+1}}$ iff $a^\Jmc\in(A^{\Imc_i}\cup A^+)\setminus A^-$
    by a case distinction.
    %
    For the \enquote{if} direction, it is obvious that we have
    $a^\Jmc\notin A^-$.
    %
    Now, consider first the case where $a^\Jmc\in A^+$.  Then, the definition
    of~$A^+$ yields that $A(a)\in\post_{i+1}$.  Hence, we have
    $a^\Jmc\in(T_A^{(i+1)})^\Jmc$ since $\Jmc\models\Apost^{(i+1)}$.  By the
    definition of $A^{\Imc_{i+1}}$, we have $a^\Jmc\in A^{\Imc_{i+1}}$.

    Consider now the case where $a^\Jmc\notin A^+$,
    i.e.~$a^\Jmc\in A^{\Imc_i}\setminus A^-$.  Since $a^\Jmc\in A^{\Imc_i}$, we
    have by
    Claim~\ref{claim:reduction-direction-two-named-concepts} that
    $a^\Jmc\in(A^{(i)})^\Jmc$.  Moreover, we have $\lnot A(a)\notin\post_{i+1}$
    by the definition of~$A^-$ since $a^\Jmc\notin A^-$.  Since
    $\Jmc\models\Amin^{(i+1)}$, we have also that
    $\Jmc\models(A^{(i)}\to A^{(i+1)})(a)$,
    i.e.~$a^\Jmc\in(A^{(i)})^\Jmc$ implies $a^\Jmc\in(A^{(i+1)})^\Jmc$.  Since
    $a^\Jmc\in(A^{(i)})^\Jmc$, we have $a^\Jmc\in(A^{(i+1)})^\Jmc$, which yields
    $a^\Jmc\in A^{\Imc_{i+1}}$ by
    Claim~\ref{claim:reduction-direction-two-named-concepts}.

    For the \enquote{only if} direction, assume to the contrary that
    $a^\Jmc\in A^{\Imc_{i+1}}$, $a^\Jmc\notin A^+$, and
    $a^\Jmc\notin A^{\Imc_i}\setminus A^-$.  There are again two cases to
    consider: either $a^\Jmc\in A^-$ or $a^\Jmc\notin A^-$.  If $a^\Jmc\in A^-$,
    then $\lnot A(a)\in\post_{i+1}$ by the definition of~$A^-$.  Since
    $\Jmc\models\Apost^{(i+1)}$, we have that
    $\Jmc\models(T_{\lnot A}^{(i+1)})(a)$,
    i.e.~$a^\Jmc\in(T_{\lnot A}^{(i+1)})^\Jmc$.  Since $\Jmc\models\Tsub$, this
    yields $a^\Jmc\in(\lnot T_A^{(i+1)})^\Jmc$,
    i.e.~$a^\Jmc\notin(T_A^{(i+1)})^\Jmc$.  The definition of $A^{\Imc_{i+1}}$
    yields that $a^\Jmc\notin A^{\Imc_{i+1}}$, which is a contradiction.

    Otherwise, if $a^\Jmc\notin A^-$, we have $a^\Jmc\notin A^{\Imc_i}$, and
    thus $a^\Jmc\notin(A^{(i)})^\Jmc$ by
    Claim~\ref{claim:reduction-direction-two-named-concepts}.  Since
    $a^\Jmc\notin A^+$, we have $A(a)\notin\post_{i+1}$ by the definition
    of~$A^+$.  Since $\Jmc\models\Amin^{(i+1)}$, we have also that
    $\Jmc\models(\lnot A^{(i)}\to\lnot A^{(i+1)})(a)$,
    i.e.~$a^\Jmc\notin(A^{(i)})^\Jmc$ implies $a^\Jmc\notin(A^{(i+1)})^\Jmc$.
    Since we have $a^\Jmc\notin(A^{(i)})^\Jmc$, this yields
    $a^\Jmc\notin(A^{(i+1)})^\Jmc$.  Thus, by
    Claim~\ref{claim:reduction-direction-two-named-concepts}, we have
    $a^\Jmc\notin A^{\Imc_{i+1}}$, which again is a contradiction.

    Thus, we have shown that
    $A^{\Imc_{i+1}}=(A^{\Imc_i}\cup A^+)\setminus A^-$.
    %
    Finally, let $r\in\NR\cap\Rmc$, let
    \[r^+:=\{(a^{\Imc_i},b^{\Imc_i})\mid r(a,b)\in\Eff(\bbf_{i+1},\Imc_i,\emptyset)\}%
        =\{(a^{\Imc_i},b^{\Imc_i})\mid r(a,b)\in\post_{i+1}\},\]
    and let
    \[r^-:=\{(a^{\Imc_i},b^{\Imc_i})\mid\lnot r(a,b)\in\Eff(\bbf_{i+1},\Imc_i,\emptyset)\}%
        =\{(a^{\Imc_i},b^{\Imc_i})\mid\lnot r(a,b)\in\post_{i+1}\}.\]
    %
    Since $\Eff(\bbf_{i+1},\Imc_i,\emptyset)$ is not contradictory, we have that
    $r^+\cap r^-=\emptyset$.  Moreover, we have by definition that
    $r^+\subseteq N^\Jmc\times N^\Jmc$ and $r^-\subseteq N^\Jmc\times N^\Jmc$.
    %
    Similar to before, we first show that
    $r^{\Imc_{i+1}}\setminus(N^\Jmc\times N^\Jmc)=r^{\Imc_i}\setminus(N^\Jmc\times N^\Jmc)$.
    By the definitions of $r^{\Imc_{i+1}}$ and $r^{\Imc_i}$, we have
    \begin{align*}
        r^{\Imc_{i+1}}\setminus(N^\Jmc\times N^\Jmc)
        &=\bigl((r^{(0)})^\Jmc\cap((\Delta^\Jmc\times(\lnot N)^\Jmc)\cup%
            ((\lnot N)^\Jmc\times\Delta^\Jmc))\bigr)\setminus(N^\Jmc\times N^\Jmc)\\
        &=r^{\Imc_i}\setminus(N^\Jmc\times N^\Jmc).
    \end{align*}

    \noindent
    Hence, we have for all $d,e\in\Delta^\Jmc\setminus N^\Jmc$ that
    $(d,e)\in r^{\Imc_{i+1}}$ iff $(d,e)\in(r^{\Imc_i}\cup r^+)\setminus r^-$.

    The following claim is also an immediate consequence of the definition
    of~$r^{\Imc_i}$.

    \begin{claim}\label{claim:reduction-direction-two-named-roles}
        For every $(a^\Jmc,b^\Jmc)\in N^\Jmc\times N^\Jmc$, and every $j$,
        $0\le j\le n$, we have $(a^\Jmc,b^\Jmc)\in r^{\Imc_j}$ iff
        $(a^\Jmc,b^\Jmc)\in(r^{(j)})^\Jmc$.
    \end{claim}

    \noindent
    Again by a case distinction, we prove that for every
    $(a^\Jmc,b^\Jmc)\in N^\Jmc\times N^\Jmc$, we have that
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$ iff
    $(a^\Jmc,b^\Jmc)\in(r^{\Imc_i}\cup r^+)\setminus r^-$.
    %
    For the \enquote{if} direction, it is obvious that we have
    $(a^\Jmc,b^\Jmc)\notin r^-$.
    %
    Now, consider first the case where $(a^\Jmc,b^\Jmc)\in r^+$.  Then, the
    definition of~$r^+$ yields that $r(a,b)\in\post_{i+1}$.  Hence, we have
    $(a^\Jmc,b^\Jmc)\in(r^{(i+1)})^\Jmc$ since $\Jmc\models\Apost^{(i+1)}$.  By
    Claim~\ref{claim:reduction-direction-two-named-roles}, we have
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$.

    Consider now the case where $(a^\Jmc,b^\Jmc)\notin r^+$,
    i.e.~$(a^\Jmc,b^\Jmc)\in r^{\Imc_i}\setminus r^-$.  Since we have
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_i}$, we have by
    Claim~\ref{claim:reduction-direction-two-named-roles} also that
    $(a^\Jmc,b^\Jmc)\in(r^{(i)})^\Jmc$.  This yields that
    $a^\Jmc\in(\exists r^{(i)}.\{b\})^\Jmc$.  Moreover, we have
    $\lnot r(a,b)\notin\post_{i+1}$ by the definition of~$r^-$ since
    $(a^\Jmc,b^\Jmc)\notin r^-$.  Since $\Jmc\models\Amin^{(i+1)}$, we have also
    that $\Jmc\models(\exists r^{(i)}.\{b\}\to\exists r^{(i+1)}.\{b\})(a)$,
    i.e.~$a^\Jmc\in(\exists r^{(i)}.\{b\})^\Jmc$ implies
    $a^\Jmc\in(\exists r^{(i+1)}.\{b\})^\Jmc$.  Since
    $a^\Jmc\in(\exists r^{(i)}.\{b\})^\Jmc$, we have
    $a^\Jmc\in(\exists r^{(i+1)}.\{b\})^\Jmc$, which yields
    $(a^\Jmc,b^\Jmc)\in(r^{(i+1)})^\Jmc$.  By
    Claim~\ref{claim:reduction-direction-two-named-roles}, we have thus
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$.

    For the \enquote{only if} direction, assume to the contrary that
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$, $(a^\Jmc,b^\Jmc)\notin r^+$, and
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_i}\setminus r^-$.  There are again two cases
    to consider: either $(a^\Jmc,b^\Jmc)\in r^-$ or $(a^\Jmc,b^\Jmc)\notin r^-$.
    If $(a^\Jmc,b^\Jmc)\in r^-$, then $\lnot r(a,b)\in\post_{i+1}$ by the
    definition of~$r^-$.  Since $\Jmc\models\Apost^{(i+1)}$, we have that
    $\Jmc\models\lnot r^{(i+1)}(a,b)$,
    i.e.~$(a^\Jmc,b^\Jmc)\notin(r^{(i+1)})^\Jmc$.  By
    Claim~\ref{claim:reduction-direction-two-named-roles}, we obtain
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_{i+1}}$, which is a contradiction.

    Otherwise, if $(a^\Jmc,b^\Jmc)\notin r^-$, we have
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_i}$, and thus
    $(a^\Jmc,b^\Jmc)\notin(r^{(i)})^\Jmc$ by
    Claim~\ref{claim:reduction-direction-two-named-roles}.  This yields that
    $a^\Jmc\notin(\exists r^{(i)}.\{b\})^\Jmc$.  Since
    $(a^\Jmc,b^\Jmc)\notin r^+$, we have by the definition of~$r^+$ also that
    $r(a,b)\notin\post_{i+1}$.  Moreover, since $\Jmc\models\Amin^{(i+1)}$, we
    have also that
    $\Jmc\models(\lnot\exists r^{(i)}.\{b\}\to\lnot\exists r^{(i+1)}.\{b\})(a)$,
    i.e.~$a^\Jmc\notin(\exists r^{(i)}.\{b\})^\Jmc$ implies
    $a^\Jmc\notin(\exists r^{(i+1)}.\{b\})^\Jmc$.  Since we have
    $a^\Jmc\notin(\exists r^{(i)}.\{b\})^\Jmc$, this yields
    $a^\Jmc\notin(\exists r^{(i+1)}.\{b\})^\Jmc$.  Thus, we have that
    $(a^\Jmc,b^\Jmc)\notin(r^{(i+1)})^\Jmc$.  Hence, by
    Claim~\ref{claim:reduction-direction-two-named-roles}, we obtain
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_{i+1}}$, which again is a contradiction.

    We have thus shown that
    $r^{\Imc_{i+1}}=(r^{\Imc_i}\cup r^+)\setminus r^-$.
    %
    Since we have shown that all conditions in Definition~\ref{def:action-semantics}
    are satisfied, this finishes the proof that we have
    $\Imc_i\Rightarrow_{\bbf_{i+1}}^{\emptyset,\emptyset}\Imc_{i+1}$ for every
    $i$, $0\le i<n$.  Thus, we have shown
    Property~\eqref{enum:reduction-direction-two}.
\end{proof}

\noindent
Now, we can come back to the consistency problem for DL-actions.  Let
$\abf=(\pre,\post)$ be a DL-action, \CR a finite set of causal
relationships, and \Tmc a general TBox.  The set \Rmc of relevant concept names,
role names, and concepts consists of the ones occurring in \abf, \CR, or~\Tmc.
Given an action type $T\in\Tmf(\abf,\CR)$, we can compute the set
$\Eff(\abf,T,\CR)$, and check whether this set is not contradictory.  If this is
the case, then we consider the DL-action $\bbf_{\abf,T,\CR}$, and check whether
an application of this DL-action transforms models of \Tmc satisfying \pre and
$T$ into models of~\Tmc.  This check can be realised using the generalised
ABox~\Ared and the (acyclic) TBox~\Tred of Lemma~\ref{lem:ared-tred}.

\begin{lemma}\label{lem:consistency-tbox}
    The DL-action $\abf=(\pre,\post)$ is consistent w.r.t.~\Tmc
    and~\CR \emph{iff} the following holds for every $T\in\Tmf(\abf,\CR)$: if
    $T\cup\pre$ is consistent w.r.t.~\Tmc, then
    \begin{itemize}
        \item $\Eff(\abf,T,\CR)$ is not contradictory, and
        \item every model of \Ared, \Tred, $T^{(0)}$, and $\Tmc^{(0)}$ is also a
            model of $\Tmc^{(1)}$, where \Ared and \Tred are constructed using
            $\bbf_{\abf,T,\CR}$ and~\Rmc.
    \end{itemize}
\end{lemma}

\begin{proof}
    For the \enquote{only if} direction, let $T\in\Tmf(\abf,\CR)$ be an action
    type such that $T\cup\pre$ is consistent w.r.t.~\Tmc.  Then there exists an
    interpretation~\Imc such that $\Imc\models\pre$, $\Imc\models T$, and
    $\Imc\models\Tmc$.  Thus, \abf is applicable to~\Imc w.r.t.~\Tmc.  Since
    \abf is consistent w.r.t.~\Tmc and~\CR, there exists an
    interpretation~$\Imc'$ such that $\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$.
    Hence, $\Eff(\abf,\Imc,\CR)$ is not contradictory, and since $\Imc\models
    T$, we have by Lemma~\ref{lem:effects-by-type} that
    $\Eff(\abf,\Imc,\CR)=\Eff(\abf,T,\CR)$, and thus $\Eff(\abf,T,\CR)$ is also
    not contradictory.

    Let \Jmc be a model of \Ared, \Tred, $T^{(0)}$, and $\Tmc^{(0)}$.  We need
    to show that $\Jmc\models\Tmc^{(1)}$.
    By~\eqref{enum:reduction-direction-two} of Lemma~\ref{lem:ared-tred},
    there exist interpretations $\Imc_0$ and $\Imc_1$ such that
    $\Imc_0\Rightarrow_{\bbf_{\abf,T,\CR}}^{\emptyset,\emptyset}\Imc_1$.  Since
    \Jmc is a model of \Ared, we have in particular that
    $\Jmc\models\pre^{(0)}$, and thus we obtain again
    by~\eqref{enum:reduction-direction-two} of Lemma~\ref{lem:ared-tred} that
    $\Imc_0\models T\cup\pre$, and $\Imc_0\models\Tmc$.  By
    Lemma~\ref{lem:sim-cr},
    $\Imc_0\Rightarrow_{\bbf_{\abf,T,\CR}}^{\emptyset,\emptyset}\Imc_1$ implies
    $\Imc_0\Rightarrow_{\abf}^{\emptyset,\CR}\Imc_1$.  Assume that
    $\Imc_1\not\models\Tmc$.  Since the DL-action \abf is deterministic, we can
    conclude that there is no interpretation $\Imc'$ with
    $\Imc_0\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$, which is a contradiction to the
    assumption that \abf is consistent w.r.t.~\Tmc and~\CR.
    Thus, we have $\Imc_1\models\Tmc$, which together
    with~\eqref{enum:reduction-direction-two} of Lemma~\ref{lem:ared-tred}
    yields that $\Jmc\models\Tmc^{(1)}$.

    For the \enquote{if} direction, let \Imc be any interpretation such that
    \abf is applicable to~\Imc w.r.t.~\Tmc.  Then, we have that
    $\Imc\models\pre$ and $\Imc\models\Tmc$.  By
    Lemma~\ref{lem:unique-action-type}, there is one unique action type
    $T\in\Tmf(\abf,\CR)$ such that $\Imc\models T$, and thus that $T\cup\pre$ is
    consistent w.r.t.~\Tmc.  Then, $\Eff(\abf,T,\CR)$ is not contradictory,
    which yields that there exists an interpretation $\Imc'$ such that
    $\Imc\Rightarrow_{\bbf_{\abf,T,\CR}}^{\emptyset,\emptyset}\Imc'$.
    Thus, by Lemma~\ref{lem:sim-cr}, we have
    $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$.  Moreover,
    by~\eqref{enum:reduction-direction-one} of Lemma~\ref{lem:ared-tred}, there
    exists an interpretation~\Jmc such that $\Jmc\models\Ared$,
    $\Jmc\models\Tred$, $\Jmc\models T^{(0)}$, and $\Jmc\models\Tmc^{(0)}$.
    Hence, we have also that $\Jmc\models\Tmc^{(1)}$.  Again
    by~\eqref{enum:reduction-direction-one} of Lemma~\ref{lem:ared-tred}, we
    have that $\Imc'\models\Tmc$, which, together with
    $\Imc\Rightarrow_{\abf}^{\emptyset,\CR}\Imc'$ and $\Imc\models\Tmc$, yields
    that $\Imc\Rightarrow_{\abf}^{\Tmc,\CR}\Imc'$.  Thus, \abf is consistent
    w.r.t.~\Tmc and~\CR.
\end{proof}

\noindent
This lemma can be used to design a decision procedure for deciding whether a
DL-action is consistent w.r.t.\ a TBox and finite set of causal relationships.
Again, the complexity of this problem depends on the DL used.

\begin{theorem}\label{thm:consistency-complexity-tbox}
    The problem of deciding whether a DL-action is consistent w.r.t.\ a TBox and
    a finite set of causal relationships is
    \begin{enumerate}
        \item\label{enum:part-tbox-alc-o-q-i-qo-io}
            \ExpTime-complete for the following DLs: \ALC, \ALCO, \ALCQ, \ALCI,
            \ALCQO, and \ALCIO;
        \item\label{enum:part-tbox-alcqi}
            \ExpTime-hard and in \coNExpTime for \ALCQI; and
        \item\label{enum:part-tbox-alcqio}
            \coNExpTime-hard and in \PTimeToNExpTime for \ALCQIO.
    \end{enumerate}
\end{theorem}

\begin{proof}
    We first prove the lower bounds of the theorem.  As in the case where the
    TBox was assumed to be empty, we reduce the ABox-\emph{in}consistency
    problem, i.e.~the problem of deciding whether a given ABox is
    \emph{in}consistent, to our DL-action consistency problem.  Take any
    ABox~\Amc and any general TBox~\Tmc.  It is not hard to see that \Amc is
    \emph{in}consistent w.r.t.~\Tmc iff $(\Amc,\{A(a),\lnot A(a)\})$
    is consistent w.r.t.~\Tmc and the empty set of causal relationships, where
    $A\in\NC$ and $a\in\NI$ are arbitrary.

    Since the ABox-consistency problem w.r.t.\ a general TBox is \ExpTime-hard
    for \ALC~\cite{Sch-IJCAI91}, and \ExpTime is closed under complement, we
    have \ExpTime-hardness for Parts~\ref{enum:part-tbox-alc-o-q-i-qo-io}
    and~\ref{enum:part-tbox-alcqi} of the theorem.  Moreover,
    \coNExpTime-hardness for Part~\ref{enum:part-tbox-alcqio} of the theorem is
    obtained, because the ABox-consistency problem w.r.t.\ a general TBox is
    \NExpTime-complete~\cite{Sch-DKE94,Tob-JAIR00,Pra-JLLI05}.\footnote{%
        As noted in the proof of
        Theorem~\ref{thm:complexity-consistency-no-tbox}, this is even the case
        if the number in the at-least and at-most restrictions are coded in
        binary.}

    To prove the upper bounds for Part~\ref{enum:part-tbox-alc-o-q-i-qo-io} of
    the theorem, we give an \ExpTime-decision procedure.  Given a DL-action
    $\abf=(\pre,\post)$, a general TBox~\Tmc, and a finite set of
    causal relationships~\CR, do the following for every action type
    $T\in\Tmf(\abf,\CR)$:
    \begin{enumerate}
        \item Check whether the generalised ABox $T\cup\pre$ is consistent w.r.t.~\Tmc;
        \item If Step~1 was successful, compute the set $\Eff(\abf,T,\CR)$, and
            check whether it is contradictory.
        \item If Step~1 and Step~2 were successful, compute the DL-action
            $\bbf_{\abf,T,\CR}$ and the set of relevant symbols~\Rmc.  Using
            those, compute the generalised ABox~\Ared, the TBox~\Tred,
            $T^{(0)}$, $\Tmc^{(0)}$, and $\Tmc^{(1)}$, and check whether every
            model of \Ared, \Tred, $T^{(0)}$, and $\Tmc^{(0)}$ is also a model
            of $\Tmc^{(1)}$.
    \end{enumerate}
    %
    If for every such action type either Step~1 is not successful or Step~3 is
    successful, we know by Lemma~\ref{lem:consistency-tbox} that \abf is
    consistent w.r.t.~\Tmc and~\CR.  Otherwise, \abf is not consistent
    w.r.t.~\Tmc and~\CR.

    First recall that the set $\Tmf(\abf,\CR)$ is of size exponential in the
    size of~\abf and~\CR, but each action type $T\in\Tmf(\abf,\CR)$ is only of
    polynomial size.  Thus, it is enough to show that Steps~1--3 can be
    performed in exponential time.  Using the arguments in the proof of
    Theorem~\ref{thm:complexity-consistency-no-tbox}, the consistency check in
    Step~1 can be polynomially reduced to the consistency problem of classical
    ABoxes~\cite{BLM+-LTCS-05-02}.  Since for \ALCIO and \ALCQO, the ABox
    consistency problem  w.r.t.\ general TBoxes can be decided in
    \ExpTime~\cite{Sch-DKE94,Hla-DPIJCAR04,HoSa-IJCAI01}, Step~1 can be done in
    exponential time.  As argued above, Step~2 can be done in time polynomial in
    the size of~\abf, $T$, and~\CR.  For Step~3, note that computing
    $\bbf_{\abf,T,\CR}$, \Rmc, \Ared, \Tred, $T^{(0)}$, $\Tmc^{(0)}$, and
    $\Tmc^{(1)}$ can be done in time polynomial in the size of~\abf, $T$, \CR,
    and~\Tmc.  The check in Step~3 can be reduced to an
    ABox-\emph{in}consistency problem w.r.t.\ a general TBox.  Indeed,
    $\Tmc^{(1)}$ can be transformed to an ABox~$\Amc_{\Tmc^{(1)}}$ as follows:
    for every GCI $C\sqsubseteq D\in\Tmc^{(1)}$, we add $(C\sqcap\lnot D)(a)$ to
    $\Amc_{\Tmc^{(1)}}$, where $a\in\NI$ does not occur in the input.  It is not
    hard to see that the check in Step~3 is equivalent to checking whether the
    generalised ABox $\Ared\cup T^{(0)}\cup\Amc_{\Tmc^{(1)}}$ is
    \emph{in}consistent w.r.t.~$\Tmc^{(0)}\cup\Tred$.  As shown above, the
    complement of this problem can be decided in \ExpTime, and since \ExpTime is
    closed under complement, Step~3 can also be performed in exponential time.
    Thus, overall, we obtain an \ExpTime-decision procedure.

    For the upper bound of Part~\ref{enum:part-tbox-alcqi} of the theorem, we
    employ the same decision procedure.  In this case, Step~1 can be done
    in~\ExpTime, since the ABox-consistency problem w.r.t.\ a general TBox is
    \ExpTime-complete~\cite{Tob-PhD01}.  In Step~3, however, we deal with the
    generalised ABox~\Ared, which contains nominals.  Hence, we obtain with the
    above reduction, an ABox-\emph{in}consistency problem w.r.t.\ a general TBox
    in~\ALCQIO, which can be done in \coNExpTime as argued above.  Since Step~2
    can still be done in polynomial time, we obtain overall a
    \coNExpTime-decision procedure.

    For the upper bound of Part~\ref{enum:part-tbox-alcqio} of the theorem, we
    proceed similarly.  We first non-deterministically guess an action type
    $T\in\Tmf(\abf,\CR)$, and then perform Steps~1--3 of the above decision
    procedure to decide whether~\abf is \emph{in}consistent w.r.t.~\Tmc and~\CR.
    As argued above, Step~2 employs a \NExpTime-check, and Step~3 employs a
    \coNExpTime-check.  Thus, overall, we obtain that deciding whether~\abf is
    \emph{in}consistent w.r.t.~\Tmc and~\CR can be done in \NPToNExpTime,
    i.e.~in \NP using a \NExpTime-oracle.  Thus deciding whether~\abf is
    consistent w.r.t.~\Tmc and~\CR can be done in \coNPToNExpTime.  It follows
    from a result in~\cite{Hem-STOC87} that
    $\coNPToNExpTime=\NPToNExpTime=\PTimeToNExpTime$, and thus we obtain
    Part~\ref{enum:part-tbox-alcqio} of the theorem.
\end{proof}

\noindent
Note, however, that is is still open whether the upper bounds for \ALCQI and
\ALCQIO are optimal.  In the next section, we consider the projection problem
for our DL-based action formalism.


\section{Deciding the Projection Problem}\label{sec:projection}

According to Definition~\ref{def:projection}, the input of the projection
problem is a finite sequence of DL-actions $\abf_1,\dots,\abf_n$, together with
a TBox~\Tmc, a finite set of causal relationships~\CR, an initial generalised
ABox~\Amc, and a generalised ABox-literal~$\alpha$ such that every
DL-action~$\abf_i$ ($1\le i\le n$) is \emph{consistent} w.r.t.~\Tmc and~\CR.  By
definition, $\alpha$ is a consequence of applying $\abf_1,\dots,\abf_n$
to~\Amc w.r.t.~\Tmc and~\CR iff for all interpretations $\Imc_0,\dots,\Imc_n$
the following holds: if $\Imc_0\models\Amc$ and
$\Imc_0\Rightarrow_{\abf_1}^{\Tmc,\CR}\Imc_1$, \dots,
$\Imc_{n-1}\Rightarrow_{\abf_n}^{\Tmc,\CR}\Imc_n$, then $\Imc_n\models\alpha$.

Our solution of the projection problem w.r.t.~\Tmc and~\CR uses the same ideas
as the solution of the consistency sketched in Section~\ref{sec:consistency}.
%
Firstly, instead of considering interpretations $\Imc_0,\dots,\Imc_{n-1}$, we
consider action types $T_0,\dots,T_{n-1}$, where $T_i\in\Tmf(\abf_{i+1},\CR)$
for $0\le i<n$.\footnote{%
    Note that it is enough to consider the action types $T_0,\dots,T_{n-1}$ for
    $\Imc_0,\dots,\Imc_{n-1}$ since no DL-action is applied to~$\Imc_n$.}
%
Secondly, we use the original sequence of DL-actions $\abf_1,\dots,\abf_n$, the
set of causal relationships~\CR, and the action types $T_0,\dots,T_{n-1}$ to
construct the corresponding sequence of DL-actions
$\bbf_{\abf_1,T_0,\CR},\dots,\bbf_{\abf_n,T_{n-1},\CR}$.
Lemma~\ref{lem:sim-cr} then tells us that for every $i$, $0\le i<n$, and every
model \Imc of $T_i$, and every interpretation $\Imc'$, we have
$\Imc\Rightarrow_{\abf_{i+1}}^{\emptyset,\CR}\Imc'$ iff
$\Imc\Rightarrow_{\bbf_{\abf_{i+1},T_i,\CR}}^{\emptyset,\emptyset}\Imc'$.
%
Thirdly, we use the sequence of DL-actions
$\bbf_{\abf_1,T_0,\CR},\dots,\bbf_{\abf_n,T_{n-1},\CR}$, and the set of
relevant concept names, role names, and concepts~\Rmc to construct a generalised
ABox~\Ared and an (acyclic) TBox~\Tred such that the
properties~\eqref{enum:reduction-direction-one}
and~\eqref{enum:reduction-direction-two} of Lemma~\ref{lem:ared-tred} hold.  In
this setting, the set~\Rmc consists of the concept names, role names, and
concepts occurring in \Amc, \Tmc, $\abf_1,\dots,\abf_n$, \CR, and~$\alpha$.
%
The properties of \Ared and \Tred can be used to express that the initial
interpretation~$\Imc_0$ must be a model of~\Amc and that we only consider
successor interpretations~$\Imc_i$ that are models of~\Tmc.  In addition, we can
then check, whether all this implies that the final interpretation~$\Imc_n$ is a
model of~$\alpha$.
%
To be more precise, we can show that the characterisation of the projection
problem stated in the next lemma holds.

\begin{lemma}\label{lem:projection}
    The generalised ABox-literal~$\alpha$ is a consequence of applying the
    finite sequence of DL-actions $\abf_1,\dots,\abf_n$ to a generalised
    ABox~\Amc w.r.t.\ a TBox~\Tmc and a finite set of causal relationships~\CR
    \emph{iff} we have the following for all action types $T_0,\dots,T_{n-1}$
    with $T_i\in\Tmf(\abf_{i+1},\CR)$ for every $i$, $0\le i<n$: every model of
    $\bigcup_{i=0}^{n-1}T_i^{(i)}$, $\bigcup_{i=0}^n\Tmc^{(i)}$, $\Amc^{(0)}$,
    \Ared, and \Tred is also a model of $\alpha^{(n)}$, where \Ared and \Tred
    are constructed from
    $\bbf_{\abf_1,T_0,\CR},\dots,\bbf_{\abf_n,T_{n-1},\CR}$ and~\Rmc.
\end{lemma}

\begin{proof}
    For the \enquote{if} direction, consider action types $T_0,\dots,T_{n-1}$
    with $T_i\in\Tmf(\abf_{i+1},\CR)$ for every $i$, $0\le i<n$, and let \Jmc be
    a model of $\bigcup_{i=0}^{n-1}T_i^{(i)}$, $\bigcup_{i=0}^n\Tmc^{(i)}$,
    $\Amc^{(0)}$, \Ared, and \Tred.
    By~\eqref{enum:reduction-direction-two} of Lemma~\ref{lem:ared-tred}, there
    are interpretations $\Imc_0,\dots,\Imc_n$ such that
    $\Imc_i\Rightarrow_{\bbf_{\abf_{i+1},T_i,\CR}}^{\emptyset,\emptyset}\Imc_{i+1}$
    for every $i$, $0\le i<n$.  Additionally, we have by the same lemma that
    $\Imc_i\models T_i$ for every $i$, $0\le i<n$, and $\Imc_0\models\Amc$.
    Using Lemma~\ref{lem:sim-cr}, we obtain
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\emptyset,\CR}\Imc_{i+1}$ for every $i$,
    $0\le i<n$.  Since~\eqref{enum:reduction-direction-two} of
    Lemma~\ref{lem:ared-tred} yields that $\Imc_i\models\Tmc$ for every $i$,
    $0\le i\le n$, we have furthermore
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$.  Since $\alpha$ is a
    consequence of applying $\abf_1,\dots,\abf_n$ to~\Amc w.r.t.~\Tmc and~\CR,
    we have that $\Imc_n\models\alpha$, which implies again
    by~\eqref{enum:reduction-direction-two} of Lemma~\ref{lem:ared-tred} that
    $\Jmc\models\alpha^{(n)}$.

    For the \enquote{only if} direction, let $\Imc_0,\dots,\Imc_n$ be
    interpretations such that we have $\Imc_0\models\Amc$ and
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$ for every $i$, $0\le
    i<n$.  It is enough to show that $\Imc_n\models\alpha$.  We have obviously
    that $\Imc_i\Rightarrow_{\abf_{i+1}}^{\emptyset,\CR}\Imc_{i+1}$ for every
    $i$, $0\le i<n$, and that $\Imc_i\models\Tmc$ for every $i$, $0\le i\le n$.
    By Lemma~\ref{lem:unique-action-type}, there are unique action types
    $T_i\in\Tmf(\abf_{i+1},\CR)$ such that $\Imc_i\models T_i$ for every $i$,
    $0\le i<n$.  Then, by Lemma~\ref{lem:sim-cr}, we have
    $\Imc_i\Rightarrow_{\bbf_{\abf_{i+1},T_i,\CR}}^{\emptyset,\emptyset}\Imc_{i+1}$
    for every $i$, $0\le i<n$.  Thus, by~\eqref{enum:reduction-direction-one} of
    Lemma~\ref{lem:ared-tred}, there exists an interpretation~\Jmc such that
    \Jmc is a model of \Ared, \Tred, $\bigcup_{i=0}^{n-1}T_i^{(i)}$,
    $\bigcup_{i=0}^n\Tmc^{(i)}$, and $\Amc^{(0)}$.  Thus, we have also
    $\Jmc\models\alpha^{(n)}$, which implies again
    by~\eqref{enum:reduction-direction-one} of Lemma~\ref{lem:ared-tred} that
    $\Imc_n\models\alpha$.
\end{proof}

\noindent
It is easy to see that this lemma directly yields a decision procedure for the
projection problem.  Again, the exact complexity of this problem depends on the
DL used, and the fact whether the TBox is assumed to be acyclic (or empty) or
not.

\begin{theorem}\label{thm:projection-complexity}
    The projection problem for our action formalism is
    \begin{enumerate}
        \item\label{enum:part-prj-tbox-alc}
            \ExpTime-complete for the DLs \ALC, \ALCO, \ALCI, \ALCIO, \ALCQ,
            and~\ALCQO; and
        \item\label{enum:part-prj-tbox-alcqio}
            \coNExpTime-complete for the DLs \ALCQI and~\ALCQIO.
    \end{enumerate}
    %
    Moreover, if the TBox is assumed to be acyclic (or empty), the projection
    problem is
    \begin{enumerate}[resume]
        \item\label{enum:part-prj-alcqo}
            \PSpace-complete for the DLs \ALC, \ALCO, \ALCQ, and~\ALCQO;
        \item\label{enum:part-prj-alcio}
            \ExpTime-complete for the DLs \ALCI and~\ALCIO; and
        \item\label{enum:part-prj-alcqio}
            \coNExpTime-complete for the DLs \ALCQI and~\ALCQIO.
    \end{enumerate}
\end{theorem}

\begin{proof}
    We first prove the lower bounds of Part~\ref{enum:part-prj-tbox-alc} of the
    theorem by reducing the \emph{un}satisfiability
    problem, i.e.~the problem of deciding whether a given concept is
    \emph{un}satisfiable, to the projection problem.  It is not hard to see that
    a concept $C$ is unsatisfiable w.r.t.\ a TBox~\Tmc iff $\lnot C(a)$ is a
    consequence of applying the DL-action $(\emptyset,\emptyset)$ to
    the ABox~$\emptyset$ w.r.t.~\Tmc and the empty set of causal relationships,
    where $a\in\NI$ does not occur in~$C$ or~\Tmc.
    %
    Satisfiability of a concept w.r.t.\ a general TBox is \ExpTime-complete in
    \ALC~\cite{Sch-IJCAI91}, and since \ExpTime is closed under complement, we
    obtain the lower bounds of Part~\ref{enum:part-prj-tbox-alc} of the theorem.

    For the remaining lower bounds, we reduce the projection problem
    of~\cite{BLM+-AAAI05} to our projection problem.  In the case where the TBox
    is assumed to be empty, there is only one difference between the
    \enquote{transforms} relation from Definition~\ref{def:action-semantics} and
    the one in~\cite{BLM+-AAAI05}: we demand here that the DL-action is
    applicable to the interpretation, i.e.~a model of the pre-conditions of the
    DL-action.  Therefore, we have the following: The generalised
    ABox-literal~$\alpha$ is a consequence of applying the DL-action
    $(\pre,\post)$ to a generalised ABox~\Amc w.r.t.\ the empty TBox
    (as defined in~\cite{BLM+-AAAI05}) \emph{iff} $\alpha$ is a consequence of
    applying $(\emptyset,\post)$ to~\Amc w.r.t.\ the empty TBox and
    the empty set of causal relationships.  The projection problem defined
    in~\cite{BLM+-AAAI05} is \PSpace-complete for \ALC, \ExpTime-complete
    for \ALCI, and \coNExpTime-complete for \ALCQI, even if the TBox is assumed
    to be empty and we deal with only one DL-action~\cite{BLM+-AAAI05}.  Thus,
    we obtain the remaining lower bounds of our theorem.\footnote{%
        We could obtain most of the lower bounds also by a reduction of the
        unsatisfiability problem as for Part~\ref{enum:part-prj-tbox-alc} of the
        theorem.  However, we would not get the lower bounds for \ALCI (in the
        case where the TBox is assumed to be empty) and \ALCQI as the
        satisfiability problem in \ALCQI w.r.t.\ the empty TBox is
        \PSpace-complete~\cite{Tob-PhD01}, and the satisfiability problem in
        \ALCQI w.r.t.\ a general TBox is \ExpTime-complete~\cite{Tob-PhD01}.}

        For the upper bounds of Parts~\ref{enum:part-prj-tbox-alc}
        and~\ref{enum:part-prj-alcio} of the theorem, we give an
        \ExpTime-decision procedure.  Given a generalised ABox-literal~$\alpha$,
        a finite sequence of DL-actions $\abf_1,\dots,\abf_n$, a generalised
        ABox~\Amc, a TBox~\Tmc and a finite set of causal relationships~\CR, we
        do the following for all action types $T_0,\dots,T_{n-1}$ with
        $T_i\in\Tmf(\abf_{i+1},\CR)$ for every $i$, $0\le i<n$:
        \begin{enumerate}
            \item Construct
                $\bbf_{\abf_1,T_0,\CR},\dots,\bbf_{\abf_n,T_{n-1},\CR}$, \Rmc,
                $\bigcup_{i=0}^{n-1}T_i^{(i)}$, $\bigcup_{i=0}^n\Tmc^{(i)}$,
                $\Amc^{(0)}$, \Ared, \Tred, and $\alpha^{(n)}$, where \Ared and
                \Tred are constructed from
                $\bbf_{\abf_1,T_0,\CR},\dots,\bbf_{\abf_n,T_{n-1},\CR}$ and
                \Rmc.
            \item Check whether every model of $\bigcup_{i=0}^{n-1}T_i^{(i)}$,
                $\bigcup_{i=0}^n\Tmc^{(i)}$, $\Amc^{(0)}$, \Ared, and \Tred is
                also a model of $\alpha^{(n)}$.
        \end{enumerate}
        If Step~2 is successful, then we know by Lemma~\ref{lem:projection} that
        $\alpha$ is a consequence of applying $\abf_1,\dots,\abf_n$ to~\Amc
        w.r.t.~\Tmc and~\CR.  Note that there are exponentially many sequences
        of action types to consider.  Also, observe that Step~1 can be done in
        polynomial time, and thus the input to the reasoning problem of Step~2
        is of polynomial size.  Using the arguments in the proof of
        Theorem~\ref{thm:consistency-complexity-tbox}, we can reduce this
        reasoning problem to an ABox-\emph{in}consistency problem.  Since the
        ABox-consistency problem w.r.t.\ a general TBox is \ExpTime-complete in
        \ALCIO~\cite{Sch-DKE94,Hla-DPIJCAR04} and
        \ALCQO~\cite{Sch-DKE94,HoSa-IJCAI01}, and \ExpTime is closed under
        complement, we obtain the upper bounds of
        Parts~\ref{enum:part-prj-tbox-alc} and~\ref{enum:part-prj-alcio} of the
        theorem.

        For the upper bounds of Parts~\ref{enum:part-prj-tbox-alcqio}
        and~\ref{enum:part-prj-alcqio} of the theorem, we consider the
        complement of the projection problem.  For that, we first
        non-deterministically guess a sequence of action types
        $T_0,\dots,T_{n-1}$, perform Step~1 of the above decision procedure,
        and then perform the \emph{complement} of Step~2 of the above decision
        procedure, i.e.~we check whether there is a model of
        $\bigcup_{i=0}^{n-1}T_i^{(i)}$, $\bigcup_{i=0}^n\Tmc^{(i)}$,
        $\Amc^{(0)}$, \Ared, \Tred, and $\lnot\alpha^{(n)}$, which is clearly an
        ABox-consistency problem.  Since the ABox-consistency problem w.r.t.\ a
        general TBox is \NExpTime-complete for
        \ALCQIO~\cite{Sch-DKE94,Tob-JAIR00,Pra-JLLI05}, we obtain a
        \NExpTime-decision procedure for the complement of the projection
        problem, and thus a \coNExpTime-decision procedure for the projection
        problem, which proves the upper bounds of
        Parts~\ref{enum:part-prj-tbox-alcqio} and~\ref{enum:part-prj-alcqio} of
        the theorem.

        It is left to show the upper bounds of Part~\ref{enum:part-prj-alcqo} of
        the theorem.  For that, it suffices to give an \NPSpace-decision
        procedure for the complement of the projection problem for the case
        of~\ALCQO w.r.t.\ an acyclic TBox.\footnote{%
            Recall again that Savitch's theorem~\cite{Sav-JCSS70} implies that
            \NPSpace and \PSpace coincide, and that \PSpace is closed under
            complement.}
        We use the same decision procedure as for the upper bounds of
        Parts~\ref{enum:part-prj-tbox-alcqio} and~\ref{enum:part-prj-alcqio} of
        the theorem.  Note that the ABox-consistency problem of Step~2 of the
        above decision procedure does not contain any GCIs, as \Tred is acyclic.
        Since the ABox-consistency problem w.r.t.\ acyclic TBoxes is
        \PSpace-complete for \ALCQO~\cite{Sch-DKE94,BLM+-LTCS-05-02}, we obtain
        an \NPSpace-decision procedure for the complement of the projection
        problem, and thus we obtain the upper bounds of
        Part~\ref{enum:part-prj-alcqo} of the theorem.
\end{proof}

\noindent
This finishes the section on the projection problem, and in the next section, we
use the results obtained so far for verifying properties of infinite sequences
of DL-actions.


\section{Verification of DL-Actions}\label{sec:verifying-actions}

In this section, we show how to verify temporal properties in the DL-based
action formalism described in Section~\ref{sec:action-formalism}.  For that, we
follow the approach in~\cite{BaLM-ECAI10}.  The principle idea is that a
BÃ¼chi-automaton defines infinite sequences of DL-actions that characterise which
DL-actions an agent may execute.  Then, we verify whether a temporal property is
satisfied.  This temporal property is encoded in a restricted \Lmc-LTL-formula
where \Lmc is a DL between \ALC and \ALCQIO.%
\footnote{Note that in Chapter~\ref{ch:shoq-ltl}, we introduced \SHOQ-LTL and
    its fragments.  So far we have not considered \emph{inverse roles}.  It is,
    however, quite clear how the syntax and semantics of \Lmc-LTL is defined for
    \Lmc being a DL between \ALC and \ALCQIO that involves inverse roles.
    Therefore, we use the notation from Chapter~\ref{ch:shoq-ltl} such as the
    propositional abstraction etc.\ also here.}
%
The \Lmc-LTL-formulas considered in this section are restricted in the following
sense: whereas for \SHOQ-LTL, formulas could contain GCIs, we do not allow this
here (see Chapter~\ref{ch:shoq-ltl}).  This restriction is in accordance
with~\cite{BaLM-ECAI10}, where it was also made.  In principle, we do not need
this restriction here, but from an application point of view, it makes sense to
encode the domain knowledge in a global TBox and assume that it does not change
as done in the previous sections for the projection problem.

Moreover, the \Lmc-LTL-formulas in this section contain only assertions, whereas
in~\cite{BaLM-ECAI10} they contain arbitrary generalised ABox-literals.  This
is, however, not a restriction since the generalised ABox-literal $\lnot\alpha$
can be equivalently expressed by the \Lmc-LTL-formula $\lnot(\alpha)$.
%
In spite of these restrictions, we refer to the formulas considered in this
section as \Lmc-LTL-formulas for simplicity.
%
We are now ready to introduce the problems that we consider in this section.

\begin{definition}[Verification problem]
    Let~\Lmc be a DL between \ALC and \ALCQIO.  Furthermore, let~\Amc be a
    generalised \Lmc-ABox, \Tmc be an \Lmc-TBox, \CR be a finite set of causal
    relationships, \Abf be a finite set of DL-actions,
    $\Nmc=(Q,\Abf,\Delta,Q_0,F)$ be a BÃ¼chi-automaton, and $\phi$ be an
    \Lmc-LTL-formula.

    We say that $\phi$ is \emph{valid w.r.t.~\Amc, \Tmc, \CR, and~\Nmc} if for
    every infinite DL-action sequence $\abf_1\abf_2\dotso\in L_\omega(\Nmc)$,
    and every DL-LTL-structure $\Imf=(\Imc_i)_{i\ge 0}$ with $\Imc_0\models\Amc$
    and $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$ for each $i\ge 0$,
    we have $\Imf,0\models\phi$.

    Moreover, we say that $\phi$ is \emph{satisfiable w.r.t.~\Amc, \Tmc, \CR,
    and~\Nmc} if there is an infinite DL-action sequence
    $\abf_1\abf_2\dotso\in L_\omega(\Nmc)$, and a DL-LTL-structure
    $\Imf=(\Imc_i)_{i\ge 0}$ with $\Imc_0\models\Amc$ and
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$ for each $i\ge 0$ such
    that we have $\Imf,0\models\phi$.

    The \emph{verification problem (satisfiability problem)} is then to decide
    whether $\phi$ is valid (satisfiable) w.r.t.~\Amc, \Tmc, \CR, and~\Nmc.
\end{definition}

\noindent
It is easy to see that $\phi$ is valid w.r.t.~\Amc, \Tmc, \CR, and~\Nmc iff
$\lnot\phi$ is \emph{un}satisfiable w.r.t.~\Amc, \Tmc, \CR, and~\Nmc.
Conversely, $\phi$ is satisfiable w.r.t.~\Amc, \Tmc, \CR, and~\Nmc iff
$\lnot\phi$ is \emph{not} valid w.r.t.~\Amc, \Tmc, \CR, and~\Nmc.  Hence, the
verification problem and the \emph{un}satisfiability problem have the same
complexity.
%
The complexity of these problems is investigated in~\cite{BaLM-ECAI10} for the
case where the TBox is assumed to be \emph{acyclic} and no causal relationships
are available.  These complexity results depend on the DL used.  The following
result is proved in~\cite{BaLM-ECAI10,BaLM-LTCS-09-03}.

\begin{proposition}\label{prop:action-verification-acyclic-tbox}
    If the TBox is assumed to be acyclic and the set of causal relationships~\CR
    is assumed to be empty, the verification problem is
    \begin{enumerate}
        \item in \ExpSpace for the DLs \ALC, \ALCO, \ALCQ, and \ALCQO;
        \item in \TwoExpTime for the DLs \ALCI and \ALCIO; and
        \item in \coTwoNExpTime for the DLs \ALCQI and \ALCQIO.
    \end{enumerate}
\end{proposition}

\noindent
Unfortunately, no tight lower bounds of this problem are known.
%
Using similar ideas, we show now the upper bounds of the verification problem in
the case where the TBox is arbitrary and a finite set of causal relationships is
present.

From now on, let \Lmc be a description logic between \ALC and \ALCQIO, let \Amc
be a generalised \Lmc-ABox, let \Tmc be an \Lmc-TBox, let \CR be a finite set of
causal relationships, let $\Abf=\{\abf_1,\dots,\abf_n\}$ be a finite set of
DL-actions, let $\Nmc=(Q,\Abf,\Delta,Q_0,F)$ be a BÃ¼chi-automaton, and let
$\phi$ be an \Lmc-LTL-formula.
%
First observe that we can assume without loss of generality that \Amc is empty
by using an argument similar to the one used in the proof of
Lemma~\ref{lem:initial-validity}, namely, we compile \Amc into~$\phi$.  More
precisely, it is easy to verify that we have that $\phi$ is valid (satisfiable)
w.r.t.~\Amc, \Tmc, \CR, and~\Nmc iff $\phi\land\bigwedge\Amc$ is valid
(satisfiable) w.r.t.~$\emptyset$, \Tmc, \CR, and~\Nmc.

We furthermore assume without loss of generality that every axiom occurring in a
DL-action of~\Abf or a causal relationship of~\CR also occurs in~$\phi$.
Moreover, we assume without loss of generality that for every $A\in\NC$,
$r\in\NR$, $a,b\in\NI$ occurring in~$\phi$, \Tmc, a DL-action of~\Abf, or a
causal relationship of~\CR, we have that the assertions $A(a)$ and $r(a,b)$ also
occur in~$\phi$.
%
These two assumptions are indeed without loss of generality since for every such
axiom~$\alpha$, which does not occur in~$\phi$, we can define
$\phi':=\phi\land(\alpha\lor\lnot\alpha)$.  Obviously, every model of~$\phi$ is
also a model of~$\phi'$, and vice versa.

To solve the satisfiability problem, we combine the approach of
Chapter~\ref{ch:shoq-ltl} with the one of Sections~\ref{sec:consistency}
and~\ref{sec:projection}.
%
We again split the problem in two sub-problems.  First note that
Lemma~\ref{lem:r-sat-t-sat} also holds for the restricted \Lmc-LTL-formulas that
we consider in this section.
%
Let $\psf\colon\Ax(\phi)\to\Pmc_\phi$ be a bijection.
%
Hence, we know that $\phi$ is satisfiable iff there is a set $\Wmc\subseteq
2^{\Pmc_\phi}$ such that \Wmc is r-satisfiable (see Definition~\ref{def:r-sat})
and $\phi^\psf$ is t-satisfiable w.r.t.~\Wmc (see Definition~\ref{def:t-sat}).
However, we need to adapt both sub-problems due to the semantics of DL-actions.

We first consider how to decide t-satisfiability w.r.t.\ a given set~\Wmc.  For
that, we assume from now on that $\Wmc=\{X_1,\dots,X_k\}\subseteq 2^{\Pmc_\phi}$
is given.
%
By Lemma~\ref{lem:t-sat}, we can decide whether $\phi^\psf$ is t-satisfiable
w.r.t.~\Wmc in time exponential in the size of~$\phi^\psf$ and linear in the
size of~\Wmc.  In the proof of Lemma~\ref{lem:t-sat}, a BÃ¼chi-automaton
for~$\phi^\psf_\Wmc$ is constructed.  Let $\Nmc_{\phi^\psf_\Wmc}$ be that
BÃ¼chi-automaton.

However, $\Nmc_{\phi^\psf_\Wmc}$ may accept a sequence of worlds that does not
correspond to a sequence of DL-actions defined by~\Nmc.  Thus, we need to
intersect the $\omega$-language accepted by $\Nmc_{\phi^\psf_\Wmc}$ with the one
\enquote{generated} by the $\omega$-language accepted by~\Nmc.  For that, we
construct a BÃ¼chi-automaton~\Nmch by considering the effects of the DL-actions
occurring in an accepting run of~\Nmc.  In order to be able to enforce that the
semantics of DL-actions is respected, it is essential that the worlds contain
information about all $a,b\in\NI$, $A\in\NC$, and $r\in\NR$ occurring in the
input whether $A(a)$ ($r(a,b)$) holds or not.

To be able to specify the effects of a DL-action in~\Nmch, we need to keep track
of the action type associated with a world.
%
For that, we define for $\sigma\in\Sigma_{\Pmc_\phi}$, the generalised ABox
$T_{\sigma,\abf,\CR}\subseteq\Cond(\abf,\CR)$ as follows:
\begin{itemize}
    \item for every positive generalised ABox-literal
        $\alpha\in\Cond(\abf,\CR)$, we have $\alpha\in T_{\sigma,\abf,\CR}$ iff
        $\psf(\alpha)\in\sigma$; and
    \item for every negative generalised ABox-literal
        $\lnot\alpha\in\Cond(\abf,\CR)$, we have
        $\lnot\alpha\in T_{\sigma,\abf,\CR}$ iff $\psf(\alpha)\notin\sigma$.
\end{itemize}

\noindent
We can now define the BÃ¼chi-automaton
\[\Nmch:=(Q\times\Abf\times\Sigma_{\Pmc_\phi},\ \Sigma_{\Pmc_\phi},\
    \Deltah,\ Q_0\times\Abf\times\Sigma_{\Pmc_\phi},\
    F\times\Abf\times\Sigma_{\Pmc_\phi}),\]
where we have
$((q,\abf,\sigma),\ \sigma'',\ (q',\abf',\sigma'))\ \in\ \Deltah$ iff

\begin{itemize}
    \item $(q,\abf,q')\in\Delta$;
    \item $\sigma=\sigma''$;
    \item for every positive generalised ABox-literal $\alpha\in\pre$, we have
        $\psf(\alpha)\in\sigma$, and for every negative generalised ABox-literal
        $\lnot\alpha\in\pre$, we have $\psf(\alpha)\notin\sigma$, where
        $\abf=(\pre,\post)$;
    \item $T_{\sigma,\abf,\CR}$ is an action type for~\abf and~\CR;
    \item for every positive ABox-literal
        $\beta\in\Eff(\abf,T_{\sigma,\abf,\CR},\CR)$, we have
        $\psf(\beta)\in\sigma'$, and for every negative ABox-literal
        $\lnot\beta\in\Eff(\abf,T_{\sigma,\abf,\CR},\CR)$, we have
        $\psf(\beta)\notin\sigma'$; and
    \item for every ABox-literal $\gamma\in\Ax(\phi)$, we have:
        \begin{itemize}
            \item if $\psf(\gamma)\in\sigma$ and
                $\lnot\gamma\notin\Eff(\abf,T_{\sigma,\abf,\CR},\CR)$, we have
                $\psf(\gamma)\in\sigma'$, and
            \item if $\psf(\gamma)\notin\sigma$ and
                $\gamma\notin\Eff(\abf,T_{\sigma,\abf,\CR},\CR)$, we have
                $\psf(\gamma)\notin\sigma'$.
        \end{itemize}
\end{itemize}

\noindent
Let $\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$ denote the BÃ¼chi-automaton that
accepts the intersection of the $\omega$-language accepted by the
BÃ¼chi-automaton~$\Nmc_{\phi^\psf_\Wmc}$ and the $\omega$-language accepted by
the BÃ¼chi-automaton~\Nmch.
%
Such a BÃ¼chi-automaton can be obtained using the standard product construction
in time polynomial in the size of the input BÃ¼chi-automata, see
e.g.~\cite{BaKa-08,Tho-90}.

In order to be sure that $\omega$-words accepted
by~$\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$ can indeed be
\enquote{lifted} to DL-LTL-structures, we need to check whether~\Wmc is
r-satisfiable.  However, to make sure that the semantics of the DL-actions is
satisfied, we need to intertwine this check with another one.  Indeed, so far we
only dealt with the \emph{named} part of the interpretations in a
DL-LTL-structure.  Additionally, we need to ensure that the \emph{unnamed} part
of the interpretations in a DL-LTL-structure remains unchanged.
%
Recall that the TBox~\Tred defined in Section~\ref{sec:consistency} was designed
to take care of this matter.  We use a very similar TBox~\Tred also here.

In the following, let again \Rmc denote a set of relevant concept names, role
names, and concepts such that \Rmc contains all concept names, role names, and
concepts occurring in~$\phi$.  Moreover, let \Obj denote the set of individual
names occurring in~$\phi$.

We introduce time-stamped copies $A^{(i)}$ ($r^{(i)}$), $0\le i\le k$, of all
concept names $A\in\Rmc$ (role names $r\in\Rmc$), and new time-stamped concept
names $T_C^{(i)}$, $1\le i\le k$, of all concepts $C\in\Rmc$.
%
Now, the TBox~\Tred again consists of two parts, i.e.~$\Tred:=\TN\cup\Tsub$.
The TBox~\TN is defined as in Section~\ref{sec:consistency}, and the TBox~\Tsub
consists of a concept definition of $T_C^{(i)}$ for every concept $C\in\Rmc$ and
every $i$, $0\le i\le k$, where the concept definition of~$T_C^{(i)}$ is defined
inductively as in Section~\ref{sec:consistency}.

Moreover, we define the generalised ABox~$\Amc_\Wmc$ as follows:
\[\Amc_\Wmc:=\bigcup_{i=1}^k\Bigl(%
    \bigl\{(\psf^{-1}(p))^{(i)}\mid p\in X_i\bigr\}\cup%
    \bigl\{(\lnot\psf^{-1}(p))^{(i)}\mid p\in\Pmc_\phi\setminus X_i\bigr\}\Bigr),\]
where the time-stamped variant $\alpha^{(i)}$ of an axiom $\alpha\in\Ax(\phi)$
is defined as in Section~\ref{sec:consistency}.

Additionally, we need to ensure that the TBox~\Tmc is respected.  For that, we
construct copies $\Tmc^{(i)}$, $1\le i\le k$.
%
Now, the following lemma states how the
BÃ¼chi-automaton~$\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$, the ABox~$\Amc_\Wmc$,
the TBoxes $\Tmc^{(i)}$, $1\le i\le k$, and the TBox~\Tred can be used to solve
the satisfiability problem.

\begin{lemma}\label{lem:action-sat-wmc}
    The \Lmc-LTL-formula~$\phi$ is satisfiable w.r.t.~$\emptyset$, \Tmc, \CR,
    and~\Nmc iff there is a set $\Wmc=\{X_1,\dots,X_k\}\subseteq 2^{\Pmc_\phi}$
    such that
    \begin{itemize}
        \item $L_\omega(\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}})\ne\emptyset$,
            and
        \item $\Amc_\Wmc$ has a model
            w.r.t.~$\Tred\cup\bigcup_{i=1}^k\Tmc^{(i)}$.
    \end{itemize}
\end{lemma}

\begin{proof}
    For the \enquote{only if} direction, assume that there is an infinite
    sequence of DL-actions $\abf_1\abf_2\dotso\in L_\omega(\Nmc)$, and a
    DL-LTL-structure $\Imf=(\Imc_i)_{i\ge 0}$ with
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$ for each $i\ge 0$ such
    that we have $\Imf,0\models\phi$.
    %
    Let $\Imf^\psf=(w_i)_{i\ge 0}$ be the propositional abstraction of~\Imf
    w.r.t.~\psf, and let
    $\Wmc:=\{w_i\mid i\ge 0\}=\{X_1,\dots,X_k\}\subseteq 2^{\Pmc_\phi}$.  By
    Lemma~\ref{lem:ltl-structure-r-sat}, we have that $\Imf^\psf$ is a model
    of~$\phi^\psf$.  By construction of~\Wmc, we have also that $\Imf^\psf$ is a
    model of~$\phi^\psf_\Wmc$.  Since $\Nmc_{\phi^\psf_\Wmc}$ is a
    BÃ¼chi-automaton for~$\phi^\psf_\Wmc$ (which is the one constructed in the
    proof of Lemma~\ref{lem:t-sat}), we have that
    $w:=w_0w_1\dotso\in L_\omega(\Nmc_{\phi^\psf_\Wmc})$.

    To show that $w\in L_\omega(\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}})$, it
    remains to prove that $w\in L_\omega(\Nmch)$ as
    $\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$ accepts the intersection of the
    $\omega$-language accepted by~$\Nmc_{\phi^\psf_\Wmc}$ and the
    $\omega$-language accepted by~\Nmch.
    %
    Since $\abf_1\abf_2\dotso\in L_\omega(\Nmc)$, there is an accepting run
    $q_0q_1\dots$ of~\Nmc on~$\abf_1\abf_2\dots$.  Then,
    \[(q_0,\abf_1,w_0)(q_1,\abf_2,w_1)(q_2,\abf_3,w_2)\dots\]
    is an accepting run of~\Nmch on~$w$ due to the following reasons:
    \begin{itemize}
        \item Obviously, we have that for every $i\ge 0$ that
            $(q_i,\abf_{i+1},w_i)$ is a state of~\Nmch.
        \item We have for every $i\ge 0$ that
            $((q_i,\abf_{i+1},w_i),\ w_i,\ (q_{i+1},\abf_{i+2},w_{i+1}))\ \in\ \Deltah$
            since the following holds:
            \begin{itemize}
                \item We have $(q_i,\abf_{i+1},q_{i+1})\in\Delta$ by
                    construction.
                \item The condition that~$w_i$ is the last component of the
                    tuple $(q_i,\abf_{i+1},w_i)$ is also satisfied.
                \item Since
                    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$, we
                    have that $\abf_{i+1}=(\pre_{i+1},\post_{i+1})$ is
                    applicable to~$\Imc_i$ w.r.t.~\Tmc.  Thus,
                    $\Imc_i\models\pre_{i+1}$.  Since we assumed that all axioms
                    occurring in~$\pre_{i+1}$ also occur in~$\phi$, for every
                    positive generalised ABox-literal $\alpha\in\pre_{i+1}$, we
                    have that $\psf(\alpha)\in w_i$.  Likewise, for every
                    negative generalised ABox-literal
                    $\lnot\alpha\in\pre_{i+1}$, we have
                    $\psf(\alpha)\notin w_i$.
                \item Since we assumed that all axioms occurring in~$\abf_{i+1}$
                    and~\CR also occur in~$\phi$, we have, by the definition
                    of~$T_{w_i,\abf_{i+1},\CR}$, for every negative generalised
                    ABox-literal $\lnot\alpha\in\Cond(\abf_{i+1},\CR)$, that
                    $\lnot\alpha\in T_{w_i,\abf_{i+1},\CR}$ iff
                    $\psf(\alpha)\notin w_i$ iff
                    $\alpha\notin T_{w_i,\abf_{i+1},\CR}$.
                    %
                    Moreover, we have $\Imc_i\models T_{w_i,\abf_{i+1},\CR}$,
                    and hence $T_{w_i,\abf_{i+1},\CR}$ is an action type
                    for~$\abf_{i+1}$ and~\CR.
                \item Since
                    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$, we
                    have by Lemma~\ref{lem:models-effects} that
                    $\Imc_{i+1}\models\Eff(\abf_{i+1},\Imc_i,\CR)$.
                    %
                    By Lemma~\ref{lem:effects-by-type}, we obtain further that
                    $\Eff(\abf_{i+1},\Imc_i,\CR)=\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.
                    Thus, we have that
                    $\Imc_{i+1}\models\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.
                    Since we assumed that all axioms occurring in~$\abf_{i+1}$
                    and~\CR also occur in~$\phi$, for every positive
                    ABox-literal
                    $\beta\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$, we
                    have that $\psf(\beta)\in w_{i+1}$.  Likewise, for every
                    negative ABox-literal
                    $\lnot\beta\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$,
                    we have $\psf(\beta)\notin w_{i+1}$.
                \item For the last condition, take first any ABox-literal
                    $\gamma\in\Ax(\phi)$ with $\psf(\gamma)\in w_i$ and
                    $\lnot\gamma\notin\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.
                    Thus, $\Imc_i\models\gamma$.  We prove
                    $\Imc_{i+1}\models\gamma$ by a case distinction.  If
                    $\gamma$ is of the form $A(a)$ for $A\in\NC$ and $a\in\NI$,
                    we have $a^{\Imc_i}\in A^{\Imc_i}$.  Since
                    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$, this
                    yields $a^{\Imc_i}\in A^{\Imc_{i+1}}$, and thus
                    $\Imc_{i+1}\models A(a)$.  Otherwise, if $\gamma$ is of the
                    form $r(a,b)$ for $r\in\NR$ and $a,b\in\NI$, we have
                    $(a^{\Imc_i},b^{\Imc_i})\in r^{\Imc_i}$.  Since
                    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$, this
                    yields $(a^{\Imc_i},b^{\Imc_i})\in r^{\Imc_{i+1}}$, and thus
                    $\Imc_{i+1}\models r(a,b)$.
                    %
                    Overall, we obtain $\psf(\gamma)\in w_{i+1}$.

                    For the second case, take any ABox-literal
                    $\gamma\in\Ax(\phi)$ with $\psf(\gamma)\notin w_i$ and
                    $\gamma\notin\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.
                    Thus, $\Imc_i\not\models\gamma$.  We prove
                    $\Imc_{i+1}\not\models\gamma$ again by a case distinction.
                    If $\gamma$ is of the form $A(a)$ for $A\in\NC$ and
                    $a\in\NI$, we have $a^{\Imc_i}\notin A^{\Imc_i}$.  Since
                    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$, this
                    yields $a^{\Imc_i}\notin A^{\Imc_{i+1}}$, and thus
                    $\Imc_{i+1}\not\models A(a)$.  Otherwise, if $\gamma$ is of
                    the form $r(a,b)$ for $r\in\NR$ and $a,b\in\NI$, we have
                    $(a^{\Imc_i},b^{\Imc_i})\notin r^{\Imc_i}$.  Since
                    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$, this
                    yields $(a^{\Imc_i},b^{\Imc_i})\notin r^{\Imc_{i+1}}$, and
                    thus $\Imc_{i+1}\not\models r(a,b)$.
                    %
                    Overall, we obtain $\psf(\gamma)\notin w_{i+1}$.
            \end{itemize}
        \item Since $q_0\in Q_0$, we have that $(q_0,\abf_1,w_0)$ is an initial
            state of~\Nmch.
        \item Since $q_0q_1\dots$ is an accepting run of~\Nmc on
            $\abf_1\abf_2\dots$, there are infinitely many $j\ge 0$ such that
            $q_j\in F$.  The definition of the final states of~\Nmch yields now
            that the above run is accepting.
    \end{itemize}

    It is left to be shown that $\Amc_\Wmc$ has a model w.r.t.\
    $\Tred\cup\bigcup_{i=1}^k\Tmc^{(i)}$.
    %
    We have for every $i\ge 0$ that there is an index $\nu_i\in\{1,\dots,k\}$
    such that $\Imc_i$ induces the set~$X_{\nu_i}$, i.e.\
    \[X_{\nu_i}=\bigl\{\psf(\alpha)\mid\alpha\in\Ax(\phi)\ \text{and}\
        \Imc_i\models\alpha\bigr\},\]
    and, conversely, for every $\nu\in\{1,\dots,k\}$, there is an index $i\ge 0$
    such that $\nu=\nu_i$.  Let $\ell_1,\dots,\ell_k$ be such that
    $\nu_{\ell_1}=1$,~\dots, $\nu_{\ell_k}=k$.  Note that
    Definition~\ref{def:action-semantics} yields that the
    domain~$\Delta^{\Imc_0}$ of~$\Imc_0$ is equal to the
    domain~$\Delta^{\Imc_i}$ of~$\Imc_i$ for every $i\ge 0$.  Moreover,
    $a^{\Imc_0}=a^{\Imc_i}$ for every $a\in\NI$ and every $i\ge 0$.
    %
    Now, we define the interpretation $\Jmc=(\Delta^\Jmc,\cdot^\Jmc)$ as
    follows:
    \begin{itemize}
        \item $\Delta^\Jmc:=\Delta^{\Imc_0}$;
        \item $a^\Jmc:=a^{\Imc_0}$ for every $a\in\NI$;
        \item $N^\Jmc:=\{a^\Jmc\mid a\in\Obj\}$;
        \item $(A^{(0)})^\Jmc:=A^{\Imc_0}$ for every $A\in\Rmc\cap\NC$;
        \item $(A^{(i)})^\Jmc:=A^{\Imc_{\ell_i}}$ for every $A\in\Rmc\cap\NC$
            and every~$i$, $1\le i\le k$;
        \item $(r^{(0)})^\Jmc:=r^{\Imc_0}$ for every $r\in\Rmc\cap\NR$;
        \item $(r^{(i)})^\Jmc:=r^{\Imc_{\ell_i}}$ for every $r\in\Rmc\cap\NR$
            and every~$i$, $1\le i\le k$; and
        \item $(T_C^{(i)})^\Jmc:=C^{\Imc_{\ell_i}}$ for every concept $C\in\Rmc$
            and every~$i$, $1\le i\le k$.
    \end{itemize}

    The definition of~$N^\Jmc$ yields that $\Jmc\models\TN$.  Moreover, we have
    that $\Jmc\models\Tsub$, which can be shown using arguments that are very
    similar to the ones used to prove
    Property~\eqref{enum:reduction-direction-one} of Lemma~\ref{lem:ared-tred}.
    Hence, $\Jmc\models\Tred$.
    %
    Moreover, since $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$
    for every $i\ge 0$, Definition~\ref{def:action-semantics} yields that
    $\Imc_i\models\Tmc$ for every $i\ge 0$.  Thus, we have
    $\Imc_{\ell_i}\models\Tmc$ for every~$i$, $1\le i\le k$.  Take any
    $C\sqsubseteq D\in\Tmc$ and any~$i$, $1\le i\le k$.  We have
    $\Imc_{\ell_i}\models C\sqsubseteq D$, and thus by the definition of~\Jmc
    that $\Jmc\models T_C^{(i)}\sqsubseteq T_D^{(i)}$.  Hence,
    $\Jmc\models\Tmc^{(i)}$.
    %
    Overall, we obtain that $\Jmc\models\Tred\cup\bigcup_{i=1}^k\Tmc^{(i)}$.

    It is only left to show that $\Jmc\models\Amc_\Wmc$.  Note that we have for
    every relevant generalised ABox-literal~$\alpha$ and every~$i$, $1\le i\le
    k$, that $\Imc_{\ell_i}\models\alpha$ iff $\Jmc\models\alpha^{(i)}$.  This
    can be shown using arguments that are very similar to the ones used to prove
    Property~\eqref{enum:reduction-direction-one-a} of
    Lemma~\ref{lem:ared-tred}.  Since we have for~$i$, $1\le i\le k$, that
    \[X_i=\bigl\{\psf(\alpha)\mid\alpha\in\Ax(\phi)\ \text{and}\
        \Imc_{\ell_i}\models\alpha\bigr\},\]
    this yields that \Jmc is a model of the generalised ABox
    \[\bigl\{(\psf^{-1}(p))^{(i)}\mid p\in X_i\bigr\}\cup%
        \bigl\{(\lnot\psf^{-1}(p))^{(i)}\mid p\in\Pmc_\phi\setminus X_i\bigr\}\]
    for every~$i$, $1\le i\le k$.  Hence, we have that $\Jmc\models\Amc_\Wmc$.

    For the \enquote{if} direction, assume that there is a set
    $\Wmc=\{X_1,\dots,X_k\}\subseteq 2^{\Pmc_\phi}$ such that
    $L_\omega(\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}})\ne\emptyset$ and
    $\Amc_\Wmc$ has a model w.r.t.\ $\Tred\cup\bigcup_{i=1}^k\Tmc^{(i)}$.
    Hence, there is an $\omega$-word
    $w=w_0w_1\dotso\in L_\omega(\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}})$ and a
    model $\Jmc=(\Delta^\Jmc,\cdot^\Jmc)$ of~$\Amc_\Wmc$ and
    $\Tred\cup\bigcup_{i=1}^k\Tmc^{(i)}$.

    We define interpretations~$\Jmc_i=(\Delta^{\Jmc_i},\cdot^{\Jmc_i})$,
    $1\le i\le k$, as follows:
    \begin{itemize}
        \item $\Delta^{\Jmc_i}:=\Delta^\Jmc$;
        \item $a^{\Jmc_i}:=a^\Jmc$ for every $a\in\NI$;
        \item $A^{\Jmc_i}:=(T_A^{(i)})^\Jmc$ for every $A\in\Rmc\cap\NC$;
        \item $r^{\Jmc_i}:=\bigl((r^{(i)})^\Jmc\cap(N^\Jmc\times N^\Jmc)\bigr)\cup%
                \biggl((r^{(0)})^\Jmc\cap\Bigl(\bigl(\Delta^\Jmc\times(\lnot N)^\Jmc\bigr)\cup%
                \bigl((\lnot N)^\Jmc\times\Delta^\Jmc\bigr)\Bigr)\biggr)$
            for every $r\in\Rmc\cap\NR$.
    \end{itemize}
    %
    The interpretation of concept names and role names that are not contained
    in~\Rmc is irrelevant.  We assume in the following without loss of
    generality that the interpretation of all such names in empty in all
    interpretations~$\Jmc_i$, $1\le i\le k$.

    One can show that for every relevant generalised ABox-literal~$\alpha$ and
    every~$i$, $1\le i\le k$, we have $\Jmc_i\models\alpha$ iff
    $\Jmc\models\alpha^{(i)}$.  Moreover, one can show that for every relevant
    concept~$C$ and every~$i$, $1\le i\le k$, we have
    $C^{\Jmc_i}=(T_C^{(i)})^\Jmc$.  These two claims can be shown using
    arguments very similar to the ones used to prove
    Properties~\eqref{enum:reduction-direction-two-a}
    and~\eqref{enum:reduction-direction-two-b} of Lemma~\ref{lem:ared-tred}.
    %
    Since $\Jmc\models\Amc_\Wmc$, this yields that every~$\Jmc_i$,
    $1\le i\le k$, satisfies exactly the axioms specified by the propositional
    variables in~$X_i$.
    %
    Moreover, since $\Jmc\models\bigcup_{i=1}^k\Tmc^{(i)}$, we have that
    $\Jmc\models T_C^{(i)}\sqsubseteq T_D^{(i)}$ for every
    $C\sqsubseteq D\in\Tmc$ and every~$i$, $1\le i\le k$.  Thus, every~$\Jmc_i$,
    $1\le i\le k$, is a model of~\Tmc.

    Since $\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$ is defined to accept the
    intersection of the $\omega$-language accepted by~$\Nmc_{\phi^\psf_\Wmc}$
    and the $\omega$-language accepted by~\Nmch, we have that
    $w\in L_\omega(\Nmc_{\phi^\psf_\Wmc})$ and $w\in L_\omega(\Nmch)$.
    Moreover, since $\Nmc_{\phi^\psf_\Wmc}$ is a BÃ¼chi-automaton
    for~$\phi^\psf_\Wmc$ (which is the one constructed in the proof of
    Lemma~\ref{lem:t-sat}), we have that the propositional LTL-structure
    $\Wmf:=(w_i)_{i\ge 0}$ is a model of~$\phi^\psf_\Wmc$.  By the definition
    of~$\phi^\psf_\Wmc$, we have that for every world~$w_i$, there is exactly
    one index $\nu_i\in\{1,\dots,k\}$ such that $w_i$ satisfies
    \[\bigwedge_{p\in X_{\nu_i}}p\land\bigwedge_{p\in\Pmc_\phi\setminus X_{\nu_i}}\lnot p.\]
    We now define a DL-LTL-structure $\Imf:=(\Imc_i)_{i\ge 0}$ as follows.  We
    set $\Imc_i:=\Jmc_{\nu_i}$ for $i\ge 0$.
    %
    With the above arguments, we have that every~$\Imc_i$ satisfies exactly the
    axioms specified by the propositional variables in~$X_{\nu_i}$.  Thus, we
    obtain that for every $i\ge 0$ and every $\alpha\in\Ax(\phi)$, we have
    $\Imc_i\models\alpha$ iff $\psf(\alpha)\in X_{\nu_i}$ iff
    $\psf(\alpha)\in w_i$.
    %
    Moreover, since \Wmf is a model of~$\phi^\psf_\Wmc$, we obtain that \Imf is
    a model of~$\phi$.

    Since $w\in L_\omega(\Nmch)$, there is an accepting run of~\Nmch on~$w$.
    The definition of~\Nmch yields that this run is of the form
    \[(q_0,\abf_1,w_0)(q_1,\abf_2,w_1)(q_2,\abf_3,w_2)\dots.\]
    The definition of~\Nmch yields moreover that $q_0q_1q_2\dots$ is an
    accepting run of~\Nmc on $\abf_1\abf_2\dots$.  Thus,
    $\abf_1\abf_2\dotso\in L_\omega(\Nmc)$.

    It is only left to show that for every $i\ge 0$, we have that
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$.  For that, let
    $i\ge 0$ be arbitrary, and let $\abf_{i+1}=(\pre_{i+1},\post_{i+1})$.
    %
    First note that by the definition of~$\Imc_i$ and the arguments above, we
    have that $\Imc_i\models\Tmc$ and $\Imc_{i+1}\models\Tmc$.
    %
    The definition of~\Deltah yields that for every positive generalised
    ABox-literal $\alpha\in\pre_{i+1}$, we have $\psf(\alpha)\in w_i$, and thus
    $\Imc_i\models\alpha$.  Moreover, we have for every negative generalised
    ABox-literal $\lnot\alpha\in\pre_{i+1}$ that $\psf(\alpha)\notin w_i$, and
    thus $\Imc_i\models\lnot\alpha$.  Thus, $\Imc_i\models\pre_{i+1}$, and hence
    $\abf_{i+1}$ is applicable to~$\Imc_i$ w.r.t.~\Tmc.

    Furthermore, we have that the domains of~$\Imc_i$ and~$\Imc_{i+1}$ coincide
    by definition, and we have $a^{\Imc_i}=a^{\Imc_{i+1}}$ for every $a\in\NI$,
    again by definition.

    We show now that
    $\Eff(\abf_{i+1},\Imc_i,\CR)=\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.
    Take the action type
    $T:=\{\alpha\in\Cond(\abf_{i+1},\CR)\mid\Imc_i\models\alpha\}$.  Obviously,
    $T$ is an action type for~$\abf_{i+1}$ and~\CR with $\Imc_i\models T$.  By
    Lemma~\ref{lem:effects-by-type}, we obtain
    $\Eff(\abf_{i+1},\Imc_i,\CR)=\Eff(\abf_{i+1},T,\CR)$.  Thus, it is enough to
    show that $T_{w_i,\abf_{i+1},\CR}=T$.  For every positive generalised
    ABox-literal $\alpha\in\Cond(\abf_{i+1},\CR)$, we have
    $\alpha\in T_{w_i,\abf_{i+1},\CR}$ iff $\psf(\alpha)\in w_i$ iff
    $\Imc_i\models\alpha$ iff $\alpha\in T$.  For every negative generalised
    ABox-literal $\lnot\alpha\in\Cond(\abf_{i+1},\CR)$, we have
    $\lnot\alpha\in T_{w_i,\abf_{i+1},\CR}$ iff $\psf(\alpha)\notin w_i$ iff
    $\Imc_i\not\models\alpha$ iff $\Imc_i\models\lnot\alpha$ iff
    $\lnot\alpha\in T$.

    Moreover, $\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$ is not contradictory
    due to the following arguments.  Suppose we have
    $\{\beta,\lnot\beta\}\subseteq\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$
    for some positive ABox-literal~$\beta$.  The definition of~\Deltah yields
    that $\psf(\beta)\in w_i$ and $\psf(\beta)\notin w_i$, which is a
    contradiction.

    Let $A\in\NC\cap\Rmc$, let
    \[A^+:=\{a^{\Imc_i}\mid%
        A(a)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)\},\]
    and let
    \[A^-:=\{a^{\Imc_i}\mid%
        \lnot A(a)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)\}.\]
    Since $\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$ is not contradictory, we
    have that $A^+\cap A^-=\emptyset$.  Moreover, we have by definition that
    $A^+\subseteq N^\Jmc$ and $A^-\subseteq N^\Jmc$.
    %
    We first show that
    $A^{\Imc_{i+1}}\setminus N^\Jmc=A^{\Imc_i}\setminus N^\Jmc$.  Since
    $\Jmc\models\Tsub$, we have
    \begin{align*}
        A^{\Imc_{i+1}}\setminus N^\Jmc
        &=(T_A^{(\nu_{i+1})})^\Jmc\setminus N^\Jmc\\
        &=\bigl((N^\Jmc\cap(A^{(\nu_{i+1})})^\Jmc)\cup((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)}))^\Jmc\bigr)\setminus N^\Jmc\\
        &=((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)}))^\Jmc\setminus N^\Jmc\\
        &=\bigl((N^\Jmc\cap(A^{(\nu_{i})})^\Jmc)\cup((\Delta^\Jmc\setminus N^\Jmc)\cap(A^{(0)}))^\Jmc\bigr)\setminus N^\Jmc\\
        &=(T_A^{(\nu_{i})})^\Jmc\setminus N^\Jmc\\
        &=A^{\Imc_i}\setminus N^\Jmc
    \end{align*}

    \noindent
    Hence, we have for every $d\in\Delta^\Jmc\setminus N^\Jmc$ that
    $d\in A^{\Imc_{i+1}}$ iff $d\in(A^{\Imc_i}\cup A^+)\setminus A^-$.
    %
    We prove that for every $a^\Jmc\in N^\Jmc$, we have
    $a^\Jmc\in A^{\Imc_{i+1}}$ iff $a^\Jmc\in(A^{\Imc_i}\cup A^+)\setminus A^-$
    by a case distinction.
    %
    For the \enquote{if} direction, it is obvious that we have
    $a^\Jmc\notin A^-$.  We consider first the case where $a^\Jmc\in A^+$, and
    thus $A(a)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.  The definition
    of~\Deltah yields that $\psf(A(a))\in w_{i+1}$, and thus
    $\Imc_{i+1}\models A(a)$, i.e.~$a^\Jmc\in A^{\Imc_{i+1}}$.

    Consider now the case where $a^\Jmc\notin A^+$,
    i.e.~$a^\Jmc\in A^{\Imc_i}\setminus A^-$.  Since $a^\Jmc\in A^{\Imc_i}$, we
    have $\Imc_i\models A(a)$, and thus $\psf(A(a))\in w_i$.  Moreover, we have
    $\lnot A(a)\notin\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$ by the
    definition of~$A^-$.  Again, the definition of~\Deltah yields that
    $\psf(A(a))\in w_{i+1}$, and thus $\Imc_{i+1}\models A(a)$,
    i.e.~$a^\Jmc\in A^{\Imc_{i+1}}$.

    For the \enquote{only if} direction, assume to the contrary that
    $a^\Jmc\in A^{\Imc_{i+1}}$, $a^\Jmc\notin A^+$, and
    $a^\Jmc\notin A^{\Imc_i}\setminus A^-$.  There are again two cases to
    consider: either $a^\Jmc\in A^-$ or $a^\Jmc\notin A^-$.  If $a^\Jmc\in A^-$,
    then $\lnot A(a)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.  Again, the
    definition of~\Deltah yields that $\psf(A(a))\notin w_{i+1}$, and thus
    $\Imc_{i+1}\not\models A(a)$, i.e.~we have $a^\Jmc\notin A^{\Imc_{i+1}}$,
    which is a contradiction.

    Otherwise, if $a^\Jmc\notin A^-$, we have $a^\Jmc\notin A^{\Imc_i}$, and
    thus $\Imc_i\not\models A(a)$, which yields $\psf(A(a))\notin w_i$.  Since
    $a^\Jmc\notin A^+$, we have by the definition of~$A^+$ that
    $A(a)\notin\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.  Again, the
    definition of~\Deltah yields that $\psf(A(a))\notin w_{i+1}$, and thus
    $\Imc_{i+1}\not\models A(a)$, i.e.~we have $a^\Jmc\notin A^{\Imc_{i+1}}$,
    which is again a contradiction.

    Thus, we have shown that $A^{\Imc_{i+1}}=(A^{\Imc_i}\cup A^+)\setminus A^-$.
    %
    Finally, let $r\in\NR\cap\Rmc$, let
    \[r^+:=\{(a^{\Imc_i},b^{\Imc_i})\mid%
        r(a,b)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)\},\]
    and let
    \[r^-:=\{(a^{\Imc_i},b^{\Imc_i})\mid%
        \lnot r(a,b)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)\}.\]
    Since $\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$ is not contradictory, we
    have that $r^+\cap r^-=\emptyset$.  Moreover, we have by definition that
    $r^+\subseteq N^\Jmc\times N^\Jmc$ and $r^-\subseteq N^\Jmc\times N^\Jmc$.
    %
    Similar to before, we first show that
    $r^{\Imc_{i+1}}\setminus(N^\Jmc\times N^\Jmc)=r^{\Imc_i}\setminus(N^\Jmc\times N^\Jmc)$.
    By the definitions of $r^{\Imc_{i+1}}$ and $r^{\Imc_i}$, we have
    \begin{align*}
        r^{\Imc_{i+1}}\setminus(N^\Jmc\times N^\Jmc)
        &=\bigl((r^{(0)})^\Jmc\cap((\Delta^\Jmc\times(\lnot N)^\Jmc)\cup%
            ((\lnot N)^\Jmc\times\Delta^\Jmc))\bigr)\setminus(N^\Jmc\times N^\Jmc)\\
        &=r^{\Imc_i}\setminus(N^\Jmc\times N^\Jmc).
    \end{align*}

    \noindent
    Hence, we have for all $d,e\in\Delta^\Jmc\setminus N^\Jmc$ that
    $(d,e)\in r^{\Imc_{i+1}}$ iff $(d,e)\in(r^{\Imc_i}\cup r^+)\setminus r^-$.
    %
    Using very similar arguments as above, we prove that for every
    $(a^\Jmc,b^\Jmc)\in N^\Jmc\times N^\Jmc$, we have
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$ iff
    $(a^\Jmc,b^\Jmc)\in(r^{\Imc_i}\cup r^+)\setminus r^-$.
    %
    For the \enquote{if} direction, it is obvious that we have
    $(a^\Jmc,b^\Jmc)\notin r^-$.  We consider first the case where
    $(a^\Jmc,b^\Jmc)\in r^+$, and thus
    $r(a,b)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.  The definition
    of~\Deltah yields that $\psf(r(a,b))\in w_{i+1}$, and thus
    $\Imc_{i+1}\models r(a,b)$, i.e.~we have
    $(a^\Jmc,b^\Jmc)\in A^{\Imc_{i+1}}$.

    Consider now the case where $(a^\Jmc,b^\Jmc)\notin r^+$,
    i.e.~$(a^\Jmc,b^\Jmc)\in r^{\Imc_i}\setminus r^-$.  Since
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_i}$, we have $\Imc_i\models r(a,b)$, and thus
    $\psf(r(a,b))\in w_i$.  Moreover, we have by the definition of~$r^-$ that
    $\lnot r(a,b)\notin\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.  Again, the
    definition of~\Deltah yields that $\psf(r(a,b))\in w_{i+1}$, and thus
    $\Imc_{i+1}\models r(a,b)$, i.e.~we have
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$.

    For the \enquote{only if} direction, assume to the contrary that
    $(a^\Jmc,b^\Jmc)\in r^{\Imc_{i+1}}$, $(a^\Jmc,b^\Jmc)\notin r^+$, and
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_i}\setminus r^-$.  There are again two cases
    to consider: either $(a^\Jmc,b^\Jmc)\in r^-$ or $(a^\Jmc,b^\Jmc)\notin r^-$.
    If $(a^\Jmc,b^\Jmc)\in r^-$, then
    $\lnot r(a,b)\in\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$.  Again, the
    definition of~\Deltah yields that $\psf(r(a,b))\notin w_{i+1}$, and thus
    $\Imc_{i+1}\not\models r(a,b)$, i.e.~we have
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_{i+1}}$, which is a contradiction.

    Otherwise, if $(a^\Jmc,b^\Jmc)\notin r^-$, we have
    $(a^\Jmc,b^\Jmc)\notin r^{\Imc_i}$, and thus $\Imc_i\not\models r(a,b)$,
    which yields $\psf(r(a,b))\notin w_i$.  Since $(a^\Jmc,b^\Jmc)\notin r^+$,
    we have
    $r(a,b)\notin\Eff(\abf_{i+1},T_{w_i,\abf_{i+1},\CR},\CR)$
    by the definition of~$r^+$.  Again, the definition of~\Deltah yields that
    $\psf(r(a,b))\notin w_{i+1}$, and thus $\Imc_{i+1}\not\models r(a,b)$,
    i.e.~we have $(a^\Jmc,b^\Jmc)\notin r^{\Imc_{i+1}}$, which is again a
    contradiction.

    We have thus shown that
    $r^{\Imc_{i+1}}=(r^{\Imc_i}\cup r^+)\setminus r^-$.
    %
    Since we have shown that all conditions in Definition~\ref{def:action-semantics}
    are satisfied, this finishes the proof that we have
    $\Imc_i\Rightarrow_{\abf_{i+1}}^{\Tmc,\CR}\Imc_{i+1}$ for every $i\ge 0$.
\end{proof}

\noindent
Using this lemma, we can prove our complexity result.

\begin{theorem}\label{thm:verification-complexity}
    The verification problem for our action formalism is
    \begin{enumerate}
        \item\label{enum:verification-tbox-alcqo}
            in \TwoExpTime for the DLs \ALC, \ALCO, \ALCI, \ALCIO, \ALCQ, and
            \ALCQO; and
        \item\label{enum:verification-tbox-alcqio}
            in \coTwoNExpTime for the DLs \ALCQI and \ALCQIO.
    \end{enumerate}
    %
    Moreover, if the TBox is assumed to be acyclic (or empty), the verification
    problem is
    \begin{enumerate}[resume]
        \item\label{enum:verification-alcqo}
            in \ExpSpace for the DLs \ALC, \ALCO, \ALCQ, and \ALCQO;
        \item\label{enum:verification-alcio}
            in \TwoExpTime for the DLs \ALCI and \ALCIO; and
        \item\label{enum:verification-alcqio}
            in \coTwoNExpTime for the DLs \ALCQI and \ALCQIO.
    \end{enumerate}
\end{theorem}

\begin{proof}
    Let~\Lmc be a DL between \ALC and \ALCQIO.  Furthermore, let~\Amc be a
    generalised \Lmc-ABox, \Tmc be an \Lmc-TBox, \CR be a finite set of causal
    relationships, \Abf be a finite set of DL-actions,
    $\Nmc=(Q,\Abf,\Delta,Q_0,F)$ be a BÃ¼chi-automaton, $\phi$ be an
    \Lmc-LTL-formula, and $\psf\colon\Ax(\phi)\to\Pmc_\phi$ be a bijection.
    %
    As argued above, the following assumptions are without loss of generality:
    \begin{itemize}
        \item \Amc is empty;
        \item every axiom occurring in a DL-action of~\Abf or a causal
            relationship of~\CR also occurs in~$\phi$; and
        \item for every $A\in\NC$, $r\in\NR$, $a,b\in\NI$ occurring in~$\phi$,
            \Tmc, a DL-action of~\Abf, or a causal relationship of~\CR, we have
            that the assertions $A(a)$ and $r(a,b)$ also occur in~$\phi$.
    \end{itemize}

    \noindent
    Moreover, we have argued that the verification problem and the
    \emph{un}satisfiability problem have the same complexity.

    The satisfiability problem can be decided using the characterisation of
    Lemma~\ref{lem:action-sat-wmc}.  Consider the following decision procedure.
    For every set $\Wmc\subseteq 2^{\Pmc_\phi}$, do the following:
    \begin{enumerate}
        \item Construct the BÃ¼chi-automaton
            $\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$, and check it for
            non-emptiness.
        \item Construct the generalised ABox~$\Amc_\Wmc$, the TBox~\Tred, and
            the TBox~$\bigcup_{i=1}^{\lvert\Wmc\rvert}\Tmc^{(i)}$, and check
            whether $\Amc_\Wmc$ has a model w.r.t.\
            $\Tred\cup\bigcup_{i=1}^{\lvert\Wmc\rvert}\Tmc^{(i)}$.
    \end{enumerate}

    \noindent
    If both steps are successful for any set $\Wmc\subseteq 2^{\Pmc_\phi}$,
    i.e.~we have $L_\omega(\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}})\ne\emptyset$
    and $\Amc_\Wmc$ has a model w.r.t.\
    $\Tred\cup\bigcup_{i=1}^{\lvert\Wmc\rvert}\Tmc^{(i)}$, we know by
    Lemma~\ref{lem:action-sat-wmc} that $\phi$ is satisfiable w.r.t.~\Amc, \Tmc,
    \CR, and~\Nmc.  Otherwise, $\phi$ is unsatisfiable w.r.t.~\Amc, \Tmc, \CR,
    and~\Nmc.

    First note that there are doubly exponentially many sets $\Wmc\subseteq
    2^{\Pmc_\phi}$, and each of these sets is of size exponential in the size
    of~$\phi$.  Thus, all sets~\Wmc can be enumerated in exponential space (and
    doubly exponential time).  We first show that Step~1 can be performed in
    exponential space (and doubly exponential time).

    In the proof of Lemma~\ref{lem:t-sat}, we have seen that the BÃ¼chi-automaton
    $\Nmc_{\phi^\psf_\Wmc}$ can be constructed in time exponential in the size
    of~$\phi^\psf$ (and thus in time exponential in the size of~$\phi$) and
    linear in the size of~\Wmc.  Moreover, the BÃ¼chi-automaton~\Nmch is clearly
    of size exponential in the size of~$\phi$, since $\Sigma_{\Pmc_\phi}$ is of
    size exponential in the size of~$\phi$.  Furthermore, \Nmch can be
    constructed in time doubly exponential in the size of~$\phi$, \Abf,
    and~\CR.  Indeed, for every $\sigma\in\Sigma_{\Pmc_\phi}$ and $\abf\in\Abf$,
    the generalised ABox $T_{\sigma,\abf,\CR}$ is of polynomial size, and can be
    constructed in polynomial time.  Checking whether $T_{\sigma,\abf,\CR}$ is
    an action type for~\abf and~\CR involves checking the two conditions of
    Definition~\ref{def:action-type}.  The first condition is obviously
    satisfied by construction, and the second condition is satisfied if
    $T_{\sigma,\abf,\CR}$ is consistent.  Since the ABox-consistency problem for
    \ALCQIO is
    \NExpTime-complete~\cite{Sch-DKE94,Tob-JAIR00,Pra-JLLI05},\footnote{%
        As noted in the proof of
        Theorem~\ref{thm:complexity-consistency-no-tbox}, this is even the case
        if the number in the at-least and at-most restrictions are coded in
        binary.}
    we can perform this check in doubly exponential time.
    %
    Overall, \Nmch can be constructed in exponential space (and doubly
    exponential time).

    As noted above, the
    BÃ¼chi-automaton~$\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$, which accepts the
    intersection of the $\omega$-language accepted by~$\Nmc_{\phi^\psf_\Wmc}$
    and the $\omega$-language accepted by~\Nmch, can be obtained using the
    standard product construction in time polynomial in the size of the input
    BÃ¼chi-automata, see e.g.~\cite{BaKa-08,Tho-90}.  Thus,
    $\smash{\widehat{\Nmc}_{\phi^\psf_\Wmc}}$ is of size exponential in the size
    of~$\phi$, \Abf, and~\CR.  Since the emptiness problem for BÃ¼chi-automata
    can be solved in time polynomial in the size of the
    BÃ¼chi-automaton~\cite{VaWo-IC94}, we obtain that Step~1 above can be
    performed in exponential space (and doubly exponential time) for each DL
    between \ALC and \ALCQIO.

    For Step~2, note that the ABox~$\Amc_\Wmc$, the TBox~\Tred, and the TBox
    $\bigcup_{i=1}^{\lvert\Wmc\rvert}\Tmc^{(i)}$ can be constructed in
    exponential time, and is of size exponential in the size of the input.
    Since for \ALCIO and \ALCQO, the ABox-consistency problem (w.r.t.\ general
    TBoxes) can be decided in
    \ExpTime~\cite{Sch-DKE94,Hla-DPIJCAR04,HoSa-IJCAI01}, Step~2 can be
    performed in doubly exponential time for all DLs that are fragments of
    \ALCIO or \ALCQO.  Since \ExpTime is closed under complement, we obtain
    overall Parts~\ref{enum:verification-tbox-alcqo}
    and~\ref{enum:verification-alcio} of the theorem.

    For Parts~\ref{enum:verification-tbox-alcqio}
    and~\ref{enum:verification-alcqio} of the theorem, note since \Tred contains
    nominals, and for \ALCQIO, the ABox-consistency problem (w.r.t.\ general
    TBoxes) is \NExpTime-complete~\cite{Sch-DKE94,Tob-JAIR00,Pra-JLLI05}, we
    obtain that the satisfiability problem for the DLs \ALCQI and \ALCQIO is in
    \TwoNExpTime.  Hence, we obtain that the verification problem is in
    \coTwoNExpTime for those DLs.

    Finally, for Part~\ref{enum:verification-alcqo} of the theorem, note that
    the TBox $\Tred\cup\bigcup_{i=1}^{\lvert\Wmc\rvert}\Tmc^{(i)}$ is acyclic.
    Since for \ALCQO, the ABox-consistency problem w.r.t.\ acyclic TBoxes is
    \PSpace-complete~\cite{Sch-DKE94,BLM+-LTCS-05-02}, we obtain that Step~2 can
    be performed in exponential space for any fragment of \ALCQO.  Since
    \ExpSpace is closed under complement, we obtain overall
    Part~\ref{enum:verification-alcqo} of the theorem.
\end{proof}

\noindent
If we compare these complexity results with the ones
of~\cite{BaLM-ECAI10} (see
Proposition~\ref{prop:action-verification-acyclic-tbox}) where only acyclic
TBoxes and no causal relationships were considered, we observe the following.
Allowing general TBoxes and causal relationships does not result in an increase
of the complexity upper bounds for the verification problem for the description
logics \ALCI, \ALCIO, \ALCQI, and \ALCQIO.  For \ALC, \ALCO, \ALCQ, and \ALCQO,
however, the complexity upper bound increases from \ExpSpace to \TwoExpTime if
general TBoxes are allowed.  The main reason for that is that the
ABox-consistency problem in those DLs is harder if general TBoxes are
considered.
%
Unfortunately, we do not know for any of these shown upper bounds of the
verification problem whether they are tight.


\section{Summary}\label{sec:ramifications-summary}

We will now sum up the main results of this chapter.
%
In this chapter, we have proposed to use causal relationships to deal with the
ramification problem for DL-based action formalisms.  In
Sections~\ref{sec:consistency} and~\ref{sec:projection}, we have shown, for our
more expressive action formalism, that important inference problems for action
formalisms such as the consistency problema and the projection problem are
decidable in the setting with and without domain knowledge, which is described
with a general TBox instead of only an acylcic one, for the DLs considered
in~\cite{BLM+-AAAI05}.  Moreover, we have derived complexity results from the
decision procedures.  What differs from DL to DL is the complexity of the basic
inference problems in the respective DL (extended with nominals).  Except for
two cases, we obtain the matching hardness results by a reduction from such a
basic inference problem.  Finally, in Section~\ref{sec:verifying-actions}, we
considered the verification problem for our more expressive action formalism.
There, a BÃ¼chi-automaton defines infinite sequences of DL-actions that an agent
may execute.  We have shown how to verify whether temporal properties are
satisfied for all such sequences, and again we have derived complexity results.
%
The complexity results obtained in this chapter are listed in
Table~\ref{tab:ramification-results}.
%
\begin{table}[t]
    \centering
    \caption{The complexity of the inference problems considered in this chapter
        for all DLs between \ALC and \ALCQIO}
    \label{tab:ramification-results}
    \begin{tabular*}{\textwidth}{l@{\extracolsep{\fill}}clll}
        \toprule
             \emph{DL}
            &\emph{GCIs?}
            &\emph{Consistency problem}
            &\emph{Projection problem}
            &\emph{Verification problem}\\
            &
            &(Theorems~\ref{thm:complexity-consistency-no-tbox},~\ref{thm:consistency-complexity-tbox})
            &(Theorem~\ref{thm:projection-complexity})
            &(Theorem~\ref{thm:verification-complexity})\\
        \midrule
        \multirow{2}{*}{\ALC{}[\Qmc{}][\Omc{}]}
            &\xmark
            &\PSpace-c.
            &\PSpace-c.
            &in \ExpSpace\\
        \cmidrule(r){2-5}
            &\cmark
            &\ExpTime-c.
            &\ExpTime-c.
            &in \TwoExpTime\\
        \midrule
        \multirow{2}{*}{\ALCI}
            &\xmark
            &\PSpace-c.
            &\ExpTime-c.
            &in \TwoExpTime\\
        \cmidrule(r){2-5}
            &\cmark
            &\ExpTime-c.
            &\ExpTime-c.
            &in \TwoExpTime\\
        \midrule
        \multirow{2}{*}{\ALCIO}
            &\xmark
            &\ExpTime-c.
            &\ExpTime-c.
            &in \TwoExpTime\\
        \cmidrule(r){2-5}
            &\cmark
            &\ExpTime-c.
            &\ExpTime-c.
            &in \TwoExpTime\\
        \midrule
        \multirow{2}{*}{\ALCQI}
            &\xmark
            &\PSpace-c.
            &\coNExpTime-c.
            &in \coTwoNExpTime\\
        \cmidrule(r){2-5}
            &\cmark
            &\ExpTime-hard\,/
            &\coNExpTime-c.
            &in \coTwoNExpTime\\
            &
            &in \coNExpTime
            &
            &\\
        \midrule
        \multirow{2}{*}{\ALCQIO}
            &\xmark
            &\coNExpTime-c.
            &\coNExpTime-c.
            &in \coTwoNExpTime\\
        \cmidrule(r){2-5}
            &\cmark
            &\coNExpTime-hard\,/
            &\coNExpTime-c.
            &in \coTwoNExpTime\\
            &
            &in \PTimeToNExpTime
            &
            &\\
        \bottomrule
    \end{tabular*}
    \\[1ex]
    \caption*{\ALC{}[\Qmc{}][\Omc{}] is short for any DL between \ALC and
        \ALCQO, and \enquote{c.} is short for \enquote{complete}.}
\end{table}

Regarding future work, one interesting question is whether our approaches to
deciding the consistency, projection, and verification problem can be extended
to DL-actions with so-called occlusions~\cite{BLM+-AAAI05}.  Basically,
occlusions are sets of axioms that are allowed to change arbitrarily.  Thus,
occlusions allow the user to specify statements about the possible changes to
the interpretations of concepts and roles that can be caused by applying a given
DL-action.
%
Note that such DL-actions are non-deterministic, i.e.~their application to an
interpretation may yield several possible successor interpretations.
Consequently, such a DL-action may still be consistent although some of the
successors interpretations are not models of the TBox (see the proof of
Lemma~\ref{lem:consistency-tbox}).  Thus, consistency can no longer be
characterised by an analog of Lemma~\ref{lem:consistency-tbox}.

When defining our semantics for DL-actions in the presence of causal
relationships, we followed the approach used
in~\cite{BeDT-ESSLLI98,DeTB-LEACIS98} rather than the one employed
by~\cite{Lin-IJCAI95,Thi-AIJ97}.  In our health insurance example (see
Examples~\ref{ex:hiring-action-formally} and~\ref{ex:hiring-action-cr}), this
was actually the appropriate semantics, but there may also be examples where it
would be better to use the other semantics.  Thus, it would be interesting to
see whether our approach for deciding the consistency, the projection, and the
verification problem can be adapted to deal with the semantics
of~\cite{Lin-IJCAI95,Thi-AIJ97}.

Instead of trying to decide the projection problem directly, one can also follow
the progression approach: given a DL-action and a (possibly incomplete)
description of the current state, this approach tries to compute a description
of the possible successor states.  Projection then boils down to computing
consequences of this successor description.  For DL-based action theories,
progression has been investigated in~\cite{LLM+-AIJ11}.  It would be interesting
to see whether the results obtained there can be extended to the DL-based action
theories with causal relationships considered in the present chapter.

In this chapter, we followed the approach for obtaining decidability results for
action theories introduced in~\cite{BLM+-AAAI05}, which is based on the idea of
restricting the base logic to a decidable DL\@.  In the literature, other ways
of restricting the base logic to achieve this goal have been considered.  For
example, in~\cite{LiLa-IJCAI09} the authors consider so-called local effect
actions%
\footnote{Note that our DL-based actions are local effect actions.}
and restrict the base logic to so-called \enquote{proper$^+$ knowledge
bases}~\cite{LiLe-AAAI05}.  They show that, in this setting, progression is
efficiently computable, which implies that the projection problem is efficiently
decidable.  It would be interesting to see whether this result can be extended
to actions theories with causal relationships.

Moreover, it is interesting to see whether the results of this chapter can be
used to verifying properties of action sequences \enquote{generated} by
restricted forms of high-level action programming languages such as
\textsc{Golog}~\cite{LRL+-JLP97} and \textsc{Flux}~\cite{Thi-TPLP05}.  A first
step in that direction has been done in~\cite{BaZa-FroCoS13}.
